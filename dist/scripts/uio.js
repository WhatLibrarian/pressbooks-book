var fluid_3_0_0=fluid_3_0_0||{},fluid=fluid||fluid_3_0_0;!function(e,t){"use strict";function r(e,t,r,n){for(var o=e[r],a=0;a<n.length-1;++a)o=n[a+1](o,r);t[r]=o}function n(e,r,n,o){for(var a=0;a<n;++a)e=o(e,r[a],a,t.makeArray(r));return e}function o(e,t,r,o){for(var a=[],i=0;i<e.length;++i){var s=n(e[i],t,r,o[i]);void 0!==s&&a.push(s)}return a}t.version="Infusion 3.0.0",t.Error=Error,t.environment={fluid:t},t.global=t.global||"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},t.invokeLater=function(e){return setTimeout(e,1)},t.defeatLogging=!0,t.activityTracing=!1,t.activityTrace=[];var a=/(%\w+)/g;t.renderOneActivity=function(e,t){for(var r=!0===t?[]:["    while "],n=e.message,o=a.lastIndex=0;;){var i=a.exec(n);if(!i)break;var s=i[1].substring(1);r.push(n.substring(o,i.index)),r.push(e.args[s]),o=a.lastIndex}return o<n.length&&r.push(n.substring(o)),r},t.renderActivity=function(e,r){return r=r||t.renderOneActivity,t.transform(e,r)},t.singleThreadLocal=function(e){var t=e();return function(e){return void 0===e?t:t=e}},t.threadLocal=t.singleThreadLocal,t.globalThreadLocal=t.threadLocal(function(){return{}}),t.getActivityStack=function(){var e=t.globalThreadLocal();return e.activityStack||(e.activityStack=[]),e.activityStack},t.describeActivity=t.getActivityStack,t.logActivity=function(e){e=e||t.describeActivity();var r=t.renderActivity(e).reverse();t.log("Current activity: "),t.each(r,function(e){t.doLog(e)})},t.pushActivity=function(e,r,n){var o={type:e,message:r,args:n,time:(new Date).getTime()};t.activityTracing&&t.activityTrace.push(o),t.passLogLevel(t.logLevel.TRACE)&&t.doLog(t.renderOneActivity(o,!0)),t.getActivityStack().push(o)},t.popActivity=function(e){e=e||1,t.activityTracing&&t.activityTrace.push({pop:e});var r=t.getActivityStack(),n=r.length-e;r.length=n<0?0:n},t.FluidError=function(){var e=Error.apply(this,arguments);this.message=e.message;try{throw e}catch(e){this.stack=e.stack}return this},t.FluidError.prototype=Object.create(Error.prototype),t.logFailure=function(e,r){t.log.apply(null,[t.logLevel.FAIL,"ASSERTION FAILED: "].concat(e)),t.logActivity(r)},t.renderLoggingArg=function(e){return void 0===e?"undefined":t.isPrimitive(e)||!t.isPlainObject(e)?e:JSON.stringify(e)},t.builtinFail=function(e){var r=t.transform(e,t.renderLoggingArg).join("");throw new t.FluidError("Assertion failure - check console for more details: "+r)},t.fail=function(){var e=t.makeArray(arguments),r=t.makeArray(t.describeActivity());t.popActivity(r.length),t.failureEvent?t.failureEvent.fire(e,r):(t.logFailure(e,r),t.builtinFail(e,r))},t.expect=function(e,r,n){t.transform(t.makeArray(n),function(n){void 0===r[n]&&t.fail(e+" missing required parameter "+n)})},t.isLogging=function(){return i[0].priority>t.logLevel.IMPORTANT.priority},t.isLogLevel=function(e){return t.isMarker(e)&&void 0!==e.priority},t.passLogLevel=function(e){return e.priority<=i[0].priority},t.setLogging=function(e){var r;"boolean"==typeof e?r=t.logLevel[e?"INFO":"IMPORTANT"]:t.isLogLevel(e)?r=e:t.fail("Unrecognised fluid logging level ",e),i.unshift(r),t.defeatLogging=!t.isLogging()},t.setLogLevel=t.setLogging,t.popLogging=function(){var e=1===i.length?i[0]:i.shift();return t.defeatLogging=!t.isLogging(),e},t.doLog=function(e){"undefined"!=typeof console&&(console.debug?console.debug.apply(console,e):"function"==typeof console.log&&console.log.apply(console,e))},t.log=function(){var e=t.makeArray(arguments),r=t.logLevel.INFO;if(t.isLogLevel(e[0])&&(r=e.shift()),t.passLogLevel(r)){var n=t.renderTimestamp(new Date)+":  ",o=[n].concat(e);t.doLog(o)}},t.isValue=function(e){return void 0!==e&&null!==e},t.isPrimitive=function(e){var t=typeof e;return!e||"string"===t||"boolean"===t||"number"===t||"function"===t},t.isArrayable=function(e){return e&&(e.jquery||"[object Array]"===Object.prototype.toString.call(e))},t.isPlainObject=function(e,t){var r=Object.prototype.toString.call(e);return"[object Array]"===r?!t:"[object Object]"===r&&(!e.constructor||!e.constructor.prototype||Object.prototype.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))},t.typeCode=function(e){return t.isPrimitive(e)||!t.isPlainObject(e)?"primitive":t.isArrayable(e)?"array":"object"},t.isIoCReference=function(e){return"string"==typeof e&&"{"===e.charAt(0)&&e.indexOf("}")>0},t.isDOMNode=function(e){return e&&"number"==typeof e.nodeType},t.isComponent=function(e){return e&&e.constructor===t.componentConstructor},t.isUncopyable=function(e){return t.isPrimitive(e)||!t.isPlainObject(e)},t.isApplicable=function(e){return e.apply&&"function"==typeof e.apply},t.identity=function(e){return e},t.notImplemented=function(){t.fail("This operation is not implemented")},t.firstDefined=function(e,t){return void 0===e?t:e},t.freshContainer=function(e){return t.isArrayable(e)?[]:{}},t.copyRecurse=function(e,r){return r.length>t.strategyRecursionBailout&&t.fail("Runaway recursion encountered in fluid.copy - reached path depth of "+t.strategyRecursionBailout+" via path of "+r.join(".")+"this object is probably circularly connected. Either adjust your object structure to remove the circularity or increase fluid.strategyRecursionBailout"),t.isUncopyable(e)?e:t.transform(e,function(e,n){r.push(n);var o=t.copyRecurse(e,r);return r.pop(),o})},t.copy=function(e){return t.copyRecurse(e,[])},t.extend=e.extend,t.makeArray=function(e){var r=[];if(null!==e&&void 0!==e)if(t.isPrimitive(e)||t.isPlainObject(e,!0)||"number"!=typeof e.length)r.push(e);else for(var n=0;n<e.length;++n)r[n]=e[n];return r},t.pushArray=function(e,r,n){var o=e[r]?e[r]:e[r]=[];t.isArrayable(n)?o.push.apply(o,n):o.push(n)},t.transform=function(e){if(t.isPrimitive(e))return e;var n=t.freshContainer(e);if(t.isArrayable(e))for(var o=0;o<e.length;++o)r(e,n,o,arguments);else for(var a in e)r(e,n,a,arguments);return n},t.each=function(e,r){if(t.isArrayable(e))for(var n=0;n<e.length;++n)r(e[n],n);else for(var o in e)r(e[o],o)},t.make_find=function(e){var r=!e&&void 0;return function(n,o,a){var i;if(t.isArrayable(n)){for(var s=0;s<n.length;++s)if((i=o(n[s],s))!==r)return e?n[s]:i}else for(var l in n)if((i=o(n[l],l))!==r)return e?n[l]:i;return a}},t.find=t.make_find(!1),t.find_if=t.make_find(!0),t.accumulate=function(e,t,r){for(var n=0;n<e.length;++n)r=t(e[n],r,n);return r},t.add=function(e,t){return e+t},t.remove_if=function(e,r,n){if(t.isArrayable(e))for(var o=e.length-1;o>=0;--o)r(e[o],o)&&(n&&n.unshift(e[o]),e.splice(o,1));else for(var a in e)r(e[a],a)&&(n&&(n[a]=e[a]),delete e[a]);return n||e},t.generate=function(e,t,r){for(var n=[],o=0;o<e;++o)n[o]=r?t(o):t;return n},t.iota=function(e,t){t=t||0;for(var r=[],n=0;n<e;++n)r[r.length]=t++;return r},t.getMembers=function(e,r){return t.transform(e,function(e){return t.get(e,r)})},t.filterKeys=function(r,n,o){return t.remove_if(e.extend({},r),function(e,t){return o^-1===n.indexOf(t)})},t.censorKeys=function(e,r){return t.filterKeys(e,r,!0)},t.keys=function(e){var t=[];for(var r in e)t.push(r);return t},t.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},t.contains=function(e,r){return e?t.isArrayable(e)?-1!==e.indexOf(r):t.find(e,function(e){if(r===e)return!0}):void 0},t.keyForValue=function(e,r){return t.find(e,function(e,t){if(r===e)return t})},t.arrayToHash=function(e){var r={};return t.each(e,function(e){r[e]=!0}),r},t.stableSort=function(e,t){for(var r=0;r<e.length;r++){var n,o=e[r];for(n=r;n>0&&t(o,e[n-1])<0;n--)e[n]=e[n-1];e[n]=o}},t.hashToArray=function(r,n,o){var a=[];return t.each(r,function(t,r){var i={};i[n]=r,o?i=o(i,t,r)||i:e.extend(!0,i,t),a.push(i)}),a},t.flatten=function(e){var r=[];return t.each(e,function(e){t.isArrayable(e)?r=r.concat(e):r.push(e)}),r},t.clear=function(e){if(t.isArrayable(e))e.length=0;else for(var r in e)delete e[r]},t.compareStringLength=function(e){return e?function(e,t){return e.length-t.length}:function(e,t){return t.length-e.length}},t.parseInteger=function(e){return isFinite(e)&&e%1==0?Number(e):NaN},t.roundToDecimal=function(e,t,r){if(t=t&&t>=0?Math.round(t):0,"ceil"===r||"floor"===r)return Number(Math[r](e+"e"+t)+"e-"+t);var n=e>=0?1:-1;return Number(n*(Math.round(Math.abs(e)+"e"+t)+"e-"+t))},t.debounce=function(e,t,r){var n,o;return function(){var a=this,i=arguments,s=function(){n=null,r||(o=e.apply(a,i))},l=r&&!n;return clearTimeout(n),n=setTimeout(s,t),l&&(o=e.apply(a,i)),o}},t.freezeRecursive=function(e){return t.isPlainObject(e)?(t.each(e,function(e){t.freezeRecursive(e)}),Object.freeze(e)):e},t.marker=function(){},t.makeMarker=function(r,n){var o=Object.create(t.marker.prototype);return o.value=r,e.extend(o,n),Object.freeze(o)},t.VALUE=t.makeMarker("VALUE"),t.NO_VALUE=t.makeMarker("NO_VALUE"),t.EXPAND=t.makeMarker("EXPAND"),t.isMarker=function(e,r){return e instanceof t.marker&&(!r||e.value===r.value)},t.logLevelsSpec={FATAL:0,FAIL:5,WARN:10,IMPORTANT:12,INFO:15,TRACE:20},t.logLevel=t.transform(t.logLevelsSpec,function(e,r){return t.makeMarker(r,{priority:e})});var i=[t.logLevel.IMPORTANT];t.model={},t.model.copyModel=function(r,n){t.clear(r),e.extend(!0,r,n)},t.model.parseEL=function(e){return""===e?[]:String(e).split(".")},t.model.composePath=function(e,t){return""===e?t:""===t?e:e+"."+t},t.model.composeSegments=function(){return t.makeArray(arguments).join(".")},t.lastDotIndex=function(e){return e.lastIndexOf(".")},t.model.getToTailPath=function(e){var r=t.lastDotIndex(e);return-1===r?"":e.substring(0,r)},t.model.getTailPath=function(e){var r=t.lastDotIndex(e);return e.substring(r+1)},t.path=t.model.composeSegments,t.composePath=t.model.composePath,t.requireDataBinding=function(){t.fail("Please include DataBinding.js in order to operate complex model accessor configuration")},t.model.setWithStrategy=t.model.getWithStrategy=t.requireDataBinding,t.model.resolvePathSegment=function(e,t,r,n){if(!n&&e.resolvePathSegment){var o=e.resolvePathSegment(t);if(void 0!==o)return o}return r&&void 0===e[t]?e[t]={}:e[t]},t.model.parseToSegments=function(e,r,n){return"number"==typeof e||"string"==typeof e?r(e):n?t.makeArray(e):e},t.model.pathToSegments=function(e,r){var n=r&&r.parser?r.parser.parse:t.model.parseEL;return t.model.parseToSegments(e,n)},t.model.accessImpl=function(e,r,n,o,a,i,s){var l=t.model.pathToSegments(r,o),u=0;if(a&&(u=a.length,l=a.concat(l)),e=s(e,l,u,o,n===t.NO_VALUE?0:1),n===t.NO_VALUE||n===t.VALUE)return i?{root:e,segs:l}:e;e[l[l.length-1]]=n},t.model.accessSimple=function(e,r,n,o,a,i){return t.model.accessImpl(e,r,n,o,a,i,t.model.traverseSimple)},t.model.traverseSimple=function(e,r,n,o,a){for(var i=o,s=r.length-a,l=0;l<s;++l){if(!e)return;var u=r[l];e=o&&o[u]?o[u]:t.model.resolvePathSegment(e,u,1===a,i),o=null}return e},t.model.setSimple=function(e,r,n,o,a){t.model.accessSimple(e,r,n,o,a,!1)},t.model.getSimple=function(e,r,n,o){return null===r||void 0===r||0===r.length?e:t.model.accessSimple(e,r,t.NO_VALUE,n,o,!1)},t.getImmediate=function(e,t,r){for(var n=void 0===r?t.length:r+1,o=0;o<n;++o)e=e?e[t[o]]:void 0;return e},t.decodeAccessorArg=function(e){return e&&e!==t.model.defaultGetConfig&&e!==t.model.defaultSetConfig?"environment"===e.type?e.value:void 0:null},t.set=function(e,r,n,o,a){var i=t.decodeAccessorArg(o);void 0===i?t.model.setWithStrategy(e,r,n,o,a):t.model.setSimple(e,r,n,i,a)},t.get=function(e,r,n,o){var a=t.decodeAccessorArg(n);return void 0===a?t.model.getWithStrategy(e,r,n,o):t.model.accessImpl(e,r,t.NO_VALUE,a,null,!1,t.model.traverseSimple)},t.getGlobalValue=function(e,r){if(e)return r=r||t.environment,t.get(t.global,e,{type:"environment",value:r})},t.bind=function(e,r,n){return e[r].apply(e,t.makeArray(n))},t.invokeGlobalFunction=function(e,r,n){var o=t.getGlobalValue(e,n);if(o)return o.apply(null,t.isArrayable(r)?r:t.makeArray(r));t.fail("Error invoking global function: "+e+" could not be located")},t.registerGlobalFunction=function(e,r,n){n=n||t.environment,t.set(t.global,e,r,{type:"environment",value:n})},t.setGlobalValue=t.registerGlobalFunction,t.registerNamespace=function(e,r){r=r||t.environment;var n=t.getGlobalValue(e,r);return n||(n={},t.setGlobalValue(e,n,r)),n},t.dumpEl=t.identity,t.renderTimestamp=t.identity,t.generateUniquePrefix=function(){return Math.floor(1e12*Math.random()).toString(36)+"-"};var s=t.generateUniquePrefix();t.fluidInstance=s;var l=1;t.allocateGuid=function(){return s+l++},t.registerNamespace("fluid.event"),t.extremePriority=4e9,t.priorityTypes={first:-1,last:1,before:0,after:0},t.extremalPriorities={none:0,testing:10,authoring:20},t.parsePriorityConstraint=function(e,r,n){var o=e.split(":"),a=o[0],i=t.priorityTypes[a];return void 0===i&&t.fail("Invalid constraint type in priority field "+e+": the only supported values are "+t.keys(t.priorityTypes).join(", ")+" or numeric"),r&&0===i&&t.fail("Constraint type in priority field "+e+" is not supported in a "+n+" record - you must use either a numeric value or first, last"),{type:o[0],target:o[1]}},t.parsePriority=function(e,r,n,o){e=e||0;var a={count:r||0,fixed:null,constraint:null,site:o};"number"==typeof e?a.fixed=-e:a.constraint=t.parsePriorityConstraint(e,n,o);var i=a.constraint?t.priorityTypes[a.constraint.type]:0;if(0!==i){var s=a.constraint.target||"none",l=t.extremalPriorities[s];void 0===l&&t.fail("Unrecognised extremal priority target "+s+": the currently supported values are "+t.keys(t.extremalPriorities).join(", ")+": register your value in fluid.extremalPriorities"),a.fixed=i*(t.extremePriority+l)}return null!==a.fixed&&(a.fixed+=a.count/1024),a},t.renderPriority=function(e){return e.constraint?e.constraint.target?e.constraint.type+":"+e.constraint.target:e.constraint.type:Math.floor(e.fixed)},t.compareByPriority=function(e,t){return null!==e.priority.fixed&&null!==t.priority.fixed?e.priority.fixed-t.priority.fixed:(null===e.priority.fixed)-(null===t.priority.fixed)},t.honourConstraint=function(e,r,n){var o=e[n].priority.constraint,a=t.find(e,function(e,t){return e.namespace===o.target?t:void 0},-1);if(-1===a)return!0;if(a>=r)return!1;for(var i="after"===o.type?1:0,s=a+i,l=e[n],u=n;u>=s;--u)e[u]=e[u-1];return e[s]=l,!0},t.sortByPriority=function(e){t.stableSort(e,t.compareByPriority);for(var r=t.find(e,function(e,r){return e.priority.constraint&&0===t.priorityTypes[e.priority.constraint.type]?r:void 0},e.length);;){if(r===e.length)return e;for(var n=r,o=r;o<e.length;++o){t.honourConstraint(e,r,o)&&++r}if(r===n){var a=e.slice(r);t.fail("Could not find targets for any constraints in "+a[0].priority.site+" ",a,": none of the targets ("+t.getMembers(a,"priority.constraint.target").join(", ")+") matched any namespaces of the elements in (",e.slice(0,r),") - this is caused by either an invalid or circular reference")}}},t.parsePriorityRecords=function(r,n){var o=t.hashToArray(r,"namespace",function(r,o,a){e.extend(r,o),r.priority=t.parsePriority(o.priority,a,!1,n)});return t.sortByPriority(o),o},t.event.identifyListener=function(e,r){return"string"==typeof e||e.$$fluid_guid||r||(e.$$fluid_guid=t.allocateGuid()),e.$$fluid_guid},t.event.impersonateListener=function(e,r){t.event.identifyListener(e),r.$$fluid_guid=e.$$fluid_guid},t.event.sortListeners=function(e){var r=[];return t.each(e,function(e){for(var t,n=0;n<e.length;++n){var o=e[n];o.softNamespace||t||(t=o)}t?r.push(t):r=r.concat(e)}),t.sortByPriority(r)},t.event.resolveListener=function(e){var r=e.globalName||("string"==typeof e?e:null);if(r){var n=t.getGlobalValue(r);n?e=n:t.fail("Unable to look up name "+r+" as a global function")}return e},t.nameComponent=function(e){return e?"component with typename "+e.typeName+" and id "+e.id:"[unknown component]"},t.event.nameEvent=function(e,r){return r+" of "+t.nameComponent(e)},t.makeEventFirer=function(r){r=r||{};var n,o=r.name||"<anonymous>",a=function(){n.listeners={},n.byId={},n.sortedListeners=[],n.addListener=function(r,o,a,i,s){var l;if(n.destroyed&&t.fail("Cannot add listener to destroyed event firer "+n.name),r){t.isPlainObject(r,!0)&&!t.isApplicable(r)&&(l=r,r=l.listener,o=l.namespace,a=l.priority,i=l.softNamespace,s=l.listenerId),"string"==typeof r&&(r={globalName:r});var u=s||t.event.identifyListener(r);o=o||u,l=e.extend(l||{},{namespace:o,listener:r,softNamespace:i,listenerId:s,priority:t.parsePriority(a,n.sortedListeners.length,!1,"listeners")}),n.byId[u]=l;(n.listeners[o]=t.makeArray(n.listeners[o]))[i?"push":"unshift"](l),n.sortedListeners=t.event.sortListeners(n.listeners)}},n.addListener.apply(null,arguments)};return n={eventId:t.allocateGuid(),name:o,ownerId:r.ownerId,typeName:"fluid.event.firer",destroy:function(){n.destroyed=!0},addListener:function(){a.apply(null,arguments)},removeListener:function(e){if(n.listeners){var r,o,a;"string"==typeof e?(r=e,(a=n.listeners[r])||(o=r,r=null)):"function"==typeof e&&((o=t.event.identifyListener(e,!0))||t.fail("Cannot remove unregistered listener function ",e," from event "+n.name));var i=n.byId[o],s=i&&i.softNamespace;r=r||i&&i.namespace||o,delete n.byId[o],a=n.listeners[r],a&&(s?t.remove_if(a,function(e){return e.listener.$$fluid_guid===o||e.listenerId===o}):a.shift(),0===a.length&&delete n.listeners[r]),n.sortedListeners=t.event.sortListeners(n.listeners)}},fire:function(){var e=n.sortedListeners;if(e&&!n.destroyed){t.passLogLevel(t.logLevel.TRACE)&&t.log(t.logLevel.TRACE,"Firing event "+o+" to list of "+e.length+" listeners");for(var a=0;a<e.length;++a){var i=e[a];i.listener=t.event.resolveListener(i.listener);var s,l=i.listener,u=l.apply(null,arguments);if((r.preventable&&!1===u||n.destroyed)&&(s=!1),void 0!==s)return s}}}}},t.fireEvent=function(e,r,n){var o=e.events[r];o&&o.fire.apply(null,t.makeArray(n))},t.event.addListenerToFirer=function(e,r,n,o){if(o=o||t.identity,t.isArrayable(r))for(var a=0;a<r.length;++a)t.event.addListenerToFirer(e,r[a],n,o);else"function"==typeof r||"string"==typeof r?o(e).addListener(r,n):r&&"object"==typeof r&&o(e).addListener(r.listener,n||r.namespace,r.priority,r.softNamespace,r.listenerId)},t.event.resolveListenerRecord=function(e){return{records:e}},t.expandImmediate=function(e){t.fail("fluid.expandImmediate could not be loaded - please include FluidIoC.js in order to operate IoC-driven event with descriptor "+e)},t.mergeListeners=function(e,r,n){t.each(n,function(n,o){var a,i;if(t.isIoCReference(o))(a=t.expandImmediate(o,e))||t.fail("Error in listener record: key "+o+' could not be looked up to an event firer - did you miss out "events." when referring to an event firer?');else{var s=o.indexOf(".");-1!==s&&(i=o.substring(s+1),o=o.substring(0,s)),r[o]||t.fail("Listener registered for event "+o+" which is not defined for this component"),a=r[o]}var l=t.event.resolveListenerRecord(n,e,o,i,!0);t.event.addListenerToFirer(a,l.records,i,l.adderWrapper)})},t.eventFromRecord=function(e,r,n){var o,a=e&&("string"!=typeof e||t.isIoCReference(e));return a?t.event.resolveEvent?o=t.event.resolveEvent(n,r,e):t.fail("fluid.event.resolveEvent could not be loaded - please include FluidIoC.js in order to operate IoC-driven event with descriptor ",e):o=t.makeEventFirer({name:t.event.nameEvent(n,r),preventable:"preventable"===e,ownerId:n.id}),o},t.instantiateFirers=function(e,r){t.each(r.events,function(r,n){e.events[n]=t.eventFromRecord(r,n,e)})},t.mergeListenerPolicy=function(e,r,n){return"string"!=typeof n&&t.fail("Error in listeners declaration - the keys in this structure must resolve to event names - got "+n+" from ",r),t.isIoCReference(n)||-1===n.indexOf(".")?t.arrayConcatPolicy(e,r):r||e},t.makeMergeListenersPolicy=function(e,r){return function(n,o){return n=n||{},r&&(t.isArrayable(o)||"string"==typeof o.target)?n[""]=e(n[""],o,""):t.each(o,function(t,r){n[r]=e(n[r],t,r)}),n}},t.validateListenersImplemented=function(e){var r=[];return t.each(e.events,function(n,o){t.each(n.sortedListeners,function(n){n.listener!==t.notImplemented&&"fluid.notImplemented"!==n.listener.globalName||r.push({name:o,namespace:n.namespace,componentSource:t.model.getSimple(e.options.listeners,[o+"."+n.namespace,0,"componentSource"])})})}),r},t.unique=function(e){return t.remove_if(e,function(t,r){return!t||r>0&&t===e[r-1]})},t.arrayConcatPolicy=function(e,r){return t.makeArray(e).concat(t.makeArray(r))},t.failureEvent=t.makeEventFirer({name:"failure event"}),t.failureEvent.addListener(t.builtinFail,"fail"),t.failureEvent.addListener(t.logFailure,"log","before:fail"),t.pushSoftFailure=function(e){"function"==typeof e?t.failureEvent.addListener(e,"fail"):-1===e?t.failureEvent.removeListener("fail"):"boolean"==typeof e&&t.fail("pushSoftFailure with boolean value is no longer supported")},t.componentConstructor=function(){},t.typeTag=function(e){var r=Object.create(t.componentConstructor.prototype);return r.typeName=e,r.id=t.allocateGuid(),r};var u=1,c={};t.defaultsStore={},t.resolveGradesImpl=function(e,r){r=t.makeArray(r);for(var n=r.length-1;n>=0;--n){var o=r[n];if(o&&!e.gradeHash[o]){var a=t.isIoCReference(o),i=(a?null:t.rawDefaults(o))||{},s=c[o]||u-1;e.lastTick=Math.max(e.lastTick,s),e.gradeHash[o]=!0,e.gradeChain.push(o);for(var l=t.makeArray(i.gradeNames),d=l.length-1;d>=0;--d)t.resolveGradesImpl(e,l[d])}}return e},t.resolveGradeStructure=function(e,r){var n={lastTick:0,gradeChain:[],gradeHash:{}};return t.resolveGradesImpl(n,[e].concat(t.makeArray(r))),n.gradeChain.reverse(),n},t.hasGrade=function(e,r){return!(!e||!e.gradeNames)&&t.contains(e.gradeNames,r)},t.resolveGrade=function(r,n,o){var a=t.resolveGradeStructure(n,o),i=t.transform(a.gradeChain,t.rawDefaults,t.copy);t.remove_if(i,function(e){return!e});for(var s={},l=0;l<i.length;++l)i[l]&&i[l].mergePolicy&&(s=e.extend(!0,s,i[l].mergePolicy));i=[s,{}].concat(i);var u=t.merge.apply(null,i);return u.gradeNames=a.gradeChain,t.freezeRecursive(u),{defaults:u,lastTick:a.lastTick}},t.mergedDefaultsCache={},t.gradeNamesToKey=function(e,t){return e+"|"+t.join("|")},t.getMergedDefaults=function(e,r){r=t.makeArray(r);var n=t.gradeNamesToKey(e,r),o=t.mergedDefaultsCache[n];if(o){for(var a=0,i=o.defaults.gradeNames||[],s=0;s<i.length;++s)a=Math.max(a,c[i[s]]||0);a>o.lastTick&&(t.passLogLevel(t.logLevel.TRACE)&&t.log(t.logLevel.TRACE,"Clearing cache for component "+e+" with gradeNames ",i),o=null)}if(!o){var l=t.rawDefaults(e);if(!l)return l;o=t.mergedDefaultsCache[n]=t.resolveGrade(l,e,r)}return o.defaults},t.upgradePrimitiveFunc=function(e,r){if(e&&t.isPrimitive(e)){var n={};return n[r||("string"==typeof e&&"{"!==e.charAt(0)?"funcName":"func")]=e,n.args=t.NO_VALUE,n}return e},t.annotateListeners=function(e,r){r.listeners=t.transform(r.listeners,function(r){var n=t.makeArray(r);return t.transform(n,function(r){return r=t.upgradePrimitiveFunc(r,"listener"),r.componentSource=e,r})}),r.invokers=t.transform(r.invokers,function(r){return r=t.upgradePrimitiveFunc(r),r&&(r.componentSource=e),r})},t.rawDefaults=function(e){var r=t.defaultsStore[e];return r&&r.options},t.registerRawDefaults=function(e,r){t.pushActivity("registerRawDefaults","registering defaults for grade %componentName with options %options",{componentName:e,options:r});var n=t.expandCompact?t.expandCompact(r):t.copy(r);t.annotateListeners(e,n);var o=t.getCallerInfo&&t.getCallerInfo(6);t.defaultsStore[e]={options:n,callerInfo:o},c[e]=u++,t.popActivity()},t.doIndexDefaults=function(e,r,n,o){for(var a=t.makeArray(o.gradeNames),i=0;i<a.length;++i)if(!t.hasGrade(r,a[i]))return;for(var s="function"==typeof o.indexFunc?o.indexFunc:t.getGlobalValue(o.indexFunc),l=s(r)||[],u=0;u<l.length;++u)t.pushArray(n,l[u],e)},t.indexDefaults=function(e,r){var n={};for(var o in t.defaultsStore){var a=t.getMergedDefaults(o);t.doIndexDefaults(o,a,n,r)}return n},t.defaults=function(e,r){if(void 0===r)return t.getMergedDefaults(e);r&&r.options&&t.fail("Probable error in options structure for "+e+' with option named "options" - perhaps you meant to write these options at top level in fluid.defaults? - ',r),t.registerRawDefaults(e,r);var n=t.getMergedDefaults(e);t.hasGrade(n,"fluid.function")||t.makeComponentCreator(e)},t.makeComponentCreator=function(r){var n=function(){var e=t.getMergedDefaults(r);if(e.gradeNames&&0!==e.gradeNames.length){if(e.initFunction)return t.initComponent(r,arguments);for(var n=[],o=0;o<e.gradeNames.length;++o){var a=e.gradeNames[o];t.rawDefaults(a)||n.push(a)}0===n.length?t.fail("Cannot make component creator for type "+r+" which does not have an initFunction defined"):t.fail("The grade hierarchy of component with type "+r+" is incomplete - it inherits from the following grade(s): "+n.join(", ")+" for which the grade definitions are corrupt or missing. Please check the files which might include these grades and ensure they are readable and have been loaded by this instance of Infusion")}else t.fail("Cannot make component creator for type "+r+" which does not have any gradeNames defined")},o=t.getGlobalValue(r);o&&e.extend(n,o),t.setGlobalValue(r,n)},t.emptyPolicy=t.freezeRecursive({}),t.derefMergePolicy=function(e){return(e?e["*"]:t.emptyPolicy)||t.emptyPolicy},t.compileMergePolicy=function(e){var r={},n={},o={builtins:r,defaultValues:n};return e?(t.each(e,function(e,a){var i={},s=!0;if("function"==typeof e)i.func=e;else if("object"==typeof e)i=e;else if(t.isDefaultValueMergePolicy(e))t.set(n,a,"{that}.options."+e),o.hasDefaults=!0,s=!1;else for(var l=e.split(/\s*,\s*/),u=0;u<l.length;++u)i[l[u]]=!0;s&&t.set(r,t.composePath(a,"*"),i)}),o):o},t.isDefaultValueMergePolicy=function(e){return"string"==typeof e&&-1===e.indexOf(",")&&!/replace|nomerge|noexpand/.test(e)},t.mergeOneImpl=function(e,r,n,o,a,i,s){var l=e,u=t.isPrimitive(e);return void 0!==r&&(a.func||null===r||!t.isPlainObject(r)||a.nomerge?(o[n]=void 0,l=a.func?a.func.call(null,e,r,s[i-1],s,i):r):u&&(l=e=t.freshContainer(r))),l},t.fetchMergeChildren=function(e,r,n,o,a,i){for(var s=t.derefMergePolicy(a),l=o.length-1;l>=0;--l){var u=o[l];if(void 0!==u&&(t.each(u,function(s,l){var u=t.concreteTrundler(a,l);l in e&&(!i.evaluateFully||void 0!==u||t.isPrimitive(e[l]))||(n[r]=l,i.strategy(e,l,r+1,n,o,a))}),s.replace))break}return e},t.inEvaluationMarker=Object.freeze({__CURRENTLY_IN_EVALUATION__:!0}),t.strategyRecursionBailout=50,t.makeMergeStrategy=function(e){var r=function(r,a,i,s,l,u){if(i>t.strategyRecursionBailout&&t.fail("Overflow/circularity in options merging, current path is ",s," at depth ",i,' - please protect components from merging using the "nomerge" merge policy'),!t.isPrimitive(r)){t.isTracing&&t.tracing.pathCount.push(t.path(s.slice(0,i)));var c;if(a in r){if(c=r[a],!e.evaluateFully)return c}else r!==t.inEvaluationMarker&&(r[a]=t.inEvaluationMarker);void 0===l&&(s=t.makeArray(s),l=o(e.sources,s,i-1,e.sourceStrategies),u=n(e.mergePolicy,s,i-1,t.concreteTrundler));var d,f,p,m=t.concreteTrundler(u,a),g=t.derefMergePolicy(m);g.replace?(d=1-l.length,f=0,p=-1):(d=0,f=l.length-1,p=1);for(var h,v=[],y=d;y<=f;++y){var x=p*y,b=e.sourceStrategies[x](l[x],a,i,s);if(void 0!==b&&(t.isPrimitive(b)||(v[x]=b),void 0===c)){if(-1===p){h=r[a]=b;break}h=t.mergeOneImpl(h,b,y,v,g,i,s,e),r!==t.inEvaluationMarker&&(r[a]=h)}}return void 0!==c&&(h=c),v.length>0&&t.isPlainObject(h)&&t.fetchMergeChildren(h,i,s,v,m,e),void 0===c&&0===v.length&&delete r[a],h}};return e.strategy=r,r},t.driveStrategy=function(e,r,n){r=t.makeArray(r);for(var o=0;o<r.length;++o){if(!e)return;e=n(e,r[o],o+1,r)}return e},t.concreteTrundler=function(e,t){return e?e[t]:void 0},t.merge=function(e){var r=Array.prototype.slice.call(arguments,1),n=t.compileMergePolicy(e).builtins,o=t.makeMergeOptions(n,r,{});return o.initter(),o.target},t.simpleGingerBlock=function(e,r){return{target:e,simple:!0,strategy:t.concreteTrundler,initter:t.identity,recordType:r,priority:t.mergeRecordTypes[r]}},t.makeMergeOptions=function(r,n,o){var a={mergePolicy:r,sources:n};return a=e.extend(a,o),a.target=a.target||t.freshContainer(a.sources[0]),a.sourceStrategies=a.sourceStrategies||t.generate(a.sources.length,t.concreteTrundler),a.initter=function(){a.evaluateFully=!0,t.fetchMergeChildren(a.target,0,[],a.sources,a.mergePolicy,a)},t.makeMergeStrategy(a),a},t.transformOptions=function(e,r){return t.expect("Options transformation record",r,["transformer","config"]),t.getGlobalValue(r.transformer).call(null,e,r.config)},t.findMergeBlocks=function(e,r){return t.remove_if(t.makeArray(e),function(e){return e.recordType!==r})},t.transformOptionsBlocks=function(e,r,n){t.each(n,function(n){var o=t.findMergeBlocks(e,n);t.each(o,function(e){var n=e.source?"source":"target";e[e.simple||"target"===n?"target":"source"]=t.transformOptions(e[n],r)})})},t.dedupeDistributionNamespaces=function(e){var r={};t.remove_if(e,function(e){var t=e.namespace;if(t){if(r[t]&&r[t]!==e.contextThat.id)return!0;r[t]=e.contextThat.id}})},t.deliverOptionsStrategy=t.identity,t.computeComponentAccessor=t.identity,t.computeDynamicComponents=t.identity,t.mergeRecordTypes={defaults:1e3,defaultValueMerge:900,subcomponentRecord:800,user:700,distribution:100},t.model.applyChangeRequest=function(r,n){var o=n.segs;if(0===o.length)"ADD"===n.type?e.extend(!0,r,n.value):t.clear(r);else if("ADD"===n.type)t.model.setSimple(r,n.segs,n.value);else{for(var a=0;a<o.length-1;++a)if(!(r=r[o[a]]))return;var i=o[o.length-1];delete r[i]}},t.destroyValue=function(e,r){e&&t.model.applyChangeRequest(e,{type:"DELETE",segs:r})},t.mergeComponentOptions=function(r,n,o,a){function i(){y=t.driveStrategy(d,"mergePolicy",h.strategy),y=e.extend({},t.rootMergePolicy,y),v=t.compileMergePolicy(y),e.extend(!0,u,v.builtins)}var s=t.rawDefaults(n),l=t.getMergedDefaults(n,s&&s.gradeNames?null:a.gradeNames),u={},c=[];c=t.expandComponentOptions?c.concat(t.expandComponentOptions(u,l,o,r)):c.concat([t.simpleGingerBlock(l,"defaults"),t.simpleGingerBlock(o,"user")]);var d={},f=[],p=[],m={target:d,sourceStrategies:f},g=function(){t.each(c,function(e){t.isPrimitive(e.priority)&&(e.priority=t.parsePriority(e.priority,0,!1,"options distribution"))}),t.sortByPriority(c),t.dedupeDistributionNamespaces(c),f.length=0,p.length=0,t.each(c,function(e){f.push(e.strategy),p.push(e.target)})};g();var h=t.makeMergeOptions(u,p,m);h.mergeBlocks=c,h.updateBlocks=g,h.destroyValue=function(e){for(var r=0;r<c.length;++r)c[r].immutableTarget||t.destroyValue(c[r].target,e);t.destroyValue(m.target,e)};var v,y;i(),h.computeMergePolicy=i,v.hasDefaults&&(t.generateExpandBlock?(c.push(t.generateExpandBlock({options:v.defaultValues,recordType:"defaultValueMerge",priority:t.mergeRecordTypes.defaultValueMerge},r,{})),g()):t.fail("Cannot operate mergePolicy ",y," for component ",r," without including FluidIoC.js")),r.options=d,t.driveStrategy(d,"gradeNames",h.strategy),t.deliverOptionsStrategy(r,d,h),t.computeComponentAccessor(r,o&&o.localRecord);var x=t.driveStrategy(d,"transformOptions",h.strategy);return x&&(t.transformOptionsBlocks(c,x,["user","subcomponentRecord"]),g()),m.target.mergePolicy||i(),h},t.defaults("fluid.function",{}),t.invokeGradedFunction=function(e,r){var n=t.defaults(e);n&&n.argumentMap&&t.hasGrade(n,"fluid.function")||t.fail("Cannot look up name "+e+" to a function with registered argumentMap - got defaults ",n);var o=[];return t.each(n.argumentMap,function(e,t){o[e]=r[t]}),t.invokeGlobalFunction(e,o)},t.noNamespaceDistributionPrefix="no-namespace-distribution-",t.mergeOneDistribution=function(r,n,o){var a=n.namespace||o||t.noNamespaceDistributionPrefix+t.allocateGuid();n.namespace=a,r[a]=e.extend(!0,{},r[a],n)},t.distributeOptionsPolicy=function(e,r){if(e=e||{},t.isArrayable(r))for(var n=0;n<r.length;++n)t.mergeOneDistribution(e,r[n]);else"string"==typeof r.target?t.mergeOneDistribution(e,r):t.each(r,function(r,n){t.mergeOneDistribution(e,r,n)});return e},t.mergingArray=function(){},t.mergingArray.prototype=[],t.membersMergePolicy=function(e,r){return e=e||{},t.each(r,function(r,n){e[n]||(e[n]=new t.mergingArray),r instanceof t.mergingArray?e[n].push.apply(e[n],r):void 0!==r&&e[n].push(r)}),e},t.invokerStrategies=t.arrayToHash(["func","funcName","listener","this","method","changePath","value"]),t.invokersMergePolicy=function(r,n){return r=r||{},t.each(n,function(n,o){if(!n)return void(r[o]=n);n=t.upgradePrimitiveFunc(n);var a=r[o];a||(a=r[o]={})
;for(var i in t.invokerStrategies)if(i in n)for(var s in t.invokerStrategies)a[s]=void 0;e.extend(a,n)}),r},t.rootMergePolicy={gradeNames:t.arrayConcatPolicy,distributeOptions:t.distributeOptionsPolicy,members:{noexpand:!0,func:t.membersMergePolicy},invokers:{noexpand:!0,func:t.invokersMergePolicy},transformOptions:"replace",listeners:t.makeMergeListenersPolicy(t.mergeListenerPolicy)},t.defaults("fluid.component",{initFunction:"fluid.initLittleComponent",mergePolicy:t.rootMergePolicy,argumentMap:{options:0},events:{onCreate:null,onDestroy:null,afterDestroy:null}}),t.defaults("fluid.emptySubcomponent",{gradeNames:["fluid.component"]}),t.computeNickName=function(e){var r=t.model.parseEL(e);return r[r.length-1]},t.defaults("fluid.typeFount",{gradeNames:["fluid.component"]}),t.initLittleComponent=function(e,r,n,o){var a=t.typeTag(e);a.lifecycleStatus="constructing",n=n||{gradeNames:"fluid.component"},a.destroy=t.makeRootDestroy(a);var i=t.mergeComponentOptions(a,e,r,n);i.exceptions={members:{model:!0,modelRelay:!0}};var s=a.options;a.events={},(o||t.identity)(a,s,i.strategy),t.computeDynamicComponents(a,i);for(var l=0;l<i.mergeBlocks.length;++l)i.mergeBlocks[l].initter();return i.initter(),delete s.mergePolicy,t.instantiateFirers(a,s),t.mergeListeners(a,a.events,s.listeners),a},t.diagnoseFailedView=t.identity,t.makeRootDestroy=function(e){return function(){t.doDestroy(e),t.fireEvent(e,"afterDestroy",[e,"",null])}},t.isDestroyed=function(e){return"destroyed"===e.lifecycleStatus},t.doDestroy=function(e,r,n){t.fireEvent(e,"onDestroy",[e,r||"",n]),e.lifecycleStatus="destroyed";for(var o in e.events)"afterDestroy"!==o&&"function"==typeof e.events[o].destroy&&e.events[o].destroy();e.applier&&e.applier.destroy()},t.initComponent=function(e,r){var n=t.defaults(e);n.gradeNames||t.fail("Cannot initialise component "+e+" which has no gradeName registered");var o,a=[e].concat(t.makeArray(r));t.pushActivity("initComponent","constructing component of type %componentName with arguments %initArgs",{componentName:e,initArgs:r}),o=t.invokeGlobalFunction(n.initFunction,a),t.diagnoseFailedView(e,o,n,a),t.initDependents&&t.initDependents(o);var i=t.validateListenersImplemented(o);return i.length>0&&t.fail(t.transform(i,function(e){return["Error constructing component ",o," - the listener for event "+e.name+" with namespace "+e.namespace+(e.componentSource?" which was defined in grade "+e.componentSource:"")+" needs to be overridden with a concrete implementation"]})).join("\n"),"constructing"===o.lifecycleStatus&&(o.lifecycleStatus="constructed"),o.events.onCreate.fire(o),t.popActivity(),o},t.initSubcomponentImpl=function(e,r,n){var o;if("function"!=typeof r){var a="string"==typeof r?r:r.type;o="fluid.emptySubcomponent"===a?null:t.invokeGlobalFunction(a,n)}else o=r.apply(null,n);return o};t.simpleCSSMatcher={regexp:new RegExp("([#.]?)((?:[\\w\\u00c0-\\uFFFF*_-]|\\\\.)+)","g"),charToTag:{"":"tag","#":"id",".":"clazz"}},t.IoCSSMatcher={regexp:new RegExp("([&#]?)((?:[\\w\\u00c0-\\uFFFF*_-]|\\.|\\/)+)","g"),charToTag:{"":"context","&":"context","#":"id"}};var d=new RegExp("\\s*(>)?\\s*","g");t.parseSelector=function(e,r){var n=[];e=e.trim();var o=r.regexp;o.lastIndex=0;for(var a=0;;){for(var i=[],s=!0;;){var l=o.exec(e);if(!l)break;if(l.index!==a){if(!s)break;t.fail("Error in selector string - cannot match child selector expression starting at "+e.substring(a))}var u={},c=l[2],f=r.charToTag[l[1]];f&&(u[f]=c),i[i.length]=u,a=o.lastIndex,s=!1}d.lastIndex=a;var p={predList:i},m=d.exec(e);if(m&&m.index===a||t.fail("Error in selector string - can not match child selector expression at "+e.substring(a)),">"===m[1]&&(p.child=!0),n[n.length]=p,d.lastIndex>=e.length)break;a=d.lastIndex,o.lastIndex=d.lastIndex}return n},t.flattenObjectPaths=function(e){var r={};return t.each(e,function(e,n){if(null!==e&&"object"==typeof e){var o=t.flattenObjectPaths(e);t.each(o,function(e,t){r[n+"."+t]=e}),"function"==typeof t.get(e,"toString")&&(r[n]=e.toString())}else r[n]=e}),r},t.stringTemplate=function(e,r){var n=t.flattenObjectPaths(r),o=t.keys(n);o=o.sort(t.compareStringLength());for(var a=0;a<o.length;++a)for(var i=o[a],s="%"+i,l=n[i],u=-1;-1!==(u=e.indexOf(s));)e=e.slice(0,u)+l+e.slice(u+s.length);return e}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.promise=function(){var e={onResolve:[],onReject:[]};return e.then=function(t,r){return t&&("resolve"===e.disposition?t(e.value):e.onResolve.push(t)),r&&("reject"===e.disposition?r(e.value):e.onReject.push(r)),e},e.resolve=function(r){return e.disposition?t.fail("Error: resolving promise ",e,' which has already received "'+e.disposition+'"'):e.complete("resolve",e.onResolve,r),e},e.reject=function(r){return e.disposition?t.fail("Error: rejecting promise ",e,'which has already received "'+e.disposition+'"'):e.complete("reject",e.onReject,r),e},e.complete=function(t,r,n){e.disposition=t,e.value=n;for(var o=0;o<r.length;++o)r[o](n)},e},t.isPromise=function(e){return e&&"function"==typeof e.then},t.toPromise=function(e){if(t.isPromise(e))return e;var r=t.promise();return r.resolve(e),r},t.promise.follow=function(e,t){e.then(t.resolve,t.reject)},t.promise.map=function(e,r){var n=t.toPromise(e),o=t.promise();return n.then(function(e){var n=r(e);t.isPromise(n)?t.promise.follow(n,o):o.resolve(n)},function(e){o.reject(e)}),o},t.promise.makeSequencer=function(e,r,n){return t.isArrayable(e)||t.fail("fluid.promise sequence algorithms must be supplied an array as source"),{sources:e,resolvedSources:[],index:0,strategy:n,options:r,returns:[],promise:t.promise()}},t.promise.progressSequence=function(e,r){e.returns.push(r),e.index++,t.promise.resumeSequence(e)},t.promise.processSequenceReject=function(e,r){for(var n=e.index-1;n>=0;--n){var o=e.resolvedSources[n];r=(t.isPromise(o)&&"function"==typeof o.accumulateRejectionReason?o.accumulateRejectionReason:t.identity)(r)}e.promise.reject(r)},t.promise.resumeSequence=function(e){if(e.index===e.sources.length)e.promise.resolve(e.strategy.resolveResult(e));else{var r=e.strategy.invokeNext(e);e.resolvedSources[e.index]=r,t.isPromise(r)?r.then(function(r){t.promise.progressSequence(e,r)},function(r){t.promise.processSequenceReject(e,r)}):t.promise.progressSequence(e,r)}},t.promise.makeSequenceStrategy=function(){return{invokeNext:function(e){var t=e.sources[e.index];return"function"==typeof t?t(e.options):t},resolveResult:function(e){return e.returns}}},t.promise.sequence=function(e,r){var n=t.promise.makeSequencer(e,r,t.promise.makeSequenceStrategy());return t.promise.resumeSequence(n),n.promise},t.promise.makeTransformerStrategy=function(){return{invokeNext:function(e){var r=e.sources[e.index];return r.listener=t.event.resolveListener(r.listener),r.listener.apply(null,[e.returns[e.index],e.options])},resolveResult:function(e){return e.returns[e.index]}}},t.promise.makeTransformer=function(e,r,n){e.unshift({listener:function(){return r}});var o=t.promise.makeSequencer(e,n,t.promise.makeTransformerStrategy());return o.returns.push(null),t.promise.resumeSequence(o),o},t.promise.filterNamespaces=function(e,r){return r?t.remove_if(t.makeArray(e),function(e){return e.namespace&&!e.softNamespace&&!t.contains(r,e.namespace)}):e},t.promise.fireTransformEvent=function(e,r,n){n=n||{};var o=n.reverse?t.makeArray(e.sortedListeners).reverse():t.makeArray(e.sortedListeners);return o=t.promise.filterNamespaces(o,n.filterNamespaces),t.promise.makeTransformer(o,r,n).promise}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.dataSource.encoding.JSON",{gradeNames:"fluid.component",invokers:{parse:"fluid.dataSource.parseJSON",render:"fluid.dataSource.stringifyJSON"},contentType:"application/json"}),t.defaults("fluid.dataSource.encoding.none",{gradeNames:"fluid.component",invokers:{parse:"fluid.identity",render:"fluid.identity"},contentType:"text/plain"}),t.dataSource.parseJSON=function(e){var r=t.promise();if(e)try{r.resolve(JSON.parse(e))}catch(e){r.reject({message:e})}else r.resolve(void 0);return r},t.dataSource.stringifyJSON=function(e){return void 0===e?"":JSON.stringify(e,null,4)},t.defaults("fluid.dataSource",{gradeNames:["fluid.component"],events:{onRead:null,onError:null},components:{encoding:{type:"fluid.dataSource.encoding.JSON"}},listeners:{"onRead.impl":{func:"fluid.notImplemented",priority:"first"},"onRead.encoding":{func:"{encoding}.parse",priority:"after:impl"}},invokers:{get:{funcName:"fluid.dataSource.get",args:["{that}","{arguments}.0","{arguments}.1"]}}}),t.defaults("fluid.dataSource.writable",{gradeNames:["fluid.component"],events:{onWrite:null,onWriteResponse:null},listeners:{"onWrite.encoding":{func:"{encoding}.render"},"onWrite.impl":{func:"fluid.notImplemented",priority:"after:encoding"},"onWriteResponse.encoding":{func:"{encoding}.parse"}},invokers:{set:{funcName:"fluid.dataSource.set",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]}}}),t.dataSource.registerStandardPromiseHandlers=function(e,t,r){t.then("function"==typeof r?r:null,r.onError?r.onError:e.events.onError.fire)},t.dataSource.defaultiseOptions=function(e,t,r,n){return t=t||{},t.directModel=r,t.operation=n?"set":"get",t.notFoundIsEmpty=t.notFoundIsEmpty||e.notFoundIsEmpty,t},t.dataSource.get=function(e,r,n){n=t.dataSource.defaultiseOptions(e.options,n,r);var o=t.promise.fireTransformEvent(e.events.onRead,void 0,n);return t.dataSource.registerStandardPromiseHandlers(e,o,n),o},t.dataSource.set=function(e,r,n,o){o=t.dataSource.defaultiseOptions(e.options,o,r,!0);var a=t.promise.fireTransformEvent(e.events.onWrite,n,o),i=t.promise();return a.then(function(n){var a=t.dataSource.defaultiseOptions(e.options,t.copy(o),r),s=t.promise.fireTransformEvent(e.events.onWriteResponse,n,a);t.promise.follow(s,i)},function(e){i.reject(e)}),t.dataSource.registerStandardPromiseHandlers(e,i,o),i}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";function r(t,r){return t=e(t),t.trigger("fluid-"+r),t.triggerHandler(r),t[r](),t}t.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}};var n,o;e.browser||(navigator.userAgent.match(/Trident\/7\./)?o={msie:!0,version:11}:(n=t.uaMatch(navigator.userAgent),o={},n.browser&&(o[n.browser]=!0,o.version=n.version),o.chrome?o.webkit=!0:o.webkit&&(o.safari=!0)),e.browser=o);t.getScopedData=function(t,r){var n=e(t).data("fluid-scoped-data");return n?n[r]:void 0},t.setScopedData=function(t,r,n){e(t).each(function(){var t=e.data(this,"fluid-scoped-data")||{};t[r]=n,e.data(this,"fluid-scoped-data",t)})};var a=null;e(document).on("focusin",function(e){a=e.target}),t.getLastFocusedElement=function(){return a};t.enabled=function(r,n){if(r=e(r),void 0===n)return!1!==t.getScopedData(r,"enablement");e("*",r).add(r).each(function(){void 0!==t.getScopedData(this,"enablement")?t.setScopedData(this,"enablement",n):/select|textarea|input/i.test(this.nodeName)&&e(this).prop("disabled",!n)}),t.setScopedData(r,"enablement",n)},t.initEnablement=function(e){t.setScopedData(e,"enablement",!0)},t.resolveEventTarget=function(e){for(;e.originalEvent&&e.originalEvent.target;)e=e.originalEvent;return e.target},e.each(["focus","blur"],function(e,n){t[n]=function(e){return r(e,n)}}),t.changeElementValue=function(t,r){t=e(t),t.val(r).change()}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.dom=t.dom||{};var r=function(e){if(e.node.firstChild)return e.node=e.node.firstChild,e.depth+=1,e;for(;e.node;){if(e.node.nextSibling)return e.node=e.node.nextSibling,e;e.node=e.node.parentNode,e.depth-=1}return e};t.dom.iterateDom=function(e,n,o){for(var a,i={node:e,depth:0},s=e;null!==i.node&&i.depth>=0&&i.depth<t.dom.iterateDom.DOM_BAIL_DEPTH;){if(a=null,(1===i.node.nodeType||o)&&(a=n(i.node,i.depth)),a)if("delete"===a)i.node.parentNode.removeChild(i.node),i.node=s;else if("stop"===a)return i.node;s=i.node,i=r(i)}},t.dom.iterateDom.DOM_BAIL_DEPTH=256,t.dom.isContainer=function(e,t){for(;t;t=t.parentNode)if(e===t)return!0;return!1},t.dom.getElementText=function(e){for(var t=e.childNodes,r="",n=0;n<t.length;++n){var o=t[n];3===o.nodeType&&(r+=o.nodeValue)}return r}}(jQuery,fluid_3_0_0),fluid_3_0_0=fluid_3_0_0||{},function(e,t){"use strict";var r=/(\\u[\dabcdef]{4}|\\x[\dabcdef]{2})/g;t.unescapeProperties=function(e){e=e.replace(r,function(e){var t=e.substring(2),r=parseInt(t,16);return String.fromCharCode(r)});for(var t=0;;){var n=e.indexOf("\\",t);if(-1===n)break;if(n===e.length-1)return[e.substring(0,e.length-1),!0];var o=e.charAt(n+1);"n"===o&&(o="\n"),"r"===o&&(o="\r"),"t"===o&&(o="\t"),e=e.substring(0,n)+o+e.substring(n+2),t=n+1}return[e,!1]};var n=/[^\\][\s:=]/;t.parseJavaProperties=function(r){var o={};r=r.replace(/\r\n/g,"\n"),r=r.replace(/\r/g,"\n");for(var a,i,s,l,u,c=r.split("\n"),d=0;d<c.length;++d){var f=e.trim(c[d]);if(f&&"#"!==f.charAt(0)&&"!"!==f.charAt(0)){if(a)u=t.unescapeProperties(f);else{s="";var p=f.search(n);-1===p?(i=f,l=""):(i=e.trim(f.substring(0,p+1)),l=e.trim(f.substring(p+2)),":"!==l.charAt(0)&&"="!==l.charAt(0)||(l=e.trim(l.substring(1)))),i=t.unescapeProperties(i)[0],u=t.unescapeProperties(l)}a=u[1],u[1]?s+=u[0]:o[i]=s+u[0]}}return o},t.formatMessage=function(e,t){if(!t)return e;"string"==typeof t&&(t=[t]);for(var r=0;r<t.length;++r)e=e.replace("{"+r+"}",t[r]);return e}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{},fluid=fluid||fluid_3_0_0;!function(e,t){"use strict";function r(e,n,o){function a(e){o.output+=e}var i=n+o.indentChars,s="function"==typeof e;if(void 0!==o.maxRenderChars&&o.output.length>o.maxRenderChars)return!0;if(null===e)a("null");else if(void 0===e)a("undefined");else if(e===t.SYNTHETIC_PROPERTY)a("[Synthetic property]");else if(t.isPrimitive(e)&&!s)a(JSON.stringify(e));else{if(-1!==o.stack.indexOf(e))return void a("(CIRCULAR)");o.stack.push(e);var l;if(t.isArrayable(e))if(0===e.length)a("[]");else{for(a("[\n"+i),l=0;l<e.length;++l){if(r(e[l],i,o))return!0;l!==e.length-1&&a(",\n"+i)}a("\n"+n+"]")}else{a("{"+(s?" Function":"")+"\n"+i);var u=t.keys(e);for(l=0;l<u.length;++l){var c=u[l],d=t.getSafeProperty(e,c);if(a(JSON.stringify(c)+": "),r(d,i,o))return!0;l!==u.length-1&&a(",\n"+i)}a("\n"+n+"}")}o.stack.pop()}}t.renderTimestamp=function(e){var t=function(e,t){t||(t=2);var r=void 0===e?"":e.toString();return"00000".substring(5-t+r.length)+r};return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds(),3)},t.isTracing=!1,t.registerNamespace("fluid.tracing"),t.tracing.pathCount=[],t.tracing.summarisePathCount=function(e){e=e||t.tracing.pathCount;for(var r={},n=0;n<e.length;++n){var o=e[n];r[o]?++r[o]:r[o]=1}var a=[];return t.each(r,function(e,t){a.push({path:t,count:e})}),a.sort(function(e,t){return t.count-e.count}),a},t.tracing.condensePathCount=function(e,r){e=t.makeArray(e);var n={};t.each(e,function(e){n[e]=0});var o=[];return t.each(r,function(r){var a=r.path;t.find(e,function(e){if(0===a.indexOf(e))return n[e]+=r.count,!0})||o.push(r)}),t.each(n,function(e,t){o.unshift({path:t,count:e})}),o},t.detectStackStyle=function(e){var t="other",r={offset:0};return e.arguments?t="chrome":"undefined"!=typeof window&&window.opera&&e.stacktrace?t="opera10":e.stack?(t="firefox",r.offset=-1===e.stack.indexOf("Trace exception")?1:0):"undefined"==typeof window||!window.opera||"stacktrace"in e||(t="opera"),r.style=t,r},t.obtainException=function(){try{throw new Error("Trace exception")}catch(e){return e}};var n=t.detectStackStyle(t.obtainException());t.registerNamespace("fluid.exceptionDecoders"),t.decodeStack=function(){if("firefox"!==n.style)return null;var e=t.obtainException();return t.exceptionDecoders[n.style](e)},t.exceptionDecoders.firefox=function(e){var r=e.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n");return t.transform(r,function(e){e=e.replace(/\)/g,"");var t=e.indexOf("at ");return-1===t?[e]:[e.substring(t+"at ".length),e.substring(0,t)]})},t.getCallerInfo=function(e){e=(e||3)-n.offset;var r=t.decodeStack(),o=r&&r[e][0];if(o){var a=o.lastIndexOf("/");-1===a&&(a=0);var i=o.indexOf(":",a);return{path:o.substring(0,a),filename:o.substring(a+1,i),index:o.substring(i+1)}}return null},t.generatePadding=function(e,t){for(var r="",n=0;n<t;++n)r+=e;return r},t.SYNTHETIC_PROPERTY=Object.freeze({}),t.getSafeProperty=function(e,r){var n=Object.getOwnPropertyDescriptor(e,r);return n&&!n.get?e[r]:t.SYNTHETIC_PROPERTY},t.prettyPrintJSON=function(n,o){return o=e.extend({indent:4,stack:[],output:""},o),o.indentChars=t.generatePadding(" ",o.indent),r(n,"",o),o.output},t.dumpEl=function(r){var n;if(!r)return"null";if(3===r.nodeType||8===r.nodeType)return"[data: "+r.data+"]";if(9===r.nodeType)return"[document: location "+r.location+"]";if(!r.nodeType&&t.isArrayable(r)){n="[";for(var o=0;o<r.length;++o)n+=t.dumpEl(r[o]),o<r.length-1&&(n+=", ");return n+"]"}return r=e(r),n=r.get(0).tagName,r.id&&(n+="#"+r.id),r.attr("class")&&(n+="."+r.attr("class")),n}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";function r(e,r,n,o){for(var a=0;a<n;++a)e=o(e,r[a],a,t.makeArray(r));return e}t.visitComponentChildren=function(e,r,n,o){o=o||[];for(var a in e){var i=e[a];if(!(!t.isComponent(i)||n.visited&&n.visited[i.id])){if(o.push(a),n.visited&&(n.visited[i.id]=!0),r(i,a,o,o.length-1))return!0;n.flat||t.visitComponentChildren(i,r,n,o),o.pop()}}},t.getContextHash=function(e,t){var r=e.idToShadow[t.id];return r&&r.contextHash},t.componentHasGrade=function(e,r){var n=t.getContextHash(t.globalInstantiator,e);return!(!n||!n[r])},t.visitComponentsForMatching=function(r,n,o){var a=t.getInstantiator(r);n=e.extend({visited:{},instantiator:a},n);var i=[r],s=[t.getContextHash(a,r)],l=function(e,r,n){i.length=1,s.length=1;for(var l=0;l<n.length;++l){var u=i[l][n[l]];i[l+1]=u,s[l+1]=t.getContextHash(a,u)||{}}return o(e,i,s,n,n.length)};t.visitComponentChildren(r,l,n,[])},t.getMemberNames=function(e,r){if(0===r.length)return[];var n=e.idToPath(r[r.length-1].id),o=e.parseEL(n);return o.unshift.apply(o,t.generate(r.length-o.length,"")),o},t.visitComponentsForVisibility=function(e,r,n,o){o=o||{visited:{},flat:!0,instantiator:e};for(var a=t.getMemberNames(e,r),i=r.length-1;i>=0;--i){var s=r[i];if(o.visited[s.id]=!0,n(s,a[i],a,i))return;if(t.visitComponentChildren(s,n,o,a))return;a.pop()}},t.mountStrategy=function(e,t,r){var n=e.length;return function(t,o,a,i){if(!(a<=e.length)){for(var s=0;s<e.length;++s)if(i[s]!==e[s])return;return r(t,o,a-e.length,i.slice(n))}}},t.invokerFromRecord=function(e,r,n){t.pushActivity("makeInvoker","beginning instantiation of invoker with name %name and record %record as child of %that",{name:r,record:e,that:n});var o=e?t.makeInvoker(n,e,r):void 0;return t.popActivity(),o},t.memberFromRecord=function(r,n,o){for(var a,i=0;i<r.length;++i){var s=t.expandImmediate(r[i],o);a=t.isPlainObject(a)?e.extend(!0,a,s):s}return a},t.recordStrategy=function(e,r,n,o,a,i,s){return i=i||[],{strategy:function(i,s,l){if(1===l){var u=t.driveStrategy(r,[o,s],n);if(void 0!==u){t.set(i,[s],t.inEvaluationMarker);var c=a(u,s,e);return t.set(i,[s],c),c}}},initter:function(){var a=t.driveStrategy(r,o,n)||{};for(var l in a)s&&s[l]||t.getForComponent(e,i.concat([l]))}}},t.instantiateFirers=function(e){var r=t.shadowForComponent(e);(t.get(r,["eventStrategyBlock","initter"])||t.identity)()},t.makeDistributionRecord=function(r,n,o,a,i,s){s=s||"distribution",t.pushActivity("makeDistributionRecord","Making distribution record from source record %sourceRecord path %sourcePath to target path %targetSegs",{sourceRecord:n,sourcePath:o,targetSegs:a});var l=t.copy(t.get(n,o));t.each(i,function(e){t.model.applyChangeRequest(l,{segs:e,type:"DELETE"})});var u={options:{}};return t.model.applyChangeRequest(u,{segs:a,type:"ADD",value:l}),t.checkComponentRecord(u),t.popActivity(),e.extend(u,{contextThat:r,recordType:s})},t.filterBlocks=function(r,n,o,a,i,s){var l=[];return t.each(n,function(n){var u=t.get(n.source,o);if(void 0!==u){l.push(t.makeDistributionRecord(r,n.source,o,a,i,n.recordType));var c=e.extend({},u);s&&t.model.applyChangeRequest(n.source,{segs:o,type:"DELETE"}),t.each(i,function(e){var r=t.get(c,e);t.set(n.source,o.concat(e),r)})}}),l},t.noteCollectedDistribution=function(e,r,n){t.model.setSimple(e,["collectedDistributions",r,n.id],!0)},t.isCollectedDistribution=function(e,r,n){return t.model.getSimple(e,["collectedDistributions",r,n.id])},t.clearCollectedDistributions=function(e,r){t.model.applyChangeRequest(e,{segs:["collectedDistributions",r],type:"DELETE"})},t.collectDistributions=function(e,r,n,o,a,i,s){var l=i[i.length-1];!t.isCollectedDistribution(r,l,n)&&t.matchIoCSelector(n.selector,o,a,i,s)&&(e.push.apply(e,n.blocks),t.noteCollectedDistribution(r,l,n))},t.registerCollectedClearer=function(e,r,n){!e.collectedClearer&&r&&(e.collectedClearer=function(){t.clearCollectedDistributions(r,n)})},t.receiveDistributions=function(e,r,n,o){var a=t.getInstantiator(e||o),i=a.getThatStack(e||o);i.unshift(t.rootComponent);var s=t.getMemberNames(a,i),l=t.transform(i,function(e){return a.idToShadow[e.id]}),u=l[l.length-(e?1:2)],c=t.getMembers(l,"contextHash");e?(s.push(n),c.push(t.gradeNamesToHash(r)),i.push(o)):t.registerCollectedClearer(l[l.length-1],u,s[s.length-1]);for(var d=[],f=0;f<i.length-1;++f)t.each(l[f].distributions,function(e){t.collectDistributions(d,u,e,i,c,s,f)});return d},t.computeTreeDistance=function(e,t){for(var r=0;r<e.length&&r<t.length&&e[r]===t[r];)++r;return e.length+t.length-2*r},t.computeDistributionPriority=function(e,r){if(!r.priority){var n=t.getInstantiator(e),o=n.getThatStack(e),a=t.getMemberNames(n,o),i=n.getThatStack(r.contextThat),s=t.getMemberNames(n,i),l=t.computeTreeDistance(a,s);r.priority=t.mergeRecordTypes.distribution-l}return r},t.applyDistributions=function(e,r,n){var o=t.transform(r,function(r){return t.generateExpandBlock(r,e,n.mergePolicy)},function(r){return t.computeDistributionPriority(e,r)}),a=n.mergeOptions;return a.mergeBlocks.push.apply(a.mergeBlocks,o),a.updateBlocks(),o},t.matchIoCSelector=function(e,t,r,n,o){for(var a=t.length-1,i=e.length-1;;){for(var s=a===t.length-1||e[i].child,l=t[a],u=e[i],c=!0,d=0;d<u.predList.length;++d){var f=u.predList[d];if(f.context&&!r[a][f.context]&&n[a]!==f.context){c=!1;break}if(f.id&&l.id!==f.id){c=!1;break}}if(0===i&&a>o&&s&&(c=!1),c){if(0===i)return!0;--a,--i}else{if(s)return!1;--a}if(a<o)return!1}},t.queryIoCSelector=function(e,r,n){var o=t.parseSelector(r,t.IoCSSMatcher),a=[];return t.visitComponentsForMatching(e,{flat:n},function(e,r,n,i,s){t.matchIoCSelector(o,r,n,i,s)&&a.push(e)}),a},t.isIoCSSSelector=function(e){return-1!==e.indexOf(" ")},t.pushDistributions=function(e,r,n,o){var a=t.shadowForComponent(e),i=t.allocateGuid(),s={id:i,target:n,selector:r,blocks:o};return Object.freeze(s),Object.freeze(s.blocks),t.pushArray(a,"distributions",s),i},t.clearDistribution=function(e,r){var n=t.globalInstantiator.idToShadow[e];n&&t.remove_if(n.distributions,function(e){return e.id===r})},t.clearDistributions=function(e){t.each(e.outDistributions,function(e){t.clearDistribution(e.targetHeadId,e.distributionId)})},t.extractSelectorHead=function(e){var t=e[0].predList,r=t[0].context;return t.length=0,r},t.parseExpectedOptionsPath=function(e,r){var n=t.model.parseEL(e);return"options"!==n[0]&&t.fail("Error in options distribution path ",e," - only "+r+' paths beginning with "options" are supported'),n.slice(1)},t.replicateProperty=function(e,r,n){void 0!==e[r]&&t.each(n,function(t){t[r]=e[r]})},t.undistributableOptions=["gradeNames","distributeOptions","argumentMap","initFunction","mergePolicy","progressiveCheckerOptions"],t.distributeOptions=function(e,r){var n=t.shadowForComponent(e),o=t.driveStrategy(e.options,"distributeOptions",r);t.each(o,function(r){t.pushActivity("distributeOptions","parsing distributeOptions block %record %that ",{that:e,record:r}),"string"!=typeof r.target&&t.fail("Error in options distribution record ",r,' a member named "target" must be supplied holding an IoC reference'),"string"==typeof r.source^void 0===r.record&&t.fail("Error in options distribution record ",r,': must supply either a member "source" holding an IoC reference or a member "record" holding a literal record');var o,a,i,s=t.parseContextReference(r.target);if(t.isIoCSSSelector(s.context)){a=t.parseSelector(s.context,t.IoCSSMatcher);var l=t.extractSelectorHead(a);"/"===l?o=t.rootComponent:i=l}else i=s.context;(o=o||t.resolveContext(i,e))||t.fail("Error in options distribution record ",r," - could not resolve context {"+i+"} to a head component");var u,c=t.model.parseEL(s.path);if(void 0!==r.record)u=[t.makeDistributionRecord(e,r.record,[],c,[])];else{var d=t.parseContextReference(r.source);"that"!==d.context&&t.fail("Error in options distribution record ",r," only a context of {that} is supported");var f=t.parseExpectedOptionsPath(d.path,"source"),p=t.makeArray(r.exclusions).concat(0===f.length?t.undistributableOptions:[]),m=t.transform(p,function(e){return t.model.parseEL(e)});u=t.filterBlocks(e,n.mergeOptions.mergeBlocks,f,c,m,r.removeSource),n.mergeOptions.updateBlocks()}if(t.replicateProperty(r,"priority",u),t.replicateProperty(r,"namespace",u),a){var g=t.pushDistributions(o,a,r.target,u);n.outDistributions=n.outDistributions||[],n.outDistributions.push({targetHeadId:o.id,distributionId:g})}else{var h=t.shadowForComponent(o);t.applyDistributions(e,u,h)}t.popActivity()})},t.gradeNamesToHash=function(e){var r={};return t.each(e,function(e){r[e]=!0,r[t.computeNickName(e)]=!0}),r},t.cacheShadowGrades=function(e,r){var n=t.gradeNamesToHash(e.options.gradeNames);n[r.memberName]||(n[r.memberName]="memberName"),r.contextHash=n,t.each(n,function(t,n){r.ownScope[n]=e,r.parentShadow&&"fluid.rootComponent"!==r.parentShadow.that.type&&(r.parentShadow.childrenScope[n]=e)})},t.deliverOptionsStrategy=function(e,r,n){var o=t.shadowForComponent(e,o);t.cacheShadowGrades(e,o),o.mergeOptions=n},t.collectDistributedGrades=function(e){var r=t.receiveDistributions(null,null,null,e.that);if(r.length>0){var n=t.applyDistributions(e.that,r,e.shadow),o=t.transform(t.getMembers(n,["source","gradeNames"]),t.makeArray);t.accumulateDynamicGrades(e,t.flatten(o))}},t.applyDynamicGrades=function(e){e.oldGradeNames=t.makeArray(e.gradeNames);var r=t.copy(t.getMergedDefaults(e.that.typeName,e.gradeNames));e.gradeNames.length=0,e.gradeNames.push.apply(e.gradeNames,r.gradeNames),t.each(e.gradeNames,function(r){t.isIoCReference(r)||(e.seenGrades[r]=!0)});var n=e.shadow;t.cacheShadowGrades(e.that,n),n.mergeOptions.destroyValue(["mergePolicy"]),n.mergeOptions.destroyValue(["components"]),n.mergeOptions.destroyValue(["invokers"]),e.defaultsBlock.source=r,n.mergeOptions.updateBlocks(),n.mergeOptions.computeMergePolicy(),t.accumulateDynamicGrades(e,r.gradeNames)},t.accumulateDynamicGrades=function(e,r){t.each(r,function(r){e.seenGrades[r]||(t.isIoCReference(r)?(e.rawDynamic.push(r),e.seenGrades[r]=!0):t.contains(e.oldGradeNames,r)||e.plainDynamic.push(r))})},t.computeDynamicGrades=function(e,r,n){delete e.options.gradeNames;var o=t.driveStrategy(e.options,"gradeNames",n);o.length=0;var a=t.findMergeBlocks(r.mergeOptions.mergeBlocks,"defaults")[0],i={that:e,shadow:r,defaultsBlock:a,gradeNames:o,seenGrades:{},plainDynamic:[],rawDynamic:[]};for(t.each(r.mergeOptions.mergeBlocks,function(e){o.push.apply(o,t.makeArray(e.target&&e.target.gradeNames)),t.applyDynamicGrades(i)}),t.collectDistributedGrades(i);;){for(;i.plainDynamic.length>0;)o.push.apply(o,i.plainDynamic),i.plainDynamic.length=0,t.applyDynamicGrades(i),t.collectDistributedGrades(i);if(!(i.rawDynamic.length>0))break;var s=t.expandImmediate(i.rawDynamic.shift(),e,r.localDynamic);"function"==typeof s&&(s=s()),s&&(i.plainDynamic=i.plainDynamic.concat(s))}r.collectedClearer&&(r.collectedClearer(),delete r.collectedClearer)},t.computeDynamicComponentKey=function(e,t){return e+(0===t?"":"-"+t)},t.registerDynamicRecord=function(e,r,n,o,a){var i=t.computeDynamicComponentKey(r,n),s=t.copy(o);return delete s[a],t.set(e.options,["components",i],s),i},t.computeDynamicComponents=function(e,r){var n=t.shadowForComponent(e),o=n.subcomponentLocal={},a=t.driveStrategy(e.options,"dynamicComponents",r.strategy);t.each(a,function(r,a){if(r.sources||r.createOnEvent||t.fail("Cannot process dynamicComponents record ",r,' without a "sources" or "createOnEvent" entry'),r.sources){var i=t.expandOptions(r.sources,e);t.each(i,function(n,i){var s=t.registerDynamicRecord(e,a,i,r,"sources");o[s]={source:n,sourcePath:i}})}else if(r.createOnEvent){var s=t.event.expandOneEvent(e,r.createOnEvent);t.set(n,["dynamicComponentCount",a],0);var l=function(){var o=t.registerDynamicRecord(e,a,n.dynamicComponentCount[a]++,r,"createOnEvent"),i={arguments:t.makeArray(arguments)};t.initDependent(e,o,i)};s.addListener(l),t.recordListener(s,l,n)}})},t.computeComponentAccessor=function(e,r){var n=t.globalInstantiator,o=t.shadowForComponent(e);o.localDynamic=r;var a=e.options,i=o.mergeOptions.strategy,s=t.mountStrategy(["options"],a,i);o.invokerStrategy=t.recordStrategy(e,a,i,"invokers",t.invokerFromRecord),o.eventStrategyBlock=t.recordStrategy(e,a,i,"events",t.eventFromRecord,["events"]);var l=t.mountStrategy(["events"],e,o.eventStrategyBlock.strategy,["events"]);if(o.memberStrategy=t.recordStrategy(e,a,i,"members",t.memberFromRecord,null,{model:!0,modelRelay:!0}),o.getConfig={strategies:[t.model.funcResolverStrategy,t.makeGingerStrategy(e),s,o.invokerStrategy.strategy,o.memberStrategy.strategy,l]},t.computeDynamicGrades(e,o,i,o.mergeOptions.mergeBlocks),t.distributeOptions(e,i),o.contextHash["fluid.resolveRoot"]){var u;if(o.contextHash["fluid.resolveRootSingle"]){var c=t.getForComponent(e,["options","singleRootType"]);c||t.fail("Cannot register object with grades "+Object.keys(o.contextHash).join(", ")+" as fluid.resolveRootSingle since it has not defined option singleRootType"),u=t.typeNameToMemberName(c)}else u=t.computeGlobalMemberName(e);var d=t.resolveRootComponent;d[u]&&n.clearComponent(d,u),n.recordKnownComponent(d,e,u,!1)}return o.getConfig},t.shadowForComponent=function(e){var r=t.getInstantiator(e);return r&&e?r.idToShadow[e.id]:null},t.getForComponent=function(e,r){var n=t.shadowForComponent(e),o=n?n.getConfig:void 0;return t.get(e,r,o)},t.makeGingerStrategy=function(e){var r=t.getInstantiator(e);return function(e,n,o,a){var i=e[n];if(i===t.inEvaluationMarker&&o===a.length&&t.fail('Error in component configuration - a circular reference was found during evaluation of path segment "'+n+'": for more details, see the activity records following this message in the console, or issue fluid.setLogging(fluid.logLevel.TRACE) when running your application'),o>1)return i;if(void 0===i&&e.hasOwnProperty(n))return t.NO_VALUE;if(void 0===i){var s=r.idToShadow[e.id].path,l=r.composePath(s,n);i=r.pathToComponent[l]}if(void 0===i){var u=t.getForComponent(e,["options","components",n]);u&&(u.createOnEvent&&t.fail('Error resolving path segment "'+n+'" of path '+a.join(".")+" since component with record ",u,' has annotation "createOnEvent" - this very likely represents an implementation error. Either alter the reference so it does not  match this component, or alter your workflow to ensure that the component is instantiated by the time this reference resolves'),t.initDependent(e,n),i=e[n])}return i}},t.frameworkGrades=["fluid.component","fluid.modelComponent","fluid.viewComponent","fluid.rendererComponent"],t.filterBuiltinGrades=function(e){return t.remove_if(t.makeArray(e),function(e){return-1!==t.frameworkGrades.indexOf(e)})},t.dumpGradeNames=function(e){return e.options&&e.options.gradeNames?" gradeNames: "+JSON.stringify(t.filterBuiltinGrades(e.options.gradeNames)):""},t.dumpThat=function(e){return'{ typeName: "'+e.typeName+'"'+t.dumpGradeNames(e)+" id: "+e.id+"}"},
t.dumpThatStack=function(e,r){return t.transform(e,function(e){var n=r.idToPath(e.id);return t.dumpThat(e)+(n?" - path: "+n:"")}).join("\n")},t.dumpComponentPath=function(e){var r=t.pathForComponent(e);return r?t.pathUtil.composeSegments(r):"** no path registered for component **"},t.resolveContext=function(e,r,n){if("that"===e)return r;if("object"==typeof e){var o=t.resolveContext(e.context,r,n);t.isComponent(o)||t.triggerMismatchedPathError(e.context,r);var a=t.getForComponent(o,e.path),i=t.expandOptions(a,r);return t.isComponent(i)||t.fail("Unable to resolve recursive context expression "+t.renderContextReference(e)+": the directly resolved value of "+a+" did not resolve to a component in the scope of component ",r,": got ",i),i}var s,l=t.globalInstantiator;if(n){return l.idToShadow[r.id].ownScope[e]}var u=l.getFullStack(r);return t.visitComponentsForVisibility(l,u,function(r,n){var o=t.shadowForComponent(r);return e===n||o&&o.contextHash&&o.contextHash[e]||e===r.typeName?(s=r,!0):t.getForComponent(r,["options","components",e])&&!r[e]?(s=t.getForComponent(r,e),!0):void 0}),s},t.triggerMismatchedPathError=function(e,r){var n=t.renderContextReference(e);t.fail("Failed to resolve reference "+n+" - could not match context with name "+e.context+" from component "+t.dumpThat(r)+" at path "+t.dumpComponentPath(r)+" component: ",r)},t.makeStackFetcher=function(e,r,n){return function(o){e&&"destroyed"===e.lifecycleStatus&&t.fail("Cannot resolve reference "+t.renderContextReference(o)+" from component "+t.dumpThat(e)+" which has been destroyed");var a=o.context;if(r&&a in r)return t.get(r[a],o.path);var i=t.resolveContext(a,e,n);return i||""===o.path||t.triggerMismatchedPathError(o,e),t.getForComponent(i,o.path)}},t.makeStackResolverOptions=function(r,n,o){return e.extend(t.copy(t.rawDefaults("fluid.makeExpandOptions")),{localRecord:n||{},fetcher:t.makeStackFetcher(r,n,o),contextThat:r,exceptions:{members:{model:!0,modelRelay:!0}}})},t.clearListeners=function(e){t.each(e.listeners,function(e){e.event.removeListener(e.listenerId||e.listener)}),delete e.listeners},t.recordListener=function(e,r,n,o){e.ownerId!==n.that.id&&t.pushArray(n,"listeners",{event:e,listener:r,listenerId:o})},t.constructScopeObjects=function(e,t,r,n){var o=t?e.idToShadow[t.id]:null;n.childrenScope=o?Object.create(o.ownScope):{},n.ownScope=Object.create(n.childrenScope),n.parentShadow=o},t.clearChildrenScope=function(e,r,n,o){t.each(o.contextHash,function(e,t){r.childrenScope[t]===n&&delete r.childrenScope[t]})},t.instantiator=function(){function r(e,r,o,a,i){var s;if(i)s=n.idToShadow[r.id]={},s.that=r,s.path=o,s.memberName=a,t.constructScopeObjects(n,e,r,s);else{s=n.idToShadow[r.id],s.injectedPaths=s.injectedPaths||{},s.injectedPaths[o]=!0;var l=n.idToShadow[e.id],u=t.keys(s.contextHash);t.remove_if(u,function(e){return s.contextHash&&"memberName"===s.contextHash[e]}),u.push(a),t.each(u,function(e){l.childrenScope[e]||(l.childrenScope[e]=r)})}n.pathToComponent[o]&&t.fail("Error during instantiation - path "+o+" which has just created component "+t.dumpThat(r)+" has already been used for component "+t.dumpThat(n.pathToComponent[o])+" - this is a circular instantiation or other oversight. Please clear the component using instantiator.clearComponent() before reusing the path."),n.pathToComponent[o]=r}var n=t.typeTag("instantiator");return e.extend(n,{lifecycleStatus:"constructed",pathToComponent:{},idToShadow:{},modelTransactions:{init:{}},composePath:t.model.composePath,composeSegments:t.model.composeSegments,parseEL:t.model.parseEL,events:{onComponentAttach:t.makeEventFirer({name:"instantiator's onComponentAttach event"}),onComponentClear:t.makeEventFirer({name:"instantiator's onComponentClear event"})}}),n.idToPath=function(e){var t=n.idToShadow[e];return t?t.path:""},n.getThatStack=function(e){var t=n.idToShadow[e.id];if(t){for(var r=t.path,o=n.parseEL(r),a=n.pathToComponent[""],i=[],s=0;s<o.length;++s)a=a[o[s]],i.push(a);return i}return[]},n.getFullStack=function(e){var r=e?n.getThatStack(e):[];return r.unshift(t.resolveRootComponent),r},n.recordRoot=function(e){r(null,e,"","",!0)},n.recordKnownComponent=function(e,o,a,i){if(e[a]=o,t.isComponent(o)||"instantiator"===o.type){var s=n.idToShadow[e.id].path,l=n.composePath(s,a);r(e,o,l,a,i),n.events.onComponentAttach.fire(o,l,n,i)}else t.fail("Cannot record non-component with value ",o,' at path "'+a+'" of parent ',e)},n.clearConcreteComponent=function(e){t.each(e.childShadow.injectedPaths,function(r,o){var a=t.model.getToTailPath(o),i=n.pathToComponent[a];n.clearComponent(i,t.model.getTailPath(o),e.child)}),t.clearDistributions(e.childShadow),t.clearListeners(e.childShadow),t.fireEvent(e.child,"afterDestroy",[e.child,e.name,e.component]),delete n.idToShadow[e.child.id]},n.clearComponent=function(e,r,o,a,i,s){var l=n.idToShadow[e.id];a=a||{flat:!0,instantiator:n,destroyRecs:[]},o=o||e[r],void 0===(s=s||l.path)&&t.fail("Cannot clear component "+r+" from component ",e," which was not created by this instantiator");var u=n.composePath(s,r),c=n.idToShadow[o.id];if(c){var d=c.path===u;n.events.onComponentClear.fire(o,u,e,d),d?(t.visitComponentChildren(o,function(e,t,r,i){var s=n.composeSegments.apply(null,r.slice(0,i));n.clearComponent(o,t,null,a,!0,s)},a,n.parseEL(u)),t.doDestroy(o,r,e),a.destroyRecs.push({child:o,childShadow:c,name:r,component:e})):t.remove_if(c.injectedPaths,function(e,t){return t===u}),t.clearChildrenScope(n,l,o,c),delete n.pathToComponent[u],i||(delete e[r],t.each(a.destroyRecs,n.clearConcreteComponent))}},n},t.globalInstantiator=t.instantiator(),t.getInstantiator=function(e){var r=t.globalInstantiator;return e&&r.idToShadow[e.id]?r:null},t.defaults("fluid.resolveRoot"),t.defaults("fluid.resolveRootSingle",{gradeNames:"fluid.resolveRoot"}),t.constructRootComponents=function(e){t.rootComponent=e.rootComponent=t.typeTag("fluid.rootComponent"),e.recordRoot(t.rootComponent),t.resolveRootComponent=e.resolveRootComponent=t.typeTag("fluid.resolveRootComponent"),e.recordKnownComponent(t.rootComponent,t.resolveRootComponent,"resolveRootComponent",!0);var r=e.idToShadow[t.rootComponent.id];r.contextHash={};var n=e.idToShadow[t.resolveRootComponent.id];n.ownScope=r.ownScope,n.childrenScope=r.childrenScope,e.recordKnownComponent(t.resolveRootComponent,e,"instantiator",!0),n.childrenScope.instantiator=e},t.constructRootComponents(t.globalInstantiator),t.expandOptions=function(e,r,n,o,a){if(!e)return e;t.pushActivity("expandOptions","expanding options %args for component %that ",{that:r,args:e});var i=t.makeStackResolverOptions(r,o);i.mergePolicy=n,i.defer=a&&a.defer;var s=i.defer?t.makeExpandOptions(e,i):t.expand(e,i);return t.popActivity(),s},t.localRecordExpected=t.arrayToHash(["type","options","container","createOnEvent","priority","recordType"]),t.checkComponentRecord=function(e){t.each(e,function(r,n){t.localRecordExpected[n]||t.fail("Probable error in subcomponent record ",e,' - key "'+n+'" found, where the only legal options are '+t.keys(t.localRecordExpected).join(", "))})},t.mergeRecordsToList=function(e,r){var n=[];return t.each(r,function(r,o){if(r.recordType=o,"distributions"===o)n.push.apply(n,t.transform(r,function(r){return t.computeDistributionPriority(e,r)}));else{if(!r.options)return;r.priority=t.mergeRecordTypes[o],void 0===r.priority&&t.fail("Merge record with unrecognised type "+o+": ",r),n.push(r)}}),n};var n=function(e){return t.each(["gradeNames","mergePolicy","argumentMap","components","dynamicComponents","events","listeners","modelListeners","modelRelay","distributeOptions","transformOptions"],function(r){t.set(e,[r,"*","noexpand"],!0)}),e};t.generateExpandBlock=function(e,r,n,o){var a=t.expandOptions(e.options,e.contextThat||r,n,o,{defer:!0});return a.priority=e.priority,a.namespace=e.namespace,a.recordType=e.recordType,a};var o=function(r,o,a,i){var s=t.copy(o);n(r),t.shadowForComponent(i).mergePolicy=r;var l={defaults:{options:s}};e.extend(l,a.mergeRecords),l.subcomponentRecord&&t.checkComponentRecord(l.subcomponentRecord);var u=t.mergeRecordsToList(i,l);return t.transform(u,function(e){return t.generateExpandBlock(e,i,r,a.localRecord)})};t.fabricateDestroyMethod=function(e,t,r,n){return function(){r.clearComponent(e,t,n)}},t.computeGlobalMemberName=function(e){return t.computeNickName(e.typeName)+"-"+e.id},t.typeNameToMemberName=function(e){return e.replace(/\./g,"_")},t.expandComponentOptions=function(e,r,n,a){var i=n,s=n&&n.marker===t.EXPAND?n.instantiator:null;t.pushActivity("expandComponentOptions","expanding component options %options with record %record for component %that",{options:s?n.mergeRecords.user:n,record:i,that:a}),s||(s=t.globalInstantiator,i={mergeRecords:{user:{options:t.expandCompact(n,!0)}},memberName:t.computeGlobalMemberName(a),instantiator:s,parentThat:t.rootComponent}),a.destroy=t.fabricateDestroyMethod(i.parentThat,i.memberName,s,a),s.recordKnownComponent(i.parentThat,a,i.memberName,!0);var l=o(e,r,i,a);return t.popActivity(),l},t.assembleCreatorArguments=function(r,n,o){var a=t.defaults(n);a&&a.argumentMap||t.fail("Error in assembleCreatorArguments: cannot look up component type name "+n+" to a component creator grade with an argumentMap");var i={},s=r?t.receiveDistributions(r,a.gradeNames,o.memberName,i):[];t.each(s,function(e){t.computeDistributionPriority(r,e),t.isPrimitive(e.priority)&&(e.priority=t.parsePriority(e.priority,0,!1,"options distribution"))}),t.sortByPriority(s);var l=o.localDynamic,u=e.extend({},t.censorKeys(o.componentRecord,["type"]),l),c=a.argumentMap,d=Object.keys(c).concat(["type"]);t.each(d,function(e){for(var t=0;t<s.length;++t)void 0!==s[t][e]&&(u[e]=s[t][e])}),n=u.type||n,delete u.type,delete u.options;var f={distributions:s};void 0!==o.componentRecord&&(f.subcomponentRecord=e.extend({},o.componentRecord));var p=[];return t.each(c,function(e,n){var a;if("options"===n)a={marker:t.EXPAND,localRecord:l,mergeRecords:f,instantiator:t.getInstantiator(r),parentThat:r,memberName:o.memberName};else{var i=u[n];a=t.expandImmediate(i,r,u)}p[e]=a}),{args:p,funcName:n}},t.initDependent=function(e,r,n){if(!e[r]){var o,a=e.options.components[r],i=t.globalInstantiator,s=i.idToShadow[e.id],l=n||s.subcomponentLocal&&s.subcomponentLocal[r];if(t.pushActivity("initDependent",'instantiating dependent component at path "%path" with record %record as child of %parent',{path:s.path+"."+r,record:a,parent:e}),"string"==typeof a||a.expander)e[r]=t.inEvaluationMarker,o=t.expandImmediate(a,e),o?i.recordKnownComponent(e,o,r,!1):delete e[r];else if(a.type){var u=t.expandImmediate(a.type,e,l);u||t.fail("Error in subcomponent record: ",a.type," could not be resolved to a type for component ",r," of parent ",e);var c=t.assembleCreatorArguments(e,u,{componentRecord:a,memberName:r,localDynamic:l});o=t.initSubcomponentImpl(e,{type:c.funcName},c.args)}else t.fail("Unrecognised material in place of subcomponent "+r+' - no "type" field found');return t.popActivity(),o}},t.bindDeferredComponent=function(e,r,n){var o=t.makeArray(n.createOnEvent);t.each(o,function(o){var a=t.isIoCReference(o)?t.expandOptions(o,e):e.events[o];a&&a.addListener||t.fail("Error instantiating createOnEvent component with name "+r+" of parent ",e," since event specification "+o+" could not be expanded to an event - got ",a),a.addListener(function(){t.pushActivity("initDeferred","instantiating deferred component %componentName of parent %that due to event %eventName",{componentName:r,that:e,eventName:o}),e[r]&&t.globalInstantiator.clearComponent(e,r);var n={arguments:t.makeArray(arguments)};t.initDependent(e,r,n),t.popActivity()},null,n.priority)})},t.priorityForComponent=function(e){return e.priority?e.priority:"fluid.typeFount"===e.type||t.hasGrade(t.defaults(e.type),"fluid.typeFount")?"first":void 0},t.initDependents=function(e){t.pushActivity("initDependents","instantiating dependent components for component %that",{that:e});var r=t.shadowForComponent(e);if(r.memberStrategy.initter(),r.invokerStrategy.initter(),t.getForComponent(e,"modelRelay"),t.getForComponent(e,"model"),!t.isDestroyed(e)){var n=e.options,o=n.components||{},a=[];t.each(o,function(r,n){if(r.createOnEvent)t.bindDeferredComponent(e,n,r);else{var o=t.priorityForComponent(r);a.push({namespace:n,priority:t.parsePriority(o)})}}),t.sortByPriority(a),t.each(a,function(r){t.initDependent(e,r.namespace)}),r.subcomponentLocal&&t.clear(r.subcomponentLocal),e.lifecycleStatus="constructed",t.assessTreeConstruction(e,r),t.popActivity()}},t.assessTreeConstruction=function(e,r){var n=t.globalInstantiator,o=n.getThatStack(e);t.find_if(o,function(e){return"constructing"===e.lifecycleStatus})?e.lifecycleStatus="constructed":t.markSubtree(n,e,r.path,"treeConstructed")},t.markSubtree=function(e,r,n,o){r.lifecycleStatus=o,t.visitComponentChildren(r,function(r,a){var i=e.composePath(n,a),s=e.idToShadow[r.id];s&&s.path===i&&t.markSubtree(e,r,i,o)},{flat:!0})},t.pathForComponent=function(e,r){r=r||t.getInstantiator(e)||t.globalInstantiator;var n=r.idToShadow[e.id];return n?r.parseEL(n.path):null},t.construct=function(e,r,n){var o=t.destroy(e,n);return t.set(o.parent,["options","components",o.memberName],{type:r.type,options:r}),t.initDependent(o.parent,o.memberName)},t.destroy=function(e,r){r=r||t.globalInstantiator;var n=t.model.parseToSegments(e,r.parseEL,!0);0===n.length&&t.fail("Cannot destroy the root component");var o=n.pop(),a=r.composeSegments.apply(null,n),i=r.pathToComponent[a];return i||t.fail("Cannot modify component with nonexistent parent at path ",e),i[o]&&i[o].destroy(),{parent:i,memberName:o}},t.constructSingle=function(r,n,o){o=o||t.globalInstantiator,r=r||"";var a=t.model.parseToSegments(r,o.parseEL,!0);"string"==typeof n&&(n={type:n});var i=n.type;i||t.fail("Cannot construct singleton object without a type entry"),n=e.extend({},n);var s=n.gradeNames=t.makeArray(n.gradeNames);s.unshift(i),n.type="fluid.component",0===a.length&&s.push("fluid.resolveRoot");var l=t.typeNameToMemberName(n.singleRootType||i);a.push(l),t.construct(a,n,o)},t.destroySingle=function(e,r,n){n=n||t.globalInstantiator;var o=t.model.parseToSegments(e,n.parseEL,!0),a=t.typeNameToMemberName(r);o.push(a),t.destroy(o,n)},t.makeGradeLinkage=function(e,r,n){t.defaults(e,{gradeNames:"fluid.component",distributeOptions:{record:n,target:"{/ "+r.join("&")+"}.options.gradeNames"}}),t.constructSingle([],e)},t.componentForPath=function(e){return t.globalInstantiator.pathToComponent[t.isArrayable(e)?e.join("."):e]},t.debugger=function(){},t.defaults("fluid.debuggingProbe",{gradeNames:["fluid.component"]}),t.probeToDistribution=function(e){var r=t.globalInstantiator,n=t.parseContextReference(e.target),o=t.model.parseToSegments(n.path,r.parseEL,!0);"options"!==o[0]&&o.unshift("options");var a=t.parsePriority(e.priority);return a.constraint&&!a.constraint.target&&(a.constraint.target="authoring"),{target:"{/ "+n.context+"}."+r.composeSegments.apply(null,o),record:{func:e.func,funcName:e.funcName,args:e.args,priority:t.renderPriority(a)}}},t.registerProbes=function(e){var r=t.transform(e,t.probeToDistribution),n="fluid_debuggingProbe_"+t.allocateGuid();return t.construct([n],{type:"fluid.debuggingProbe",distributeOptions:r}),n},t.deregisterProbes=function(e){t.destroy([e])},t.thisistToApplicable=function(e,r,n){return{apply:function(o,a){var i=t.expandOptions(r,n);"string"==typeof i&&(i=t.getGlobalValue(i)),i||t.fail("Could not resolve reference "+r+" to a value");var s=i[e.method];return"function"!=typeof s&&t.fail("Object ",i," at reference "+r+" has no member named "+e.method+" which is a function "),t.passLogLevel(t.logLevel.TRACE)&&t.log(t.logLevel.TRACE,"Applying arguments ",a," to method "+e.method+" of instance ",i),s.apply(i,a)}}},t.changeToApplicable=function(e,r){return{apply:function(n,o,a,i){var s=t.parseValidModelReference(r,"changePath listener record",e.changePath),l=t.expandOptions(e.value,r,{},t.extend(a,{arguments:o})),u=i&&i.source&&i.source.length?t.makeArray(e.source).concat(i.source):e.source;s.applier.change(s.modelSegs,l,e.type,u)}}},t.recordToApplicable=function(e,r,n){if(void 0!==e.changePath)return t.changeToApplicable(e,r,n);var o=e.this;return e.method^o&&t.fail("Record ",r,' must contain both entries "method" and "this" if it contains either'),e.method?t.thisistToApplicable(e,o,r):null},t.getGlobalValueNonComponent=function(e,r){var n=t.defaults(e);return n&&t.hasGrade(n,"fluid.component")&&t.fail("Error in function specification - cannot invoke function "+e+" in the context of "+r+": component creator functions can only be used as subcomponents"),t.getGlobalValue(e)},t.makeInvoker=function(e,r,n){r=t.upgradePrimitiveFunc(r),void 0===r.args||r.args===t.NO_VALUE||t.isArrayable(r.args)||(r.args=t.makeArray(r.args));var o=t.recordToApplicable(r,e),a=t.preExpand(r.args),i={},s=t.makeStackResolverOptions(e,i,!0);return o=o||(r.funcName?t.getGlobalValueNonComponent(r.funcName,"an invoker"):t.expandImmediate(r.func,e)),o&&o.apply?o===t.notImplemented&&t.fail("Error constructing component ",e," - the invoker named "+n+" which was defined in grade "+r.componentSource+" needs to be overridden with a concrete implementation"):t.fail("Error in invoker record: could not resolve members func, funcName or method to a function implementation - got "+o+" from ",r),function(){!1===t.defeatLogging&&t.pushActivity("invokeInvoker","invoking invoker with name %name and record %record from path %path holding component %that",{name:n,record:r,path:t.dumpComponentPath(e),that:e});var l,u;return"destroyed"===e.lifecycleStatus?t.log(t.logLevel.WARN,"Ignoring call to invoker "+n+" of component ",e," which has been destroyed"):(i.arguments=arguments,void 0===r.args||r.args===t.NO_VALUE?u=arguments:(t.expandImmediateImpl(a,s),u=a.source),l=o.apply(null,u)),!1===t.defeatLogging&&t.popActivity(),l}},t.event.makeTrackedListenerAdder=function(e){var r=t.shadowForComponent(e);return function(e){return{addListener:function(n,o,a,i,s){t.recordListener(e,n,r,s),e.addListener.apply(null,arguments)}}}},t.event.listenerEngine=function(e,r,n){function o(){if(!t.find(e,function(e,t){if(void 0===a[t])return!0})){var n=a;a={},r(n)}}var a={};t.each(e,function(e,r){n(e).addListener(function(){a[r]=t.makeArray(arguments),o()})})},t.event.dispatchListener=function(e,r,n,o,a){void 0===o.args||o.args===t.NO_VALUE||t.isArrayable(o.args)||(o.args=t.makeArray(o.args)),r=t.event.resolveListener(r);var i=t.preExpand(o.args),s={},l=t.makeStackResolverOptions(e,s,!0),u=function(){!1===t.defeatLogging&&t.pushActivity("dispatchListener","firing to listener to event named %eventName of component %that",{eventName:n,that:e});var u,c=a?arguments[0]:arguments;s.arguments=c,void 0!==o.args&&o.args!==t.NO_VALUE?(t.expandImmediateImpl(i,l),u=i.source):u=c;var d=r.apply(null,u);return!1===t.defeatLogging&&t.popActivity(),d};return t.event.impersonateListener(r,u),u},t.event.resolveSoftNamespace=function(e){if("string"!=typeof e)return null;var t=Math.max(e.lastIndexOf("."),e.lastIndexOf("}"));return e.substring(t+1)},t.event.resolveListenerRecord=function(e,r,n,o,a){var i=function(e,r){t.fail("Error in listener record - could not resolve reference ",e,' to a listener or firer. Did you miss out "events." when referring to an event firer?'+r)};t.pushActivity("resolveListenerRecord","resolving listener record for event named %eventName for component %that",{eventName:n,that:r});var s=t.makeArray(e),l=t.transform(s,function(e){var s=t.isPrimitive(e)||e.expander?{listener:e}:t.copy(e),l=t.recordToApplicable(e,r,a);s.listener=l||(s.listener||s.func||s.funcName),s.listener||i(e,' Listener record must contain a member named "listener", "func", "funcName" or "method"');var u=e.method?t.event.resolveSoftNamespace(e.this)+"."+e.method:t.event.resolveSoftNamespace(s.listener);s.namespace||o||!u||(s.softNamespace=!0,s.namespace=(e.componentSource?e.componentSource:r.typeName)+"."+u);var c=s.listener=t.expandOptions(s.listener,r);c||i(e,"");var d=!1;return"fluid.event.firer"===c.typeName&&(c=c.fire,d=!0),s.listener=a&&(s.args&&"fluid.notImplemented"!==c||d)?t.event.dispatchListener(r,c,n,s):c,s.listenerId=t.allocateGuid(),s}),u={records:l,adderWrapper:a?t.event.makeTrackedListenerAdder(r):null};return t.popActivity(),u},t.event.expandOneEvent=function(e,r){var n;return n="string"==typeof r&&"{"!==r.charAt(0)?t.getForComponent(e,["events",r]):t.expandOptions(r,e),n&&"fluid.event.firer"===n.typeName||t.fail("Error in event specification - could not resolve base event reference ",r," to an event firer: got ",n),n},t.event.expandEvents=function(e,r){return"string"==typeof r?t.event.expandOneEvent(e,r):t.transform(r,function(r){return t.event.expandOneEvent(e,r)})},t.event.resolveEvent=function(e,r,n){t.pushActivity("resolveEvent","resolving event with name %eventName attached to component %that",{eventName:r,that:e});var o=t.event.makeTrackedListenerAdder(e);"string"==typeof n&&(n={event:n});var a="fluid.event.firer"===n.typeName?n:n.event||n.events;a||t.fail("Event specification for event with name "+r+" does not include a base event specification: ",n);var i,s="fluid.event.firer"===a.typeName?a:t.event.expandEvents(e,a),l="fluid.event.firer"!==s.typeName,u=n.args||l;if(u){i=t.makeEventFirer({name:" [composite] "+t.event.nameEvent(e,r)});var c=t.event.dispatchListener(e,i.fire,r,n,l);l?t.event.listenerEngine(s,c,o):o(s).addListener(c)}else i={typeName:"fluid.event.firer"},i.fire=function(){var e=t.makeArray(arguments);t.pushActivity("fireSynthetic","firing synthetic event %eventName ",{eventName:r});var n=s.fire.apply(null,e);return t.popActivity(),n},i.addListener=function(a,i,l,u,c){var d=t.event.dispatchListener(e,a,r,n);o(s).addListener(d,i,l,u,c)},i.removeListener=function(e){s.removeListener(e)};return t.popActivity(),i},t.withEnvironment=function(r,n,o){var a;o=o||t.globalThreadLocal();try{for(a in r)o[a]=r[a];return e.extend(o,r),n()}finally{for(a in r)delete o[a]}},t.fetchContextReference=function(e,r,n,o,a){o&&(e=o(e,n));var i=e.context?n[e.context]:r;if(!i){return a&&a(e)||i}return e.noDereference?e.path:t.get(i,e.path)},t.makeEnvironmentFetcher=function(e,r,n,o){return n=n||t.globalThreadLocal,function(a){var i=n();return t.fetchContextReference(a,e,i,r,o)}},t.coerceToPrimitive=function(e){return"false"!==e&&("true"===e||(isFinite(e)?Number(e):e))},t.compactStringToRec=function(r,n){var o=r.indexOf("("),a=r.indexOf(")");if((-1===o^-1===a||o>a)&&t.fail("Badly-formed compact "+n+" record without matching parentheses: "+r),-1!==o&&-1!==a){var i=r.substring(a+1);""!==e.trim(i)&&t.fail("Badly-formed compact "+n+" record "+r+" - unexpected material following close parenthesis: "+i);var s=r.substring(0,o),l=e.trim(r.substring(o+1,a)),u=""===l?[]:t.transform(l.split(","),e.trim,t.coerceToPrimitive),c=t.upgradePrimitiveFunc(s,null);return c.args=u,c}return"expander"===n&&t.fail("Badly-formed compact expander record without parentheses: "+r),r},t.expandPrefix="@expand:",t.expandCompactString=function(e,r){var n=e;if(0===e.indexOf(t.expandPrefix)){var o=e.substring(t.expandPrefix.length);n={expander:t.compactStringToRec(o,"expander")}}else r&&(n=t.compactStringToRec(e,r));return n};var a={listeners:"listener",modelListeners:"modelListener"},i=e.extend({invokers:"invoker"},a);t.expandCompactRec=function(e,r,n){t.guardCircularExpansion(e,e.length);var o=e.length>0?e[e.length-1]:"",s=i[o];!s&&e.length>1&&(s=a[e[e.length-2]]),t.each(n,function(n,o){if(t.isPlainObject(n))return r[o]=t.freshContainer(n),e.push(o),t.expandCompactRec(e,r[o],n),void e.pop();"string"==typeof n&&(n=t.expandCompactString(n,s)),r[o]=n})},t.expandCompact=function(e){var r={};return t.expandCompactRec([],r,e),r},t.extractEL=function(e,t){if("ALL"===t.ELstyle)return e;if(1===t.ELstyle.length){if(e.charAt(0)===t.ELstyle)return e.substring(1)}else if("${}"===t.ELstyle){var r=e.indexOf("${"),n=e.lastIndexOf("}");if(0===r&&-1!==n)return e.substring(2,n)}},t.extractELWithContext=function(e,r){var n=t.extractEL(e,r);return t.isIoCReference(n)?t.parseContextReference(n):n?{path:n}:n},t.parseContextReference=function(e,r,n){r=r||0;var o,a,i,s="{"===e.charAt(r+1);s?(i=t.parseContextReference(e,r+1,"}"),o=i.endpos):o=e.indexOf("}",r+1),-1===o&&t.fail('Cannot parse context reference "'+e+'": Malformed context reference without }'),a=s?i:e.substring(r+1,o);var l=n?e.indexOf(n,o+1):e.length,u=e.substring(o+1,l);return"."===u.charAt(0)&&(u=u.substring(1)),{context:a,path:u,endpos:l}},t.renderContextReference=function(e){var r=e.context;return"{"+("string"==typeof r?r:t.renderContextReference(r))+"}"+(e.path?"."+e.path:"")},t.resolveContextValue=function(e,r){function n(e){t.pushActivity("resolveContextValue","resolving context value %parsed",{parsed:e});var n=r.fetcher(e);return t.pushActivity("resolvedContextValue","resolved value %parsed to value %value",{parsed:e,value:n}),t.popActivity(2),n}var o;if(r.bareContextRefs&&t.isIoCReference(e))return o=t.parseContextReference(e),n(o);if(r.ELstyle&&"${}"!==r.ELstyle&&(o=t.extractELWithContext(e,r)))return n(o);for(;"string"==typeof e;){var a=e.indexOf("${"),i=e.indexOf("}",a+2);if(-1===a||-1===i)break;"{"===e.charAt(a+2)?(o=t.parseContextReference(e,a+2,"}"),i=o.endpos):o={path:e.substring(a+2,i)};var s=n(o),l=0===a&&i===e.length-1;if(void 0===s||null===s)return s;e=l?s:e.substring(0,a)+s+e.substring(i+1)}return e},t.fetchExpandChildren=function(r,n,o,a,i,s){if(a.expander){var l=t.expandExpander(r,a,s);if(t.isPrimitive(l)||!t.isPlainObject(l)||t.isArrayable(l)^t.isArrayable(r))return l;e.extend(!0,r,l)}return t.each(a,function(e,l){void 0===e?r[l]=void 0:"expander"!==l&&(o[n]=l,!0!==t.getImmediate(s.exceptions,o,n)&&s.strategy(r,l,n+1,o,a,i))}),r},t.isUnexpandable=function(e){return t.isPrimitive(e)||!t.isPlainObject(e)},t.expandSource=function(e,r,n,o,a,i,s,l){var u,c,d=t.derefMergePolicy(s);return"string"!=typeof i||d.noexpand?d.noexpand||t.isUnexpandable(i)?u=i:i.expander?u=t.expandExpander(a,i,e):(u=t.freshContainer(i),c=!0):e.defaultEL&&"{"!==i.charAt(0)?u=i:(t.pushActivity("expandContextValue","expanding context value %source held at path %path",{source:i,path:t.path.apply(null,o.slice(0,n))}),u=t.resolveContextValue(i,e),t.popActivity(1)),u!==t.NO_VALUE&&a(u),c&&l(u,i,n,o,s),u},t.guardCircularExpansion=function(e,r){r>t.strategyRecursionBailout&&t.fail("Overflow/circularity in options expansion, current path is ",e," at depth ",r,' - please ensure options are not circularly connected, or protect from expansion using the "noexpand" policy or expander')},t.makeExpandStrategy=function(e){var n=function(r,n,o,a,i){return t.fetchExpandChildren(r,o||0,a||[],n,i,e)},o=function(o,a,i,s,l,u){function c(e){o[a]=e}if(t.guardCircularExpansion(s,i),o){if(o.hasOwnProperty(a))return o[a];void 0===l&&(l=r(e.source,s,i-1,e.sourceStrategy),u=r(e.mergePolicy,s,i-1,t.concreteTrundler));var d=e.sourceStrategy(l,a,i,s),f=t.concreteTrundler(u,a);return t.expandSource(e,o,i,s,c,d,f,n)}};return e.recurse=n,e.strategy=o,o},t.defaults("fluid.makeExpandOptions",{ELstyle:"${}",bareContextRefs:!0,target:t.inCreationMarker}),t.makeExpandOptions=function(r,n){return n=e.extend({},t.rawDefaults("fluid.makeExpandOptions"),n),n.defaultEL="${}"===n.ELStyle&&n.bareContextRefs,n.expandSource=function(e){return t.expandSource(n,null,0,[],t.identity,e,n.mergePolicy,!1)},t.isUnexpandable(r)?(n.strategy=t.concreteTrundler,n.initter=t.identity,n.target="string"==typeof r?(n.defer?t.copy:t.identity)(n.expandSource(r)):r,n.immutableTarget=!0):(n.source=r,n.target=t.freshContainer(r),n.sourceStrategy=n.sourceStrategy||t.concreteTrundler,t.makeExpandStrategy(n),n.initter=function(){n.target=t.fetchExpandChildren(n.target,0,[],n.source,n.mergePolicy,n)}),n},t.expand=function(e,r){var n=t.makeExpandOptions(e,r);return n.initter(),n.target},t.preExpandRecurse=function(e,r,n,o,a){function i(t){e.expanders.push({expander:t,holder:n,member:o}),delete n[o]}if(t.guardCircularExpansion(a,a.length),t.isIoCReference(r)){var s=t.parseContextReference(r),l=t.model.parseEL(s.path);i({typeFunc:t.expander.fetch,context:s.context,segs:l})}else t.isPlainObject(r)&&(r.expander?(r.expander.typeFunc=t.getGlobalValue(r.expander.type||"fluid.invokeFunc"),i(r.expander)):t.each(r,function(n,o){a.push(o),t.preExpandRecurse(e,n,r,o,a),a.pop()}))},t.preExpand=function(e){var r={expanders:[],source:t.isUnexpandable(e)?e:t.copy(e)};return t.preExpandRecurse(r,r.source,r,"source",[]),r},t.expandImmediate=function(e,r,n){var o=t.makeStackResolverOptions(r,n,!0),a=t.preExpand(e);return t.expandImmediateImpl(a,o),a.source},t.expandImmediateImpl=function(e,t){for(var r=e.expanders,n=0;n<r.length;++n){var o=r[n];o.holder[o.member]=o.expander.typeFunc(null,o,t)}},t.expandExpander=function(e,r,n){var o=t.getGlobalValue(r.expander.type||"fluid.invokeFunc");return o||t.fail("Unknown expander with type "+r.expander.type),o(e,r,n)},t.registerNamespace("fluid.expander"),t.expander.fetch=function(e,r,n){var o=n.localRecord,a=r.expander.context,i=r.expander.segs,s=void 0!==o[a],l=n.contextThat.lifecycleStatus,u="treeConstructed"===l||"destroyed"===l,c=s?o[a]:t.resolveContext(a,n.contextThat,u);if(c){var d=c;if(s||"constructing"!==c.lifecycleStatus)for(var f=0;f<i.length;++f)d=d?d[i[f]]:void 0;else d=t.getForComponent(c,i);return void 0!==d||s||(d=t.getForComponent(c,i)),d}i.length>0&&t.triggerMismatchedPathError(r.expander,n.contextThat)},t.invokeFunc=function(e,r,n){var o=r.expander,a=t.makeArray(o.args);o.args=a,n.recurse?a=n.recurse([],a):(o=t.expandImmediate(o,n.contextThat,n.localRecord),a=o.args);var i=o.func||o.funcName,s=(n.expandSource?n.expandSource(i):i)||t.recordToApplicable(o,n.contextThat);return"string"==typeof s&&(s=t.getGlobalValue(s)),s||t.fail("Error in expander record ",o,": "+i+" could not be resolved to a function for component ",n.contextThat),s.apply(null,a)},t.noexpand=function(e,t){return t.expander.value?t.expander.value:t.expander.tree}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.model.makeEnvironmentStrategy=function(e){return function(t,r,n){return 0===n&&e[r]?e[r]:void 0}},t.model.defaultCreatorStrategy=function(e,t){if(void 0===e[t])return e[t]={},e[t]},t.model.defaultFetchStrategy=function(e,t){return e[t]},t.model.funcResolverStrategy=function(e,t){if(e.resolvePathSegment)return e.resolvePathSegment(t)},t.model.traverseWithStrategy=function(e,r,n,o,a){for(var i=o.strategies,s=r.length-a,l=n;l<s;++l){if(!e)return e;for(var u,c=0;c<i.length&&void 0===(u=i[c](e,r[l],l+1,r));++c);u===t.NO_VALUE&&(u=void 0),e=u}return e},t.model.getValueAndSegments=function(e,r,n,o){return t.model.accessWithStrategy(e,r,t.NO_VALUE,n,o,!0)},t.model.makeTrundler=function(e){return function(r,n){return t.model.getValueAndSegments(r.root,n,e,r.segs)}},t.model.getWithStrategy=function(e,r,n,o){return t.model.accessWithStrategy(e,r,t.NO_VALUE,n,o)},t.model.setWithStrategy=function(e,r,n,o,a){t.model.accessWithStrategy(e,r,n,o,a)},t.model.accessWithStrategy=function(e,r,n,o,a,i){if(t.isPrimitive(r)||t.isArrayable(r))return t.model.accessImpl(e,r,n,o,a,i,t.model.traverseWithStrategy);var s=r.type||"default",l=o.resolvers[s];l||t.fail("Unable to find resolver of type "+s);var u=t.model.makeTrundler(o),c={root:e,segs:a};return c=l(c,r,u),r.path&&c&&(c=u(c,r.path)),i?c:c?c.root:void 0},t.registerNamespace("fluid.pathUtil"),t.pathUtil.getPathSegmentImpl=function(e,t,r){var n=null;e&&(n="");for(var o=!1,a=t.length;r<a;++r){var i=t.charAt(r);if(o)o=!1,null!==n&&(n+=i);else{if("."===i)break;"\\"===i?o=!0:null!==n&&(n+=i)}}return null!==n&&(e[0]=n),r};var r=[];t.pathUtil.parseEL=function(e){for(var n=[],o=0,a=e.length;o<a;){var i=t.pathUtil.getPathSegmentImpl(r,e,o);n.push(r[0]),o=i+1}return n},t.pathUtil.composeSegment=function(e,t){t=t.toString();for(var r=0;r<t.length;++r){var n=t.charAt(r);"."!==n&&"\\"!==n&&"}"!==n||(e+="\\"),e+=n}return e},t.pathUtil.escapeSegment=function(e){return t.pathUtil.composeSegment("",e)},t.pathUtil.composePath=function(e,r){return 0!==e.length&&(e+="."),t.pathUtil.composeSegment(e,r)},
t.pathUtil.composeSegments=function(){for(var e="",r=0;r<arguments.length;++r)e=t.pathUtil.composePath(e,arguments[r]);return e},t.pathUtil.matchSegments=function(e,t,r,n){if(n-r!==e.length)return!1;for(var o=r;o<n;++o)if(t[o]!==e[o-r])return!1;return!0},t.model.unescapedParser={parse:t.model.parseEL,compose:t.model.composeSegments},t.model.defaultGetConfig={parser:t.model.unescapedParser,strategies:[t.model.funcResolverStrategy,t.model.defaultFetchStrategy]},t.model.defaultSetConfig={parser:t.model.unescapedParser,strategies:[t.model.funcResolverStrategy,t.model.defaultFetchStrategy,t.model.defaultCreatorStrategy]},t.model.escapedParser={parse:t.pathUtil.parseEL,compose:t.pathUtil.composeSegments},t.model.escapedGetConfig={parser:t.model.escapedParser,strategies:[t.model.defaultFetchStrategy]},t.model.escapedSetConfig={parser:t.model.escapedParser,strategies:[t.model.defaultFetchStrategy,t.model.defaultCreatorStrategy]},t.stronglyConnected=function(e,r){var n={stack:[],accessor:r,components:[],index:0};return e.forEach(function(e){void 0===e.tarjanIndex&&t.stronglyConnectedOne(e,n)}),n.components},t.stronglyConnectedOne=function(e,r){if(e.tarjanIndex=r.index,e.lowIndex=r.index,++r.index,r.stack.push(e),e.onStack=!0,r.accessor(e).forEach(function(n){void 0===n.tarjanIndex?(t.stronglyConnectedOne(n,r),e.lowIndex=Math.min(e.lowIndex,n.lowIndex)):n.onStack&&(e.lowIndex=Math.min(e.lowIndex,n.tarjanIndex))}),e.lowIndex===e.tarjanIndex){var n,o=[];do{n=r.stack.pop(),n.onStack=!1,o.push(n)}while(n!==e);r.components.push(o)}},t.initRelayModel=function(e){return t.deenlistModelComponent(e),e.model},t.isModelComplete=function(e){return"model"in e&&e.model!==t.inEvaluationMarker},t.enlistModelComponent=function(e){var r=t.getInstantiator(e),n=r.modelTransactions.init[e.id];return n||(n={that:e,applier:t.getForComponent(e,"applier"),complete:t.isModelComplete(e)},r.modelTransactions.init[e.id]=n),n},t.clearTransactions=function(){var e=t.globalInstantiator;t.clear(e.modelTransactions),e.modelTransactions.init={}},t.failureEvent.addListener(t.clearTransactions,"clearTransactions","before:fail"),t.clearLinkCounts=function(e,r){t.each(e,function(t,n){"number"==typeof t?e[n]=0:r&&t.options&&"number"==typeof t.relayCount&&(t.relayCount=0)})},t.computeInitialOutArcs=function(e,r){return t.transform(r,function(n,o){var a={},i=n.that.applier.listeners.sortedListeners;t.each(i,function(r){if(r.isRelay&&!t.isExcludedChangeSource(e[o],r.cond)){var n=r.targetId;n!==o&&(a[n]=!0)}});var s=Object.keys(a),l=s.map(function(e){return r[e]});return t.remove_if(l,function(e){return void 0===e}),l})},t.sortCompleteLast=function(e,t){return(e.completeOnInit?1:0)-(t.completeOnInit?1:0)},t.operateInitialTransaction=function(e,r){var n,o=t.allocateGuid(),a=t.getModelTransactionRec(e,o),i=t.transform(r,function(e){return n=e.that.applier.initiate(null,"init",o),a[e.that.applier.applierId]={transaction:n},n}),s=t.computeInitialOutArcs(i,r),l=function(e){return s[e.that.id]},u=t.values(r),c=0;t.stronglyConnected(u,l).forEach(function(e){e.forEach(function(e){e.initPriority=e.completeOnInit?Math.Infinity:c++})}),u.sort(function(e,t){return e.initPriority-t.initPriority}),u.forEach(function(e){var r=e.that,n=i[r.id];e.completeOnInit?t.initModelEvent(r,r.applier,n,r.applier.listeners.sortedListeners):t.each(e.initModels,function(e){n.fireChangeRequest({type:"ADD",segs:[],value:e}),t.clearLinkCounts(a,!0)});var o=t.shadowForComponent(r);o&&(o.modelComplete=!0)}),n.commit()},t.deenlistModelComponent=function(e){var r=t.getInstantiator(e),n=r.modelTransactions.init;if(n[e.id]){e.model=void 0,n[e.id].complete=!0;if(!t.find_if(n,function(e){return!0!==e.complete})){try{t.operateInitialTransaction(e,n)}catch(e){throw t.clearTransactions(),e}r.modelTransactions.init={}}}},t.parseModelReference=function(e,r){var n=t.parseContextReference(r);return n.segs=e.applier.parseEL(n.path),n},t.parseValidModelReference=function(e,r,n,o){var a,i=function(){var e=["Error in "+r+": ",n].concat(t.makeArray(arguments));t.fail.apply(null,e)},s=function(e){i(" must be a reference to a component with a ChangeApplier (descended from fluid.modelComponent), instead got ",e)};if("string"==typeof n)if(t.isIoCReference(n)){a=t.parseModelReference(e,n);var l=a.segs.indexOf("model");-1===l?o?a.nonModel=!0:i(' must be a reference into a component model via a path including the segment "model"'):(a.modelSegs=a.segs.slice(l+1),a.contextSegs=a.segs.slice(0,l),delete a.path)}else a={path:n,modelSegs:e.applier.parseEL(n)};else t.isArrayable(n.segs)||i(' must contain an entry "segs" holding path segments referring a model path within a component'),a={context:n.context,modelSegs:t.expandOptions(n.segs,e)};var u,c;return a.context?(u=t.resolveContext(a.context,e),u||i(" context must be a reference to an existing component"),c=a.contextSegs?t.getForComponent(u,a.contextSegs):u):c=e,a.nonModel||(t.isComponent(c)||s(c),c.applier||t.getForComponent(c,["applier"]),c.applier||s(c)),a.that=c,a.applier=c&&c.applier,a.path||(a.path=c&&c.applier.composeSegments.apply(null,a.modelSegs)),a},t.getModelTransactionRec=function(e,r){var n=t.getInstantiator(e);if(r||t.fail("Cannot get transaction record without transaction id"),!n)return null;var o=n.modelTransactions[r];return o||(o=n.modelTransactions[r]={relays:[],sources:{},externalChanges:{}}),o},t.recordChangeListener=function(e,r,n,o){var a=t.shadowForComponent(e);t.recordListener(r.modelChanged,n,a,o)},t.registerRelayTransaction=function(e,r,n,o,a){var i=r.initiate("relay",null,n),s=e[r.applierId]={transaction:i,relayCount:0,namespace:a.namespace,priority:a.priority,options:o};return s.priority=t.parsePriority(s.priority,e.relays.length,!1,"model relay"),e.relays.push(s),s},t.relayRecursionBailout=100,t.registerDirectChangeRelay=function(e,r,n,o,a,i,s,l){var u=s.targetApplier||e.applier,c=s.sourceApplier||n.applier,d=u.applierId;r=t.makeArray(r),o=t.makeArray(o);var f=function(n,c,f,p,m,g){var h=m.id,v=t.getModelTransactionRec(e,h);g&&m&&!v[g.applierId]&&(v[g.applierId]={transaction:m});var y=v[d];v[a]=v[a]||0;++v[a],v[a]>t.relayRecursionBailout&&t.fail("Error in model relay specification at component ",e," - operated more than "+t.relayRecursionBailout+" relays without model value settling - current model contents are ",m.newHolder.model),y||(y=t.registerRelayTransaction(v,u,h,s,l)),i&&!s.targetApplier?i(y.transaction,s.sourceApplier?void 0:n,o,r,p):(p&&"DELETE"===p.type&&y.transaction.fireChangeRequest({type:"DELETE",segs:r}),void 0!==n&&y.transaction.fireChangeRequest({type:"ADD",segs:r,value:n}))},p=c.modelChanged.addListener({isRelay:!0,cond:i&&i.cond,targetId:e.id,targetApplierId:u.id,segs:o,transactional:s.transactional},f);t.passLogLevel(t.logLevel.TRACE)&&t.log(t.logLevel.TRACE,"Adding relay listener with listenerId "+p.listenerId+" to source applier with id "+c.applierId+" from target applier with id "+d+" for target component with id "+e.id),n&&(t.recordChangeListener(n,c,f,p.listenerId),e!==n&&t.recordChangeListener(e,c,f,p.listenerId))},t.connectModelRelay=function(e,r,n,o,a){function i(e){var r=t.enlistModelComponent(e);if(r.complete){t.shadowForComponent(e).modelComplete&&(r.completeOnInit=!0)}}var s=t.allocateGuid();i(n),i(e);var l=t.filterKeys(a,["namespace","priority"]);a.update?a.targetApplier?t.registerDirectChangeRelay(e,r,n,o,s,null,{transactional:!1,targetApplier:a.targetApplier,update:a.update},l):t.registerDirectChangeRelay(n,o,e,[],s+"-transform",a.forwardAdapter,{transactional:!0,sourceApplier:a.forwardApplier},l):(t.registerDirectChangeRelay(n,o,e,r,s,a.forwardAdapter,{transactional:!1},l),t.registerDirectChangeRelay(e,r,n,o,s,a.backwardAdapter,{transactional:!1},l))},t.parseSourceExclusionSpec=function(e,r){return e.excludeSource=t.arrayToHash(t.makeArray(r.excludeSource||(r.includeSource?"*":void 0))),e.includeSource=t.arrayToHash(t.makeArray(r.includeSource)),e},t.isExcludedChangeSource=function(e,t){if(!t||!t.excludeSource)return!1;var r=t.excludeSource["*"];for(var n in e.fullSources)t.excludeSource[n]&&(r=!0),t.includeSource[n]&&(r=!1);return r},t.model.guardedAdapter=function(e,r,n,o){t.isExcludedChangeSource(e,r)||n===t.model.transform.uninvertibleTransform||n.apply(null,o)},t.transformToAdapter=function(e,r){var n={};return n[r]=e,function(e,o,a,i,s){s&&"DELETE"===s.type&&e.fireChangeRequest({type:"DELETE",path:r}),t.model.transformWithRules(o,n,{finalApplier:e})}},t.makeTransformPackage=function(e,r,n,o,a,i,s,l){var u={forwardHolder:{model:r},backwardHolder:{model:null}};u.generateAdapters=function(e){if(u.forwardAdapterImpl=t.transformToAdapter(e?e.newHolder.model:u.forwardHolder.model,o),null!==n){var a=t.model.transform.invertConfiguration(r);a!==t.model.transform.uninvertibleTransform?(u.backwardHolder.model=a,u.backwardAdapterImpl=t.transformToAdapter(u.backwardHolder.model,n)):u.backwardAdapterImpl=a}},u.forwardAdapter=function(e,r){void 0===r&&u.generateAdapters(),t.model.guardedAdapter(e,a,u.forwardAdapterImpl,arguments)},u.forwardAdapter.cond=a,u.runTransform=function(e){e.commit(),e.reset()},u.forwardApplier=t.makeHolderChangeApplier(u.forwardHolder),u.forwardApplier.isRelayApplier=!0,u.invalidator=t.makeEventFirer({name:"Invalidator for model relay with applier "+u.forwardApplier.applierId}),null!==n&&(u.backwardApplier=t.makeHolderChangeApplier(u.backwardHolder),u.backwardAdapter=function(e){t.model.guardedAdapter(e,i,u.backwardAdapterImpl,arguments)},u.backwardAdapter.cond=i),u.update=u.invalidator.fire;var c={targetApplier:u.forwardApplier,update:u.update,namespace:s,priority:l,refCount:0};return u.forwardHolder.model=t.parseImplicitRelay(e,r,[],c),u.refCount=c.refCount,u.namespace=s,u.priority=l,u.generateAdapters(),u.invalidator.addListener(u.generateAdapters),u.invalidator.addListener(u.runTransform),u},t.singleTransformToFull=function(t){return{"":{transform:e.extend(!0,{inputPath:""},t)}}},t.model.relayConditions={initOnly:{includeSource:"init"},liveOnly:{excludeSource:"init"},never:{includeSource:[]},always:{}},t.model.parseRelayCondition=function(e){"initOnly"===e?t.log(t.logLevel.WARN,'The relay condition "initOnly" is deprecated: Please use the form \'includeSource: "init"\' instead'):"liveOnly"===e&&t.log(t.logLevel.WARN,'The relay condition "liveOnly" is deprecated: Please use the form \'excludeSource: "init"\' instead');var r;return e?"string"==typeof e?(r=t.model.relayConditions[e])||t.fail('Unrecognised model relay condition string "'+e+'": the supported values are "never" or a record with members "includeSource" and/or "excludeSource"'):r=e:r={},t.parseSourceExclusionSpec({},r)},t.parseModelRelay=function(e,r,n){var o=void 0!==r.source?t.parseValidModelReference(e,'modelRelay record member "source"',r.source):{path:null,modelSegs:null},a=t.parseValidModelReference(e,'modelRelay record member "target"',r.target),i=r.namespace||n,s=r.singleTransform?t.singleTransformToFull(r.singleTransform):r.transform;s||t.fail('Cannot parse modelRelay record without element "singleTransform" or "transform":',r);var l=t.model.parseRelayCondition(r.forward),u=t.model.parseRelayCondition(r.backward),c=t.makeTransformPackage(e,s,o.path,a.path,l,u,i,r.priority);0===c.refCount?t.connectModelRelay(o.that||e,o.modelSegs,a.that,a.modelSegs,t.filterKeys(c,["forwardAdapter","backwardAdapter","namespace","priority"])):(o.modelSegs&&t.fail('Error in model relay definition: If a relay transform has a model dependency, you can not specify a "source" entry - please instead enter this as "input" in the transform specification. Definition was ',r," for component ",e),t.connectModelRelay(e,null,a.that,a.modelSegs,c))},t.parseImplicitRelay=function(e,r,n,o){var a;if(t.isIoCReference(r)){var i=t.parseValidModelReference(e,"model reference from model (implicit relay)",r,!0);i.nonModel?a=t.getForComponent(i.that,i.segs):(++o.refCount,t.connectModelRelay(e,n,i.that,i.modelSegs,o))}else t.isPrimitive(r)||!t.isPlainObject(r)?a=r:r.expander&&t.isPlainObject(r.expander)?a=t.expandOptions(r,e):(a=t.freshContainer(r),t.each(r,function(r,i){n.push(i);var s=t.parseImplicitRelay(e,r,n,o);void 0!==s&&(a[i]=s),n.pop()}));return a},t.model.notifyExternal=function(e){var r=e?t.values(e.externalChanges):[];t.sortByPriority(r);for(var n=0;n<r.length;++n){var o=r[n];o.args[5].destroyed||o.listener.apply(null,o.args)}t.clearLinkCounts(e,!0)},t.model.commitRelays=function(e,r){var n=e.modelTransactions[r];t.each(n,function(e){e.transaction&&(e.transaction.commit("relay"),e.transaction.reset())})},t.model.updateRelays=function(e,r){var n=e.modelTransactions[r],o=0;return t.sortByPriority(n.relays),t.each(n.relays,function(e){e.transaction.changeRecord.changes>0&&e.relayCount<2&&e.options.update&&(e.relayCount++,t.clearLinkCounts(n),e.options.update(e.transaction,n),++o)}),o},t.establishModelRelay=function(e,r,n,o,a){function i(e){for(;t.model.updateRelays(f,e.id)>0;);}function s(e,r,n){"relay"!==n&&t.model.commitRelays(f,e.id)}function l(e,r,n){"relay"!==n&&(t.model.notifyExternal(f.modelTransactions[e.id]),delete f.modelTransactions[e.id])}var u=t.shadowForComponent(e);u.modelRelayEstablished?t.fail("FLUID-5887 failure: Model relay initialised twice on component",e):u.modelRelayEstablished=!0,t.mergeModelListeners(e,n);var c=t.enlistModelComponent(e);t.each(o,function(r,n){for(var o=0;o<r.length;++o)t.parseModelRelay(e,r[o],n)});var d=t.transform(r,function(r){return t.parseImplicitRelay(e,r,[],{refCount:0,priority:"first"})});c.initModels=d;var f=t.getInstantiator(e);return a.preCommit.addListener(i),a.preCommit.addListener(s),a.postCommit.addListener(l),null},t.defaults("fluid.modelComponent",{gradeNames:["fluid.component"],changeApplierOptions:{relayStyle:!0,cullUnchanged:!0},members:{model:"@expand:fluid.initRelayModel({that}, {that}.modelRelay)",applier:"@expand:fluid.makeHolderChangeApplier({that}, {that}.options.changeApplierOptions)",modelRelay:"@expand:fluid.establishModelRelay({that}, {that}.options.model, {that}.options.modelListeners, {that}.options.modelRelay, {that}.applier)"},mergePolicy:{model:{noexpand:!0,func:t.arrayConcatPolicy},modelListeners:t.makeMergeListenersPolicy(t.arrayConcatPolicy),modelRelay:t.makeMergeListenersPolicy(t.arrayConcatPolicy,!0)}}),t.modelChangedToChange=function(e){return{value:e[0],oldValue:e[1],path:e[2],transaction:e[4]}},t.event.invokeListener=function(e,r,n,o){return"string"==typeof e&&(e=t.event.resolveListener(e)),e.apply(null,r,n,o)},t.resolveModelListener=function(e,r){var n=function(){if(!t.isDestroyed(e)){var n=t.modelChangedToChange(arguments),o=arguments,a={change:n,arguments:o},i={source:Object.keys(n.transaction.sources)};r.args&&(o=t.expandOptions(r.args,e,{},a)),t.event.invokeListener(r.listener,t.makeArray(o),a,i)}};return t.event.impersonateListener(r.listener,n),n},t.registerModelListeners=function(e,r,n,o){var a=t.resolveModelListener(e,r);t.each(r.byTarget,function(n){function i(){if(t.isModelComplete(s.that)){var r=s.applier.initiate(null,"init");t.initModelEvent(e,s.applier,r,[l]),r.commit()}}var s=n[0],l={listener:a,listenerId:t.allocateGuid(),segsArray:t.getMembers(n,"modelSegs"),pathArray:t.getMembers(n,"path"),includeSource:r.includeSource,excludeSource:r.excludeSource,priority:t.expandOptions(r.priority,e),transactional:!0};if(l=s.applier.modelChanged.addListener(l,a,o,r.softNamespace),t.recordChangeListener(e,s.applier,a,l.listenerId),e!==s.that&&!t.isModelComplete(e)){t.getForComponent(e,["events","onCreate"]).addListener(i)}})},t.mergeModelListeners=function(e,r){t.each(r,function(r,n){"string"==typeof r&&(r={funcName:r});var o=t.event.resolveListenerRecord(r,e,"modelListeners",null,!1).records;t.each(o,function(r){r.byTarget={};var o=t.makeArray(void 0===r.path?n:r.path);t.each(o,function(n){var o=t.parseValidModelReference(e,"modelListeners entry",n);t.pushArray(r.byTarget,o.that.id,o)});var a=(r.namespace&&!r.softNamespace?r.namespace:null)||(void 0!==r.path?n:null);t.registerModelListeners(e,r,o,a)})})},t.fireChanges=function(e,t){for(var r=0;r<t.length;++r)e.fireChangeRequest(t[r])},t.model.isChangedPath=function(e,t){for(var r=0;r<=t.length;++r){if("string"==typeof e)return!0;r<t.length&&e&&(e=e[t[r]])}return!1},t.model.setChangedPath=function(e,r,n){var o=function(o){r.unshift(o),t.model.setSimple(e,r,n),r.shift()};t.model.isChangedPath(e.changeMap,r)||(++e.changes,o("changeMap")),t.model.isChangedPath(e.deltaMap,r)||(++e.deltas,o("deltaMap"))},t.model.fetchChangeChildren=function(e,r,n,o,a){t.each(o,function(o,i){n[r]=i,t.model.applyChangeStrategy(e,i,r,n,o,a),n.length=r})},t.model.isSameValue=function(e,t){return"number"!=typeof e||"number"!=typeof t?e===t:e===t||e!==e&&t!==t||Math.abs((e-t)/t)<1e-12},t.model.applyChangeStrategy=function(e,r,n,o,a,i){var s=e[r],l=t.typeCode(a),u=t.typeCode(s),c=t.NO_VALUE;"primitive"===l?t.model.isSameValue(s,a)||(c=a,++i.unchanged):(u!==l||"array"===l&&a.length!==s.length)&&(c=t.freshContainer(a)),c!==t.NO_VALUE&&(e[r]=c,i.changeMap&&t.model.setChangedPath(i,o,i.inverse?"DELETE":"ADD")),"primitive"!==l&&t.model.fetchChangeChildren(e[r],n+1,o,a,i)},t.model.stepTargetAccess=function(e,r,n,o,a,i){for(var s=o;s<a;++s)if(e){var l=e[n[s]];e=t.model.traverseWithStrategy(e,n,s,i["ADD"===r?"resolverSetConfig":"resolverGetConfig"],n.length-s-1),l!==e&&i.changeMap&&t.model.setChangedPath(i,n.slice(0,s+1),"ADD")}return{root:e,last:n[a]}},t.model.defaultAccessorConfig=function(e){return e=e||{},e.resolverSetConfig=e.resolverSetConfig||t.model.escapedSetConfig,e.resolverGetConfig=e.resolverGetConfig||t.model.escapedGetConfig,e},t.model.applyHolderChangeRequest=function(e,r,n){n=t.model.defaultAccessorConfig(n),n.deltaMap=n.changeMap?{}:null,n.deltas=0;var o,a=r.segs.length,i=0===a;if(i?o={root:e,last:"model"}:(e.model||(e.model={},t.model.setChangedPath(n,[],n.inverse?"DELETE":"ADD")),o=t.model.stepTargetAccess(e.model,r.type,r.segs,0,a-1,n)),"ADD"===r.type){var s=r.value,l=t.makeArray(r.segs);t.model.applyChangeStrategy(o.root,o.last,a-1,l,s,n,i)}else"DELETE"===r.type?o.root&&void 0!==o.root[o.last]&&(delete o.root[o.last],n.changeMap&&t.model.setChangedPath(n,r.segs,"DELETE")):t.fail("Unrecognised change type of "+r.type);return n.deltas?n.deltaMap:null},t.model.diff=function(e,r,n){n=n||{changes:0,unchanged:0,changeMap:{}};var o,a=t.typeCode(e),i=t.typeCode(r);if("primitive"===a&&"primitive"===i)o=t.model.isSameValue(e,r);else if("primitive"===a^"primitive"===i)o=!1;else{var s={model:t.copy(e)};t.model.applyHolderChangeRequest(s,{value:r,segs:[],type:"ADD"},n);var l={model:t.copy(r)};n.inverse=!0,t.model.applyHolderChangeRequest(l,{value:e,segs:[],type:"ADD"},n),o=0===n.changes}return!1===o&&0===n.changes?(n.changes=1,n.changeMap=void 0===r?"DELETE":"ADD"):!0===o&&0===n.unchanged&&(n.unchanged=1),o},t.outputMatches=function(e,r,n){t.each(n,function(t,n){e.push(r.concat(n))})},t.matchChanges=function(e,r,n,o){for(var a=n.model,i=o.model,s=e,l=["model"],u=!1,c=[],d=0;d<r.length;++d){var f=r[d];"*"===f?d===r.length-1?u=!0:t.fail("Wildcard specification in modelChanged listener is only supported for the final path segment: "+r.join(".")):(l.push(f),s=t.isPrimitive(s)?s:s[f],a=a?a[f]:void 0,i=i?i[f]:void 0)}return s&&(u?"DELETE"===s?t.outputMatches(c,l,i):"ADD"===s?t.outputMatches(c,l,a):t.outputMatches(c,l,s):c.push(l)),c},t.storeExternalChange=function(e,t,r,n,o){var a=t.composeSegments.apply(null,r),i=[t.holder.id,n.listenerId,n.wildcard?a:""],s=i.join("|");e.externalChanges[s]={listener:n.listener,namespace:n.namespace,priority:n.priority,args:o}},t.notifyModelChanges=function(e,r,n,o,a,i,s,l){if(e)for(var u=i&&t.getModelTransactionRec(l,i.id),c=0;c<e.length;++c)for(var d=e[c],f=d.segsArray.length>1,p=0;p<d.segsArray.length;++p)for(var m=t.matchChanges(r,d.segsArray[p],n,o),g=0;g<m.length;++g){if(s.destroyed)return;var h=m[g];d.listener=t.event.resolveListener(d.listener);var v=[f?n.model:t.model.getSimple(n,h),f?o.model:t.model.getSimple(o,h),f?[]:h.slice(1),a,i,s];if(!d.isRelay){var y=t.model.diff(v[0],v[1]);if(y)continue;var x=t.isExcludedChangeSource(i,d);if(x)continue}u&&!d.isRelay&&d.transactional?t.storeExternalChange(u,s,h,d,v):d.listener.apply(null,v)}},t.bindELMethods=function(e){e.parseEL=function(r){return t.model.pathToSegments(r,e.options.resolverSetConfig)},e.composeSegments=function(){return e.options.resolverSetConfig.parser.compose.apply(null,arguments)}},t.initModelEvent=function(e,r,n,o){t.notifyModelChanges(o,"ADD",n.oldHolder,t.emptyHolder,null,n,r,e)},t.emptyHolder=t.freezeRecursive({model:void 0}),t.preFireChangeRequest=function(e,t){t.type||(t.type="ADD"),t.segs=t.segs||e.parseEL(t.path)},t.bindRequestChange=function(e){e.change=function(t,r,n,o){var a={path:t,value:r,type:n,source:o};e.fireChangeRequest(a)}},t.isObjectSimple=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t.mergeChangeSources=function(e,r){t.isObjectSimple(r)?t.extend(e,r):t.each(t.makeArray(r),function(t){e[t]=!0})},t.ChangeApplier=function(){},t.makeHolderChangeApplier=function(r,n){n=t.model.defaultAccessorConfig(n);var o=t.allocateGuid(),a=new t.ChangeApplier,i=t.isComponent(r)?"ChangeApplier for component "+t.dumpThat(r):"ChangeApplier with id "+o;return e.extend(a,{applierId:o,holder:r,listeners:t.makeEventFirer({name:"Internal change listeners for "+i}),transListeners:t.makeEventFirer({name:"External change listeners for "+i}),options:n,modelChanged:{},preCommit:t.makeEventFirer({name:"preCommit event for "+i}),postCommit:t.makeEventFirer({name:"postCommit event for "+i})}),a.destroy=function(){a.preCommit.destroy(),a.postCommit.destroy(),a.destroyed=!0},a.modelChanged.addListener=function(e,r,n,o){return e="string"==typeof e?{path:e}:t.copy(e),e.listenerId=e.listenerId||t.allocateGuid(),e.namespace=n,e.softNamespace=o,"string"==typeof r&&(r={globalName:r}),e.listener=r,!1!==e.transactional&&(e.transactional=!0),e.segsArray||(void 0!==e.path&&(e.segs=e.segs||a.parseEL(e.path)),e.segsArray||(e.segsArray=[e.segs])),e.isRelay||(t.parseSourceExclusionSpec(e,e),e.wildcard=t.accumulate(t.transform(e.segsArray,function(e){return t.contains(e,"*")}),t.add,0),e.wildcard&&e.segsArray.length>1&&t.fail("Error in model listener specification ",e," - you may not supply a wildcard pattern as one of a set of multiple paths to be matched")),a[e.transactional?"transListeners":"listeners"].addListener(e),e},a.modelChanged.removeListener=function(e){a.listeners.removeListener(e),a.transListeners.removeListener(e)},a.fireChangeRequest=function(e){var t=a.initiate("local",e.source);t.fireChangeRequest(e),t.commit()},a.initiate=function(e,o,i){e="init"===o?null:e||"local";var s="relay"===e,l={instanceId:t.allocateGuid(),id:i||t.allocateGuid(),changeRecord:{resolverSetConfig:n.resolverSetConfig,resolverGetConfig:n.resolverGetConfig},reset:function(){l.oldHolder=r,l.newHolder={model:t.copy(r.model)},l.changeRecord.changes=0,l.changeRecord.unchanged=0,l.changeRecord.changeMap={}},commit:function(e){if(a.preCommit.fire(l,a,e),l.changeRecord.changes>0){var n={model:r.model};r.model=l.newHolder.model,t.notifyModelChanges(a.transListeners.sortedListeners,l.changeRecord.changeMap,r,n,null,l,a,r)}s||a.postCommit.fire(l,a,e)},fireChangeRequest:function(e){t.preFireChangeRequest(a,e),e.transactionId=l.id;var n=t.model.applyHolderChangeRequest(l.newHolder,e,l.changeRecord);t.notifyModelChanges(a.listeners.sortedListeners,n,l.newHolder,r,e,l,a,r)},hasChangeSource:function(e){return l.fullSources[e]}},u=t.getModelTransactionRec(r,l.id);return u&&(t.mergeChangeSources(u.sources,o),l.sources=u.sources,l.fullSources=Object.create(u.sources),l.fullSources[e]=!0),l.reset(),t.bindRequestChange(l),l},t.bindRequestChange(a),t.bindELMethods(a),a},t.modelPairToChanges=function(e,r,n){n=n||"";var o={changes:0,unchanged:0,changeMap:{}};t.model.diff(r,e,o);var a=[];return t.modelPairToChangesImpl(e,t.pathUtil.parseEL(n),o.changeMap,[],a),a},t.modelPairToChangesImpl=function(e,r,n,o,a){"ADD"===n?a.push({path:r,value:e,type:"ADD"}):"DELETE"===n?a.push({path:r,value:null,type:"DELETE"}):t.isPlainObject(n,!0)&&t.each(n,function(n,i){var s=o.concat([i]);"ADD"===n?a.push({path:r.concat(s),value:t.get(e,s),type:"ADD"}):"DELETE"===n?a.push({path:r.concat(s),value:null,type:"DELETE"}):t.isPlainObject(n,!0)&&t.modelPairToChangesImpl(e,r,n,s,a)})}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.remoteModelComponent",{gradeNames:["fluid.modelComponent"],events:{afterFetch:null,onFetch:null,onFetchError:null,afterWrite:null,onWrite:null,onWriteError:null},members:{pendingRequests:{write:null,fetch:null}},model:{local:{},remote:{},requestInFlight:!1},modelListeners:{requestInFlight:{listener:"fluid.remoteModelComponent.launchPendingRequest",args:["{that}"]}},listeners:{"afterFetch.updateModel":{listener:"fluid.remoteModelComponent.updateModelFromFetch",args:["{that}","{arguments}.0"],priority:"before:unblock"},"afterFetch.unblock":{listener:"fluid.remoteModelComponent.unblockFetchReq",args:["{that}"]},"onFetchError.unblock":{listener:"fluid.remoteModelComponent.unblockFetchReq",args:["{that}"]},"afterWrite.unblock":{changePath:"requestInFlight",value:!1},"onWriteError.unblock":{changePath:"requestInFlight",value:!1}},invokers:{fetch:{funcName:"fluid.remoteModelComponent.fetch",args:["{that}"]},fetchImpl:"fluid.notImplemented",write:{funcName:"fluid.remoteModelComponent.write",args:["{that}"]},writeImpl:"fluid.notImplemented"}}),t.remoteModelComponent.launchPendingRequest=function(e){e.model.requestInFlight||(e.pendingRequests.fetch?e.fetch():e.pendingRequests.write&&e.write())},t.remoteModelComponent.updateModelFromFetch=function(e,r){var n=t.modelPairToChanges(r,e.model.remote,"local"),o=t.modelPairToChanges(e.model.local,e.model.remote,"local"),a=n.concat(o),i=e.applier.initiate();i.fireChangeRequest({path:"local",type:"DELETE"}),i.change("local",e.model.remote),i.fireChangeRequest({path:"remote",type:"DELETE"}),i.change("remote",r),t.fireChanges(i,a),i.commit()},t.remoteModelComponent.makeSequenceStrategy=function(e){return{invokeNext:function(r){var n=r.sources[r.index];return n.listener=t.event.resolveListener(n.listener),n.listener.apply(null,[e,r.options])},resolveResult:function(){return e}}},t.remoteModelComponent.makeSequence=function(e,r,n){var o=t.promise.makeSequencer(e,n,t.remoteModelComponent.makeSequenceStrategy(r));return t.promise.resumeSequence(o),o},t.remoteModelComponent.fireEventSequence=function(e,r,n){var o=t.makeArray(e.sortedListeners);return t.remoteModelComponent.makeSequence(o,r,n).promise},t.remoteModelComponent.fetch=function(e){var r,n=t.promise();if(e.pendingRequests.fetch?(r=e.pendingRequests.fetch,t.promise.follow(r,n)):(r=n,e.pendingRequests.fetch=n),!e.model.requestInFlight){t.remoteModelComponent.fireEventSequence(e.events.onFetch).then(function(){e.applier.change("requestInFlight",!0),e.fetchImpl().then(function(n){var o=t.remoteModelComponent.fireEventSequence(e.events.afterFetch,n);t.promise.follow(o,r)},e.events.onFetchError.fire)},e.events.onFetchError.fire)}return n},t.remoteModelComponent.unblockFetchReq=function(e){e.pendingRequests.fetch=null,e.applier.change("requestInFlight",!1)},t.remoteModelComponent.write=function(e){var r,n=t.promise();if(e.pendingRequests.write?(r=e.pendingRequests.write,t.promise.follow(e.pendingRequests.write,n)):r=n,e.model.requestInFlight)e.pendingRequests.write=r;else{t.remoteModelComponent.fireEventSequence(e.events.onWrite).then(function(){if(e.applier.change("requestInFlight",!0),e.pendingRequests.write=null,t.model.diff(e.model.local,e.model.remote)){var n=t.remoteModelComponent.fireEventSequence(e.events.afterWrite,e.model.local);t.promise.follow(n,r)}else{e.writeImpl(e.model.local).then(function(n){var o=t.remoteModelComponent.fireEventSequence(e.events.afterWrite,n);t.promise.follow(o,r)},e.events.onWriteError.fire)}},e.events.onWriteError.fire)}return n}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{},fluid=fluid||fluid_3_0_0;!function(e,t){"use strict";t.registerNamespace("fluid.model.transform"),t.defaults("fluid.transformFunction",{gradeNames:"fluid.function"}),t.defaults("fluid.standardInputTransformFunction",{gradeNames:"fluid.transformFunction"}),t.defaults("fluid.standardOutputTransformFunction",{gradeNames:"fluid.transformFunction"}),t.defaults("fluid.multiInputTransformFunction",{gradeNames:"fluid.transformFunction"}),t.defaults("fluid.standardTransformFunction",{gradeNames:["fluid.standardInputTransformFunction","fluid.standardOutputTransformFunction"]}),t.defaults("fluid.lens",{gradeNames:"fluid.transformFunction",invertConfiguration:null}),t.model.transform.pathToRule=function(e){return{transform:{type:"fluid.transforms.value",inputPath:e}}},t.model.transform.literalValueToRule=function(e){return{transform:{type:"fluid.transforms.literalValue",input:e}}},t.model.composePaths=function(e,t){return e=0===e?"0":e||"",t=0===t?"0":t||"",e?t?e+"."+t:e:t},t.model.transform.accumulateInputPath=function(e,r,n){void 0!==e&&n.push(t.model.composePaths(r.inputPrefix,e))},t.model.transform.accumulateStandardInputPath=function(e,r,n,o){t.model.transform.getValue(void 0,r[e],n),t.model.transform.accumulateInputPath(r[e+"Path"],n,o)},t.model.transform.accumulateMultiInputPaths=function(e,r,n,o){t.each(e,function(e,a){t.model.transform.accumulateStandardInputPath(a,r,n,o)})},t.model.transform.getValue=function(e,r,n){var o;return void 0!==e&&(o=t.get(n.source,t.model.composePaths(n.inputPrefix,e),n.resolverGetConfig)),void 0===o&&(o=t.isPrimitive(r)?r:"literalValue"in r?r.literalValue:void 0===r.transform?r:n.expand(r)),o},t.model.transform.NONDEFAULT_OUTPUT_PATH_RETURN={},t.model.transform.setValue=function(e,r,n){var o=t.copy(r),a=t.model.composePaths(n.outputPrefix,e);return void 0!==o&&n.applier.change(a,o),e?t.model.transform.NONDEFAULT_OUTPUT_PATH_RETURN:o},t.model.transform.resolveParam=function(e,r,n,o){var a=t.model.transform.getValue(e[n+"Path"],e[n],r);return void 0!==a?a:o},t.model.transform.matchValue=function(e,r,n){var o={changes:0,unchanged:0,changeMap:{}};return t.model.diff(e,r,o),0===o.unchanged?0:n?0xffffff000000-16777216*o.changes+o.unchanged:o.changes?0:0xffffff000000+o.unchanged},t.model.transform.invertPaths=function(e,r){var n=t.model.composePaths(r.outputPrefix,e.outputPath);return e.outputPath=t.model.composePaths(r.inputPrefix,e.inputPath),e.inputPath=n,e},t.model.transform.prefixApplier=function(e,t){e.inputPrefix&&t.inputPrefixOp.push(e.inputPrefix),e.outputPrefix&&t.outputPrefixOp.push(e.outputPrefix),t.expand(e.input),e.inputPrefix&&t.inputPrefixOp.pop(),e.outputPrefix&&t.outputPrefixOp.pop()},t.defaults("fluid.model.transform.prefixApplier",{gradeNames:["fluid.transformFunction"]}),t.model.makePathStack=function(e,r){var n=e[r+"Stack"]=[];return e[r]="",{push:function(o){var a=t.model.composePaths(e[r],o);n.push(e[r]),e[r]=a},pop:function(){e[r]=n.pop()}}},t.model.transform.doTransform=function(e,r,n){var o=n.defaults,a=t.getGlobalValue(n.typeName);"function"!=typeof a&&t.fail("Transformation record specifies transformation function with name "+e.type+" which is not a function - ",a),t.hasGrade(o,"fluid.transformFunction")||(o=t.defaults("fluid.standardTransformFunction"));var i=[e,r];if(t.hasGrade(o,"fluid.multiInputTransformFunction")){var s={};t.each(o.inputVariables,function(n,o){s[o]=function(){var a=t.model.transform.getValue(e[o+"Path"],e[o],r);return a=void 0===a&&null!==n?n:a}}),i.unshift(s)}if(t.hasGrade(o,"fluid.standardInputTransformFunction")){"input"in e||"inputPath"in e||t.fail('Error in transform specification. Either "input" or "inputPath" must be specified for a standardInputTransformFunction: received ',e);var l=t.model.transform.getValue(e.inputPath,e.input,r);if(i.unshift(l),void 0===l)return}var u=a.apply(null,i);if(t.hasGrade(o,"fluid.standardOutputTransformFunction")){void 0!==(void 0!==e.outputPath?e.outputPath:n.doOutput?"":void 0)&&void 0!==u&&(t.model.transform.setValue(e.outputPath,u,r),u=void 0)}return u};var r=[];t.registerNamespace("fluid.pathUtil"),
t.pathUtil.getPathSegment=function(e,n){return t.pathUtil.getPathSegmentImpl(r,e,n),r[0]},t.pathUtil.getHeadPath=function(e){return t.pathUtil.getPathSegment(e,0)},t.pathUtil.getFromHeadPath=function(e){var r=t.pathUtil.getPathSegmentImpl(null,e,0);return r===e.length?"":e.substring(r+1)},t.pathUtil.matchPath=function(e,r,n){for(var o=[];;){if(""===r^""===e&&n)return null;if(!e||!r)break;var a=t.pathUtil.getHeadPath(e),i=t.pathUtil.getHeadPath(r);if("*"!==a&&a!==i)return null;o.push(i),e=t.pathUtil.getFromHeadPath(e),r=t.pathUtil.getFromHeadPath(r)}return o},t.model.transform.expandWildcards=function(e,r){t.each(r,function(r,n){var o=e.queuedTransforms;e.pathOp.push(t.pathUtil.escapeSegment(n.toString()));for(var a=0;a<o.length;++a)if(t.pathUtil.matchPath(o[a].matchPath,e.path,!0)){var i=t.copy(o[a].transformSpec);(void 0===i.inputPath||t.model.transform.hasWildcard(i.inputPath))&&(i.inputPath=""),e.inputPrefixOp.push(e.path),e.outputPrefixOp.push(e.path);var s=t.model.transform.lookupType(i.type),l=t.model.transform.doTransform(i,e,s);void 0!==l&&t.model.transform.setValue(null,l,e),e.outputPrefixOp.pop(),e.inputPrefixOp.pop()}t.isPrimitive(r)||t.model.transform.expandWildcards(e,r),e.pathOp.pop()})},t.model.transform.hasWildcard=function(e){return"string"==typeof e&&-1!==e.indexOf("*")},t.model.transform.maybePushWildcard=function(e,r){var n,o=t.model.transform.hasWildcard;return o(e.inputPath)?n=t.model.composePaths(r.inputPrefix,e.inputPath):(o(r.outputPrefix)||o(e.outputPath))&&(n=t.model.composePaths(r.outputPrefix,e.outputPath)),!!n&&(r.queuedTransforms.push({transformSpec:e,outputPrefix:r.outputPrefix,inputPrefix:r.inputPrefix,matchPath:n}),!0)},t.model.sortByKeyLength=function(e){return t.keys(e).sort(t.compareStringLength(!0))},t.model.transform.handleTransformStrategy=function(e,r,n){return t.model.transform.maybePushWildcard(e,r)?void 0:t.model.transform.doTransform(e,r,n)},t.model.transform.handleInvertStrategy=function(e,r,n){e=t.copy(e),t.hasGrade(n.defaults,"fluid.standardTransformFunction")&&(e=t.model.transform.invertPaths(e,r));var o=n.defaults&&n.defaults.invertConfiguration;if(o){var a=t.invokeGlobalFunction(o,[e,r]);r.inverted.push(a)}else r.inverted.push(t.model.transform.uninvertibleTransform)},t.model.transform.handleCollectStrategy=function(e,r,n){var o=n.defaults,a=t.hasGrade(o,"fluid.standardInputTransformFunction"),i=t.hasGrade(o,"fluid.multiInputTransformFunction");if(a&&t.model.transform.accumulateStandardInputPath("input",e,r,r.inputPaths),i&&t.model.transform.accumulateMultiInputPaths(o.inputVariables,e,r,r.inputPaths),!i&&!a){var s=o.collectInputPaths;if(s){var l=t.makeArray(t.invokeGlobalFunction(s,[e,r]));Array.prototype.push.apply(r.inputPaths,l)}}},t.model.transform.lookupType=function(e,r){return e||t.fail("Transformation record is missing a type name: ",r),-1===e.indexOf(".")&&(e="fluid.transforms."+e),{defaults:t.defaults(e),typeName:e}},t.model.transform.processRule=function(e,r){"string"==typeof e?e=t.model.transform.pathToRule(e):void 0!==e.literalValue&&(e=t.model.transform.literalValueToRule(e.literalValue));var n;if(e.transform){var o,a;if(t.isArrayable(e.transform)){var i=e.transform;n=void 0;for(var s=0;s<i.length;++s)o=i[s],a=t.model.transform.lookupType(o.type),r.transformHandler(o,r,a)}else o=e.transform,a=t.model.transform.lookupType(o.type),n=r.transformHandler(o,r,a)}return t.isArrayable(e)&&(r.collectedFlatSchemaOpts=r.collectedFlatSchemaOpts||{},r.collectedFlatSchemaOpts[r.outputPrefix]="array"),t.each(e,function(e,n){if("transform"!==n){r.outputPrefixOp.push(n);var o=r.expand(e,r);void 0!==o&&(t.model.transform.setValue(null,o,r),o=void 0),r.outputPrefixOp.pop()}}),n},t.model.transform.makeStrategy=function(e,r,n){n=n||t.model.transform.processRule,e.expand=function(t){return n(t,e)},e.outputPrefixOp=t.model.makePathStack(e,"outputPrefix"),e.inputPrefixOp=t.model.makePathStack(e,"inputPrefix"),e.transformHandler=r},t.model.transform.uninvertibleTransform=Object.freeze({}),t.model.transform.invertConfiguration=function(e){var r={inverted:[]};return t.model.transform.makeStrategy(r,t.model.transform.handleInvertStrategy),r.expand(e),-1===r.inverted.indexOf(t.model.transform.uninvertibleTransform)?{transform:r.inverted}:t.model.transform.uninvertibleTransform},t.model.transform.collectInputPaths=function(e){var r={inputPaths:[]};return t.model.transform.makeStrategy(r,t.model.transform.handleCollectStrategy),r.expand(e),r.inputPaths},t.model.transform.flatSchemaStrategy=function(e,r){var n=t.model.sortByKeyLength(e);return function(o,a,i,s){for(var l=r.parser.compose.apply(null,s.slice(0,i)),u=0;u<n.length;++u){var c=n[u];if(null!==t.pathUtil.matchPath(c,l,!0))return e[c]}}},t.model.transform.defaultSchemaValue=function(e){return"array"===(t.isPrimitive(e)?e:e.type)?[]:{}},t.model.transform.isomorphicSchemaStrategy=function(e,r){return function(n,o,a,i){var s=t.get(e,i.slice(0,a),r);return t.isArrayable(s)?"array":"object"}},t.model.transform.decodeStrategy=function(e,r,n){return r.isomorphic?t.model.transform.isomorphicSchemaStrategy(e,n):r.flatSchema?t.model.transform.flatSchemaStrategy(r.flatSchema,n):void 0},t.model.transform.schemaToCreatorStrategy=function(e){return function(r,n,o,a){if(void 0===r[n]){var i=e(r,n,o,a);return r[n]=t.model.transform.defaultSchemaValue(i),r[n]}}},t.model.transform.sequence=function(e,r,n){for(var o=0;o<r.length;++o)e=t.model.transform(e,r[o],n);return e},t.model.compareByPathLength=function(e,t){var r=e.path.length-t.path.length;return 0===r?e.sequence-t.sequence:r},t.model.fireSortedChanges=function(e,r){e.sort(t.model.compareByPathLength),t.fireChanges(r,e)},t.model.transformWithRules=function(r,n,o){o=o||{};var a=t.model.escapedGetConfig,i=t.model.escapedSetConfig,s=t.model.transform.decodeStrategy(r,o,a),l={source:r,target:{model:s?t.model.transform.defaultSchemaValue(s(null,"",0,[""])):{}},resolverGetConfig:a,resolverSetConfig:i,collectedFlatSchemaOpts:void 0,queuedChanges:[],queuedTransforms:[]};t.model.transform.makeStrategy(l,t.model.transform.handleTransformStrategy),l.applier={fireChangeRequest:function(e){e.sequence=l.queuedChanges.length,l.queuedChanges.push(e)}},t.bindRequestChange(l.applier),l.expand(n);var u=t.copy(i);return void 0!==l.collectedFlatSchemaOpts&&(e.extend(l.collectedFlatSchemaOpts,o.flatSchema),s=t.model.transform.flatSchemaStrategy(l.collectedFlatSchemaOpts,a)),u.strategies=[t.model.defaultFetchStrategy,s?t.model.transform.schemaToCreatorStrategy(s):t.model.defaultCreatorStrategy],l.finalApplier=o.finalApplier||t.makeHolderChangeApplier(l.target,{resolverSetConfig:u}),l.queuedTransforms.length>0&&(l.typeStack=[],l.pathOp=t.model.makePathStack(l,"path"),t.model.transform.expandWildcards(l,r)),t.model.fireSortedChanges(l.queuedChanges,l.finalApplier),l.target.model},e.extend(t.model.transformWithRules,t.model.transform),t.model.transform=t.model.transformWithRules,t.transformOne=function(e){return{transformOptions:{transformer:"fluid.model.transformWithRules",config:e}}},t.transformMany=function(e){return{transformOptions:{transformer:"fluid.model.transform.sequence",config:e}}}}(jQuery,fluid_3_0_0);var fluid_2_0_0=fluid_2_0_0||{},fluid=fluid||fluid_2_0_0;!function(e,t){"use strict";t.registerNamespace("fluid.model.transform"),t.registerNamespace("fluid.transforms"),t.defaults("fluid.transforms.value",{gradeNames:"fluid.standardTransformFunction",invertConfiguration:"fluid.identity"}),t.transforms.value=t.identity,t.transforms.identity=t.transforms.value,t.defaults("fluid.transforms.identity",{gradeNames:"fluid.transforms.value"}),t.transforms.invertToIdentity=function(e){return e.type="fluid.transforms.identity",e},t.defaults("fluid.transforms.literalValue",{gradeNames:"fluid.standardOutputTransformFunction"}),t.transforms.literalValue=function(e){return e.input},t.defaults("fluid.transforms.stringToNumber",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.stringToNumber.invert"}),t.transforms.stringToNumber=function(e){var t=Number(e);return isNaN(t)?void 0:t},t.transforms.stringToNumber.invert=function(e){return e.type="fluid.transforms.numberToString",e},t.defaults("fluid.transforms.numberToString",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.numberToString.invert"}),t.transforms.numberToString=function(e,r){if("number"==typeof e){if("number"!=typeof r.scale||isNaN(r.scale))return e.toString();return t.roundToDecimal(e,r.scale,r.method).toString()}},t.transforms.numberToString.invert=function(e){return e.type="fluid.transforms.stringToNumber",e},t.defaults("fluid.transforms.count",{gradeNames:"fluid.standardTransformFunction"}),t.transforms.count=function(e){return t.makeArray(e).length},t.defaults("fluid.transforms.round",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.invertToIdentity"}),t.transforms.round=function(e,r){return t.roundToDecimal(e,r.scale,r.method)},t.defaults("fluid.transforms.delete",{gradeNames:"fluid.transformFunction"}),t.transforms.delete=function(e,r){var n=t.model.composePaths(r.outputPrefix,e.outputPath);r.applier.change(n,null,"DELETE")},t.defaults("fluid.transforms.firstValue",{gradeNames:"fluid.standardOutputTransformFunction"}),t.transforms.firstValue=function(e,r){e.values&&e.values.length||t.fail('firstValue transformer requires an array of values at path named "values", supplied',e);for(var n=0;n<e.values.length;n++){var o=e.values[n],a=r.expand(o);if(void 0!==a)return a}},t.defaults("fluid.transforms.linearScale",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.linearScale.invert",inputVariables:{factor:1,offset:0}}),t.transforms.linearScale=function(e,t){var r=t.factor(),n=t.offset();if("number"==typeof e&&"number"==typeof r&&"number"==typeof n)return e*r+n},t.transforms.linearScale.invert=function(e){return delete e.factorPath,delete e.offsetPath,void 0!==e.factor&&(e.factor=0===e.factor?0:1/e.factor),void 0!==e.offset&&(e.offset=-e.offset*(void 0!==e.factor?e.factor:1)),e},t.defaults("fluid.transforms.binaryOp",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction"],inputVariables:{left:null,right:null}}),t.transforms.binaryLookup={"===":function(e,r){return t.model.isSameValue(e,r)},"!==":function(e,r){return!t.model.isSameValue(e,r)},"<=":function(e,t){return e<=t},"<":function(e,t){return e<t},">=":function(e,t){return e>=t},">":function(e,t){return e>t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t}},t.transforms.binaryOp=function(e,r,n){var o=e.left(),a=e.right(),i=t.model.transform.getValue(void 0,r.operator,n),s=t.transforms.binaryLookup[i];return void 0===s||void 0===o||void 0===a?void 0:s(o,a)},t.defaults("fluid.transforms.condition",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction"],inputVariables:{true:null,false:null,condition:null}}),t.transforms.condition=function(e){var t=e.condition();if(null!==t)return e[t?"true":"false"]()},t.defaults("fluid.transforms.valueMapper",{gradeNames:["fluid.transformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.valueMapper.invert",collectInputPaths:"fluid.transforms.valueMapper.collect"}),t.model.transform.compareMatches=function(e,t){var r=t.matchValue-e.matchValue;return 0===r?e.index-t.index:r},t.transforms.valueMapper=function(e,r){e.match||t.fail('valueMapper requires an array or hash of matches at path named "match", supplied ',e);var n=t.model.transform.getValue(e.defaultInputPath,e.defaultInput,r),o=t.isArrayable(e.match)?t.transforms.valueMapper.longFormMatch(n,e,r):e.match[n];if(void 0===o&&(o=e.noMatch),void 0!==o){var a=void 0===o.outputPath?e.defaultOutputPath:o.outputPath;r.outputPrefixOp.push(a);var i;return t.isPrimitive(o)?i=o:o.outputUndefinedValue?i=void 0:(i=t.model.transform.resolveParam(o,r,"outputValue",void 0),i=void 0===i?e.defaultOutputValue:i),"string"==typeof a&&void 0!==i&&(t.model.transform.setValue(void 0,i,r,e.merge),i=void 0),r.outputPrefixOp.pop(),i}},t.transforms.valueMapper.longFormMatch=function(e,r,n){var o=r.match;0===o.length&&t.fail("valueMapper supplied empty list of matches: ",r);for(var a=[],i=0;i<o.length;++i){var s=o[i],l=s.inputPath?t.model.transform.getValue(s.inputPath,void 0,n):e,u=t.model.transform.matchValue(s.inputValue,l,s.partialMatches);a[i]={index:i,matchValue:u}}return a.sort(t.model.transform.compareMatches),a[0].matchValue<=0?void 0:o[a[0].index]},t.transforms.valueMapper.invert=function(e,r){var n=[],o={type:"fluid.transforms.valueMapper",match:n},a=t.isArrayable(e.match);o.defaultInputPath=t.model.composePaths(r.outputPrefix,e.defaultOutputPath),o.defaultOutputPath=t.model.composePaths(r.inputPrefix,e.defaultInputPath);var i=t.firstDefined;return t.each(e.match,function(o,s){if(!0!==o.outputUndefinedValue){var l={},u=i(a?o.inputValue:s,e.defaultInputValue);void 0===u&&t.fail("Failure inverting configuration for valueMapper - inputValue could not be resolved for record "+s+": ",e),l.outputValue=u,l.inputValue=!a&&t.isPrimitive(o)?o:i(o.outputValue,e.defaultOutputValue),o.outputPath&&(l.inputPath=t.model.composePaths(r.outputPrefix,i(o.outputPath,e.outputPath))),o.inputPath&&(l.outputPath=t.model.composePaths(r.inputPrefix,i(o.inputPath,e.inputPath))),n.push(l)}}),o},t.transforms.valueMapper.collect=function(e,r){var n=[];return t.model.transform.accumulateStandardInputPath("defaultInput",e,r,n),t.each(e.match,function(e){t.model.transform.accumulateInputPath(e.inputPath,r,n)}),n},t.defaults("fluid.transforms.arrayToSetMembership",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.arrayToSetMembership.invert"}),t.transforms.arrayToSetMembership=function(e,r,n){var o={},a=r.options;return e&&t.isArrayable(e)||t.fail("arrayToSetMembership didn't find array at inputPath nor passed as value.",r),a||t.fail("arrayToSetMembership requires an options block set"),void 0===r.presentValue&&(r.presentValue=!0),void 0===r.missingValue&&(r.missingValue=!1),t.each(a,function(a,i){var s=-1!==e.indexOf(i)?r.presentValue:r.missingValue;t.set(o,a,s,n.resolverSetConfig)}),o},t.transforms.arrayToSetMembership.invertWithType=function(e,r,n){e.type=n;var o={};return t.each(e.options,function(e,t){o[e]=t}),e.options=o,e},t.transforms.arrayToSetMembership.invert=function(e,r){return t.transforms.arrayToSetMembership.invertWithType(e,r,"fluid.transforms.setMembershipToArray")},t.defaults("fluid.transforms.setMembershipToArray",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.setMembershipToArray.invert"}),t.transforms.setMembershipToArray=function(e,r,n){var o=r.options;o||t.fail("setMembershipToArray requires an options block specified"),void 0===r.presentValue&&(r.presentValue=!0),void 0===r.missingValue&&(r.missingValue=!1);var a=[];return t.each(o,function(o,i){t.get(e,i,n.resolverGetConfig)===r.presentValue&&a.push(o)}),a},t.transforms.setMembershipToArray.invert=function(e,r){return t.transforms.arrayToSetMembership.invertWithType(e,r,"fluid.transforms.arrayToSetMembership")},t.model.transform.applyPaths=function(e,t,r){for(var n=0;n<r.length;++n)"push"===e?t.push(r[n]):t.pop()},t.model.transform.expandInnerValues=function(r,n,o,a){var i=o.inputPrefixOp,s=o.outputPrefixOp,l=t.model.transform.applyPaths;l("push",i,r),l("push",s,n);var u={};return t.each(a,function(r){var n=o.expand(r);t.isPrimitive(n)?u=n:e.extend(!0,u,n)}),l("pop",s,n),l("pop",i,r),u},t.defaults("fluid.transforms.indexArrayByKey",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.indexArrayByKey.invert"}),t.transforms.indexArrayByKey=function(e,r,n){void 0===r.key&&t.fail("indexArrayByKey requires a 'key' option.",r),t.isArrayable(e)||t.fail("indexArrayByKey didn't find array at inputPath.",r);var o={},a=r.key;return t.each(e,function(e,i){var s=e[a],l=typeof s;"string"!==l&&"boolean"!==l&&"number"!==l&&t.fail("indexArrayByKey encountered untransformable array due to missing or invalid key",e);var u=t.copy(e);delete u[a],r.innerValue&&(u=t.model.transform.expandInnerValues([n.inputPrefix,r.inputPath,i.toString()],[r.outputPath,s],n,r.innerValue)),o[s]=u}),o},t.transforms.indexArrayByKey.invert=function(e){if(e.type="fluid.transforms.deindexIntoArrayByKey",e.innerValue)for(var r=e.innerValue,n=0;n<r.length;++n){var o=t.model.transform.invertConfiguration(r[n]);if(o===t.model.transform.uninvertibleTransform)return o;r[n]=o}return e},t.defaults("fluid.transforms.deindexIntoArrayByKey",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.deindexIntoArrayByKey.invert"}),t.transforms.deindexIntoArrayByKey=function(r,n,o){void 0===n.key&&t.fail('deindexIntoArrayByKey requires a "key" option.',n);var a=[],i=n.key;return t.each(r,function(r,s){var l={};l[i]=s,n.innerValue&&(r=t.model.transform.expandInnerValues([n.inputPath,s],[n.outputPath,a.length.toString()],o,n.innerValue)),e.extend(!0,l,r),a.push(l)}),a},t.transforms.deindexIntoArrayByKey.invert=function(e){if(e.type="fluid.transforms.indexArrayByKey",e.innerValue)for(var r=e.innerValue,n=0;n<r.length;++n)r[n]=t.model.transform.invertConfiguration(r[n]);return e},t.defaults("fluid.transforms.limitRange",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.invertToIdentity"}),t.transforms.limitRange=function(e,t){var r=t.min;if(void 0!==r){r+=t.excludeMin||0,e<r&&(e=r)}var n=t.max;if(void 0!==n){n-=t.excludeMax||0,e>n&&(e=n)}return e},t.defaults("fluid.transforms.indexOf",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.indexOf.invert"}),t.transforms.indexOf=function(e,r){"number"==typeof r.notFound&&r.notFound>=0&&t.fail("A positive number is not allowed as 'notFound' value for indexOf");var n=t.transforms.parseIndexationOffset(r.offset,"indexOf"),o=t.makeArray(r.array),a=o.indexOf(e);return-1===a&&r.notFound?r.notFound:a+n},t.transforms.indexOf.invert=function(e,r){var n=t.transforms.invertArrayIndexation(e,r);return n.type="fluid.transforms.dereference",n},t.defaults("fluid.transforms.dereference",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.dereference.invert"}),t.transforms.dereference=function(e,r){if("number"==typeof e){var n=t.transforms.parseIndexationOffset(r.offset,"dereference");return t.makeArray(r.array)[e+n]}},t.transforms.dereference.invert=function(e,r){var n=t.transforms.invertArrayIndexation(e,r);return n.type="fluid.transforms.indexOf",n},t.transforms.parseIndexationOffset=function(e,r){var n=0;return void 0!==e&&(n=t.parseInteger(e),isNaN(n)&&t.fail(r+' requires the value of "offset" to be an integer or a string that can be converted to an integer. '+e+" is invalid.")),n},t.transforms.invertArrayIndexation=function(e){return isNaN(Number(e.offset))||(e.offset=-1*Number(e.offset)),e},t.defaults("fluid.transforms.stringTemplate",{gradeNames:"fluid.standardOutputTransformFunction"}),t.transforms.stringTemplate=function(e){return t.stringTemplate(e.template,e.terms)},t.defaults("fluid.transforms.free",{gradeNames:"fluid.transformFunction"}),t.transforms.free=function(e){var r=t.makeArray(e.args);return t.invokeGlobalFunction(e.func,r)},t.defaults("fluid.transforms.quantize",{gradeNames:"fluid.standardTransformFunction"}),t.transforms.quantize=function(e,r,n){r.ranges&&r.ranges.length||t.fail("fluid.transforms.quantize should have a key called ranges containing an array defining ranges to quantize");for(var o=0;o<r.ranges.length;o++){var a=r.ranges[o];if(e<=a.upperBound||void 0===a.upperBound&&e>=Number.NEGATIVE_INFINITY)return t.isPrimitive(a.output)?a.output:n.expand(a.output)}},t.defaults("fluid.transforms.inRange",{gradeNames:"fluid.standardTransformFunction"}),t.transforms.inRange=function(e,t){return(void 0===t.min||t.min<=e)&&(void 0===t.max||t.max>=e)},t.transforms.stringToBoolean=function(e){return!!e&&!("0"===e||"false"===e)},t.transforms.stringToBoolean.invert=function(e){return e.type="fluid.transforms.booleanToString",e},t.defaults("fluid.transforms.stringToBoolean",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.stringToBoolean.invert"}),t.transforms.booleanToString=function(e){return e?"true":"false"},t.transforms.booleanToString.invert=function(e){return e.type="fluid.transforms.stringToBoolean",e},t.defaults("fluid.transforms.booleanToString",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.booleanToString.invert"}),t.transforms.JSONstringToObject=function(e){try{return JSON.parse(e)}catch(e){return}},t.transforms.JSONstringToObject.invert=function(e){return e.type="fluid.transforms.objectToJSONString",e},t.defaults("fluid.transforms.JSONstringToObject",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.JSONstringToObject.invert"}),t.transforms.objectToJSONString=function(e,t){var r=t.space||0;return JSON.stringify(e,null,r)},t.transforms.objectToJSONString.invert=function(e){return e.type="fluid.transforms.JSONstringToObject",e},t.defaults("fluid.transforms.objectToJSONString",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.objectToJSONString.invert"}),t.transforms.stringToDate=function(e){var t=new Date(e);return isNaN(t.getTime())?void 0:t},t.transforms.stringToDate.invert=function(e){return e.type="fluid.transforms.dateToString",e},t.defaults("fluid.transforms.stringToDate",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.stringToDate.invert"}),t.transforms.dateToString=function(e){if(e instanceof Date){var t=e.toISOString();return t.substring(0,t.indexOf("T"))}},t.transforms.dateToString.invert=function(e){return e.type="fluid.transforms.stringToDate",e},t.defaults("fluid.transforms.dateToString",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.dateToString.invert"}),t.transforms.dateTimeToString=function(e){return e instanceof Date?e.toISOString():void 0},t.defaults("fluid.transforms.dateTimeToString",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.dateToString.invert"})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{},fluid=fluid||fluid_3_0_0;!function(e,t){"use strict";t.thatistBridge=function(t,r){var n=function(t){for(var n=t.split("."),o=r,a=0;a<n.length;++a)o=o[n[a]];var i=[this];2===arguments.length&&(i=i.concat(e.makeArray(arguments[1])));var s=o.apply(null,i);this.that=function(){return s};var l=typeof s;return!s||"string"===l||"number"===l||"boolean"===l||s&&void 0!==s.length?s:this};return e.fn[t]=n,n},t.thatistBridge("fluid",t),t.thatistBridge("fluid_3_0_0",fluid_3_0_0);var r=function(){return e.browser.msie?"tabIndex":"tabindex"},n=function(t){return!(t.length<=0)&&e(t[0]).is("a, input, button, select, area, textarea, object")},o=function(e){if(!(e.length<=0)){if(!t.tabindex.hasAttr(e))return n(e)?Number(0):void 0;var o=e.attr(r());return Number(o)}},a=function(t,n){return t.each(function(t,o){e(o).attr(r(),n)})};t.tabindex=function(t,r){return t=e(t),null!==r&&void 0!==r?a(t,r):o(t)},t.tabindex.remove=function(t){return t=e(t),t.each(function(t,n){e(n).removeAttr(r())})},t.tabindex.hasAttr=function(t){if(t=e(t),t.length<=0)return!1;var n=t.map(function(){var e=this.getAttributeNode(r());return!!e&&e.specified});return 1===n.length?n[0]:n},t.tabindex.has=function(r){return r=e(r),t.tabindex.hasAttr(r)||n(r)},t.a11y=e.a11y||{},t.a11y.orientation={HORIZONTAL:0,VERTICAL:1,BOTH:2};var i={next:e.ui.keyCode.DOWN,previous:e.ui.keyCode.UP},s={next:e.ui.keyCode.RIGHT,previous:e.ui.keyCode.LEFT},l=function(e){return e.jquery?e[0]:e},u=function(t){t.each(function(t,r){r=e(r),(!r.fluid("tabindex.has")||r.fluid("tabindex")<0)&&r.fluid("tabindex",0)})};t.tabbable=function(t){t=e(t),u(t)};var c="selectionContext",d=function(e){-32768!==e.activeItemIndex&&(e.options.onLeaveContainer?e.options.onLeaveContainer(e.selectables[e.activeItemIndex]):e.options.onUnselect&&e.options.onUnselect(e.selectables[e.activeItemIndex])),e.options.rememberSelectionState||(e.activeItemIndex=-32768)},f=function(e,t){t&&t(e)},p=function(e,t){t&&e&&t(e)},m=function(e,t){p(e,t.options.onUnselect)},g=function(e,t){m(t.selectedElement(),t),e=l(e);var r=t.selectables.index(e);-1!==r&&(t.activeItemIndex=r,f(e,t.options.onSelect))},h=function(t){return function(r){return e(r.target).fluid("tabindex",0),g(r.target,t),r.stopPropagation()}},v=function(t){return function(r){return e(r.target).fluid("tabindex",t.options.selectablesTabindex),m(r.target,t),r.stopPropagation()}},y=function(e){var r=e.selectables;e.activeItemIndex>=r.length&&(e.activeItemIndex=e.options.noWrap?r.length-1:0),e.activeItemIndex<0&&-32768!==e.activeItemIndex&&(e.activeItemIndex=e.options.noWrap?0:r.length-1),e.activeItemIndex>=0&&t.focus(r[e.activeItemIndex])},x=function(e){var r=e.selectedElement();r&&t.blur(r),m(e.selectedElement(),e),-32768===e.activeItemIndex&&(e.activeItemIndex=-1)},b=function(e){x(e),++e.activeItemIndex,y(e)},S=function(e){x(e),--e.activeItemIndex,y(e)},C=function(e,t){return function(r){r.which===t.next?(b(e),r.preventDefault()):r.which===t.previous&&(S(e),r.preventDefault())}},P=function(e){var r;return e===t.a11y.orientation.HORIZONTAL?r=s:e===t.a11y.orientation.VERTICAL&&(r=i),r},E=function(t){return function(r){r.which===e.ui.keyCode.TAB&&(d(t),r.shiftKey&&(t.focusIsLeavingContainer=!0))}},T=function(e){return function(r){var n=e.options.autoSelectFirstItem,o="function"==typeof n?n():n;return e.focusIsLeavingContainer&&(o=!1),o&&r.target===e.container.get(0)&&(-32768===e.activeItemIndex&&(e.activeItemIndex=0),t.focus(e.selectables[e.activeItemIndex])),r.stopPropagation()}},L=function(e){return function(t){return e.focusIsLeavingContainer=!1,t.stopPropagation()}},_=function(r,n,o){var a=e.extend(!0,{},n,o),i=P(a.direction),s=a.selectableElements?a.selectableElements:r.find(a.selectableSelector),l={container:r,activeItemIndex:-32768,selectables:s,focusIsLeavingContainer:!1,options:a};return l.selectablesUpdated=function(e){"number"==typeof l.options.selectablesTabindex&&l.selectables.fluid("tabindex",l.options.selectablesTabindex),l.selectables.off("focus."+c),l.selectables.off("blur."+c),l.selectables.on("focus."+c,h(l)),l.selectables.on("blur."+c,v(l)),i&&l.options.noBubbleListeners&&(l.selectables.off("keydown."+c),l.selectables.on("keydown."+c,C(l,i))),e?g(e,l):y(l)},l.refresh=function(){l.options.selectableSelector||t.fail("Cannot refresh selectable context which was not initialised by a selector"),l.selectables=r.find(a.selectableSelector),l.selectablesUpdated()},l.selectedElement=function(){return l.activeItemIndex<0?null:l.selectables[l.activeItemIndex]},i&&!l.options.noBubbleListeners&&r.keydown(C(l,i)),r.keydown(E(l)),r.focus(T(l)),r.blur(L(l)),l.selectablesUpdated(),l};t.selectable=function(r,n){r=e(r);var o=_(r,t.selectable.defaults,n);return t.setScopedData(r,c,o),o},t.selectable.select=function(e,r){t.focus(r)},t.selectable.selectNext=function(r){r=e(r),b(t.getScopedData(r,c))},t.selectable.selectPrevious=function(r){r=e(r),S(t.getScopedData(r,c))},t.selectable.currentSelection=function(r){r=e(r);var n=t.getScopedData(r,c);return e(n.selectedElement())},t.selectable.defaults={direction:t.a11y.orientation.VERTICAL,selectablesTabindex:-1,autoSelectFirstItem:!0,rememberSelectionState:!0,selectableSelector:".selectable",selectableElements:null,onSelect:null,onUnselect:null,onLeaveContainer:null,noWrap:!1};var R=function(e,t){if(!e.modifier)return!0;var r=e.modifier,n=r&&t.ctrlKey,o=r&&t.altKey,a=r&&t.shiftKey;return n||o||a},k=function(r){return function(n){var o=n.target;if(t.enabled(o)){if((n.which?n.which:n.keyCode)===r.key&&r.activateHandler&&R(r,n)){var a=e.Event("fluid-activate");e(o).trigger(a,[r.activateHandler]),a.isDefaultPrevented()&&n.preventDefault()}}}},I=function(r,n,o,a){var i=[];e(o).each(function(e,t){i.push({modifier:null,key:t,activateHandler:n})}),a&&a.additionalBindings&&(i=i.concat(a.additionalBindings)),t.initEnablement(r);for(var s=0;s<i.length;++s){var l=i[s];r.keydown(k(l))}r.on("fluid-activate",function(e,t){return t=t||n,t?t(e):null})};t.activatable=function(r,n,o){r=e(r),I(r,n,t.activatable.defaults.keys,o)},t.activate=function(t){e(t).trigger("fluid-activate")},t.activatable.defaults={keys:[e.ui.keyCode.ENTER,e.ui.keyCode.SPACE]}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.viewComponent",{gradeNames:["fluid.modelComponent"],initFunction:"fluid.initView",argumentMap:{container:0,options:1},members:{dom:"@expand:fluid.initDomBinder({that}, {that}.options.selectors)"}}),t.dumpSelector=function(e){return"string"==typeof e?e:e.selector?e.selector:""},t.diagnoseFailedView=function(e,r,n,o){if(!r&&t.hasGrade(n,"fluid.viewComponent")){var a=t.wrap(o[1]),i="Instantiation of view component with type "+e+" failed, since ";a?0===a.length?t.fail(i+'selector "',t.dumpSelector(o[1]),'" did not match any markup in the document'):t.fail(i+" component creator function did not return a value"):t.fail(i+" container argument is empty")}},t.checkTryCatchParameter=function(){var e=window.location||{search:"",protocol:"file:"},r=e.search.slice(1).split("&");return!0===t.find(r,function(e){if(0===e.indexOf("notrycatch"))return!0})},t.notrycatch=t.checkTryCatchParameter(),t.wrap=function(t,r){return r=r||e,!t||t.jquery?t:r(t)},t.unwrap=function(e){return e&&e.jquery?e[0]:e},t.container=function(e,r,n){var o=e.selector||e;n&&(e=t.unwrap(e));var a=t.wrap(e,n);if(r&&(!a||0===a.length))return null;if(!a||!a.jquery||1!==a.length){"string"!=typeof e&&(e=a.selector);var i=void 0!==a.length?a.length:0;t.fail((i>1?"More than one ("+i+") container elements were":"No container element was")+" found for selector "+e)}return t.isDOMNode(a[0])||t.fail("fluid.container was supplied a non-jQueryable element"),a.selector=o,a.context=a.context||e.ownerDocument||document,a},t.createDomBinder=function(r,n){function o(e,r){return t.allocateSimpleId(r)+"-"+e}function a(e,t,r){i.cache[o(e,t)]=r}var i={id:t.allocateGuid(),cache:{}},s=r.constructor;return i.locate=function(o,i){var l,u,c;if(void 0!==(l=n[o]))return u=i?e(i):r,u||t.fail("DOM binder invoked for selector "+o+" without container"),c=""===l?u:l?"function"==typeof l?s(l.call(null,t.unwrap(u))):s(l,u):s(),c.selector||(c.selector=l,c.context=u),c.selectorName=o,a(o,u,c),c},i.fastLocate=function(e,t){var n=t||r,a=o(e,n),s=i.cache[a];return s||i.locate(e,t)},i.clear=function(){i.cache={}},i.refresh=function(e,t){var n=t||r;"string"==typeof e&&(e=[e]),void 0===n.length&&(n=[n]);for(var o=0;o<e.length;++o)for(var a=0;a<n.length;++a)i.locate(e[o],n[a])},i.resolvePathSegment=i.locate,i},t.expectFilledSelector=function(e,r){e&&0===e.length&&e.jquery&&t.fail(r+': selector "'+e.selector+'" with name '+e.selectorName+" returned no results in context "+t.dumpEl(e.context))},t.initView=function(r,n,o,a){var i=t.container(n,!0);if(t.expectFilledSelector(i,'Error instantiating component with name "'+r),!i)return null;var s=function(e){e.container=i},l=t.initLittleComponent(r,o,a||{gradeNames:["fluid.viewComponent"]},s);l.dom||t.initDomBinder(l);var u=l.options.jQuery;return t.log("Constructing view component "+r+" with container "+i.constructor.expando+(u?" user jQuery "+u.expando:"")+" env: "+e.expando),l},t.initDomBinder=function(e,r){
return e.container||t.fail("fluid.initDomBinder called for component with typeName "+e.typeName+' without an initialised container - this has probably resulted from placing "fluid.viewComponent" in incorrect position in grade merging order.  Make sure to place it to the right of any non-view grades in the gradeNames list to ensure that it overrides properly: resolved gradeNames is ',e.options.gradeNames," for component ",e),e.dom=t.createDomBinder(e.container,r||e.options.selectors||{}),e.locate=e.dom.locate,e.dom},t.findAncestor=function(e,r){for(e=t.unwrap(e);e;){if(r(e))return e;e=e.parentNode}},t.findForm=function(e){return t.findAncestor(e,function(e){return"form"===e.nodeName.toLowerCase()})},t.each(["text","html"],function(r){t[r]=function(t,n){return t=e(t),void 0===n?t[r]():t[r](n)}}),t.value=function(r,n){var o=t.unwrap(r),a=!1;if(void 0===o.nodeType&&o.length>1&&(o=o[0],a=!0),"input"!==o.nodeName.toLowerCase()||!/radio|checkbox/.test(o.type))return void 0===n?e(o).val():e(o).val(n);var i=o.name;void 0===i&&t.fail("Cannot acquire value from node "+t.dumpEl(o)+" which does not have name attribute set");var s;if(a)s=r;else{s=o.ownerDocument.getElementsByName(i);var l=t.findForm(o);s=e.grep(s,function(e){return e.name===i&&(!l||t.dom.isContainer(l,e))})}if(void 0===n){var u=e.map(s,function(e){return e.checked?e.value:null});return"radio"===o.type?u[0]:u}"boolean"==typeof n&&(n=n?"true":"false"),e.each(s,function(){this.checked=n instanceof Array?-1!==n.indexOf(this.value):n===this.value})},t.BINDING_ROOT_KEY="fluid-binding-root",t.findData=function(t,r){for(;t;){var n=e.data(t,r);if(n)return n;t=t.parentNode}},t.bindFossils=function(r,n,o){e.data(r,t.BINDING_ROOT_KEY,{data:n,fossils:o})},t.boundPathForNode=function(e,r){e=t.unwrap(e);var n=e.name||e.id,o=r[n];return o?o.EL:null},t.applyBoundChange=function(e,r,n){e=t.unwrap(e),void 0===r&&(r=t.value(e)),void 0===e.nodeType&&e.length>0&&(e=e[0]);var o=t.findData(e,t.BINDING_ROOT_KEY);o||t.fail("Bound data could not be discovered in any node above "+t.dumpEl(e));var a=e.name,i=o.fossils[a];i||t.fail("No fossil discovered for name "+a+" in fossil record above "+t.dumpEl(e)),"boolean"==typeof i.oldvalue&&(r=!!r[0]);var s=o.fossils[a].EL;n?n.fireChangeRequest({path:s,value:r,source:"DOM:"+e.id}):t.set(o.data,s,r)},t.jById=function(r,n){n=n&&9===n.nodeType?n:document;var o=t.byId(r,n),a=o?e(o):[];return a.selector="#"+r,a.context=n,a},t.byId=function(e,r){r=r&&9===r.nodeType?r:document;var n=r.getElementById(e);return n?(n.id!==e&&t.fail("Problem in document structure - picked up element "+t.dumpEl(n)+" for id "+e+" without this id - most likely the element has a name which conflicts with this id"),n):null},t.getId=function(e){return t.unwrap(e).id},t.allocateSimpleId=function(e){if(!(e=t.unwrap(e))||t.isPrimitive(e))return null;if(!e.id){var r="fluid-id-"+t.allocateGuid();e.id=r}return e.id},t.getDocument=function(e){var r=t.unwrap(e);return 9===r.nodeType?r:r.ownerDocument},t.defaults("fluid.ariaLabeller",{gradeNames:["fluid.viewComponent"],labelAttribute:"aria-label",liveRegionMarkup:'<div class="liveRegion fl-hidden-accessible" aria-live="polite"></div>',liveRegionId:"fluid-ariaLabeller-liveRegion",invokers:{generateLiveElement:{funcName:"fluid.ariaLabeller.generateLiveElement",args:"{that}"},update:{funcName:"fluid.ariaLabeller.update",args:["{that}","{arguments}.0"]}},listeners:{onCreate:{func:"{that}.update",args:[null]}}}),t.ariaLabeller.update=function(e,r){if(r=r||e.options,e.container.attr(e.options.labelAttribute,r.text),r.dynamicLabel){var n=t.jById(e.options.liveRegionId);0===n.length&&(n=e.generateLiveElement()),n.text(r.text)}},t.ariaLabeller.generateLiveElement=function(t){var r=e(t.options.liveRegionMarkup);return r.prop("id",t.options.liveRegionId),e("body").append(r),r};t.getAriaLabeller=function(r){return r=e(r),t.getScopedData(r,"aria-labelling")},t.updateAriaLabel=function(r,n,o){o=e.extend({},o||{},{text:n});var a=t.getAriaLabeller(r);return a?a.update(o):(a=t.ariaLabeller(r,o),t.setScopedData(r,"aria-labelling",a)),a};var r={};e(document).click(function(e){for(var n=t.resolveEventTarget(e);n;){if(r[n.id])return;n=n.parentNode}t.each(r,function(t,n){t(e),delete r[n]})}),t.globalDismissal=function(e,n){t.each(e,function(e){var o=t.unwrap(e).ownerDocument===document?t.allocateSimpleId(e):t.allocateGuid();n?r[o]=n:delete r[o]})},t.now=function(){return Date.now?Date.now():(new Date).getTime()},t.deadMansBlur=function(r,n){var o={options:e.extend(!0,{},t.defaults("fluid.deadMansBlur"),n)};return o.blurPending=!1,o.lastCancel=0,o.canceller=function(e){t.log("Cancellation through "+e.type+" on "+t.dumpEl(e.target)),o.lastCancel=t.now(),o.blurPending=!1},o.noteProceeded=function(){t.globalDismissal(o.options.exclusions)},o.reArm=function(){t.globalDismissal(o.options.exclusions,o.proceed)},o.addExclusion=function(e){t.globalDismissal(e,o.proceed)},o.proceed=function(e){t.log("Direct proceed through "+e.type+" on "+t.dumpEl(e.target)),o.blurPending=!1,o.options.handler(r)},t.each(o.options.exclusions,function(r){r=e(r),t.each(r,function(t){e(t).on("focusin",o.canceller).on("fluid-focus",o.canceller).click(o.canceller).mousedown(o.canceller)})}),o.options.cancelByDefault?o.reArm():e(r).on("focusout",function(e){t.log("Starting blur timer for element "+t.dumpEl(e.target));var n=t.now();t.log("back delay: "+(n-o.lastCancel)),n-o.lastCancel>o.options.backDelay&&(o.blurPending=!0),setTimeout(function(){o.blurPending&&o.options.handler(r)},o.options.delay)}),o},t.defaults("fluid.deadMansBlur",{gradeNames:"fluid.function",delay:150,backDelay:100})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";function r(e){return e}t.explodeLocalisedName=function(e,r,n){var o=e.lastIndexOf(".");-1!==o&&0!==o||(o=e.length);var a=e.substring(0,o),i=e.substring(o),s=r.split("_"),l=t.transform(s,function(e,t){var r=s.slice(0,t+1);return a+"_"+r.join("_")+i});return n&&l.unshift(a+"_"+n+i),l};var n={},o={};t.fetchResources=function(e,r,n){var o={options:t.copy(n||{})};return o.resourceSpecs=e,o.callback=r,o.operate=function(){t.fetchResources.fetchResourcesImpl(o)},t.each(e,function(e,r){e.recurseFirer=t.makeEventFirer({name:'I/O completion for resource "'+r+'"'}),e.recurseFirer.addListener(o.operate),e.url&&!e.href&&(e.href=e.url),o.options.defaultLocale&&(e.defaultLocale=o.options.defaultLocale,void 0===e.locale&&(e.locale=o.options.defaultLocale))}),o.options.amalgamateClasses&&t.fetchResources.amalgamateClasses(e,o.options.amalgamateClasses,o.operate),t.fetchResources.explodeForLocales(e),o.operate(),o},t.fetchResources.explodeForLocales=function(r){return t.each(r,function(n,o){if(n.locale){for(var a=t.explodeLocalisedName(n.href,n.locale,n.defaultLocale),i=0;i<a.length;++i){var s=o+"$localised-"+i,l=e.extend(!0,{},n,{href:a[i],localeExploded:!0});r[s]=l}n.localeExploded=a.length}}),r},t.fetchResources.condenseOneResource=function(e,r,n,o){for(var a=[r],i=0;i<o;++i){var s=n+"$localised-"+i;a.unshift(e[s]),delete e[s]}var l=t.find_if(a,function(e){return!e.fetchError});l&&(e[n]=l)},t.fetchResources.condenseForLocales=function(e){t.each(e,function(r,n){"number"==typeof r.localeExploded&&t.fetchResources.condenseOneResource(e,r,n,r.localeExploded)})},t.fetchResources.notifyResources=function(e,r,n){t.fetchResources.condenseForLocales(r),n(r)},t.fetchResources.amalgamateClasses=function(e,r,n){t.each(r,function(r){var a=o[r];t.each(a,function(t,o){e[r+"!"+o]=t,t.recurseFirer.addListener(n)})})},t.fetchResources.timeSuccessCallback=function(e){if(e.timeSuccess&&e.options&&e.options.success){var r=e.options.success;e.options.success=function(){var n=new Date,o=r.apply(null,arguments);return t.log("External callback for URL "+e.href+" completed - callback time: "+((new Date).getTime()-n.getTime())+"ms"),o}}},t.fetchResources.clearResourceCache=function(e){e?delete n[r(e)]:t.clear(n)},t.fetchResources.handleCachedRequest=function(e,a,i){var s=r(e.href),l=n[s];if(l.$$firer$$){t.log("Handling request for "+s+" from cache");var u=e.fetchClass;u&&o[u]&&(t.log("Clearing pendingClass entry for class "+u),delete o[u][s]);var c={response:a,fetchError:i};n[s]=c,l.fire(a,i)}},t.fetchResources.completeRequest=function(e){e.queued=!1,e.completeTime=new Date,t.log("Request to URL "+e.href+" completed - total elapsed time: "+(e.completeTime.getTime()-e.initTime.getTime())+"ms"),e.recurseFirer.fire()},t.fetchResources.makeResourceCallback=function(e){return{success:function(r){e.resourceText=r,e.resourceKey=e.href,e.forceCache&&t.fetchResources.handleCachedRequest(e,r),t.fetchResources.completeRequest(e)},error:function(r,n,o){e.fetchError={status:r.status,textStatus:r.textStatus,errorThrown:o},e.forceCache&&t.fetchResources.handleCachedRequest(e,null,e.fetchError),t.fetchResources.completeRequest(e)}}},t.fetchResources.issueCachedRequest=function(a,i){var s=r(a.href),l=n[s];if(l)l.$$firer$$?(t.log("Request for cached resource which is in flight: url "+s),l.addListener(function(e,t){e?i.success(e):i.error(t)})):l.response?i.success(l.response):i.error(l.fetchError);else{t.log("First request for cached resource with url "+s),l=t.makeEventFirer({name:"cache notifier for resource URL "+s}),l.$$firer$$=!0,n[s]=l;var u=a.fetchClass;u&&(o[u]||(o[u]={}),o[u][s]=a),i.cache=!1,e.ajax(i)}},t.fetchResources.composeCallbacks=function(e,r){return r?e?function(){try{r.apply(null,arguments)}catch(e){t.log("Exception applying external fetchResources callback: "+e)}e.apply(null,arguments)}:r:e},t.fetchResources.composePolicy=function(e,r){return t.fetchResources.composeCallbacks(e,r)},t.defaults("fluid.fetchResources.issueRequest",{mergePolicy:{success:t.fetchResources.composePolicy,error:t.fetchResources.composePolicy,url:"reverse"}}),t.fetchResources.issueRequest=function(r,n){var o=t.fetchResources.makeResourceCallback(r),a={url:r.href,success:o.success,error:o.error,dataType:r.dataType||"text"};t.fetchResources.timeSuccessCallback(r),a=t.merge(t.defaults("fluid.fetchResources.issueRequest").mergePolicy,a,r.options),r.queued=!0,r.initTime=new Date,t.log("Request with key "+n+" queued for "+r.href),r.forceCache?t.fetchResources.issueCachedRequest(r,a):e.ajax(a)},t.fetchResources.fetchResourcesImpl=function(e){var r=!0,n=e.resourceSpecs;for(var o in n){var a=n[o];if(a.href&&!a.completeTime)a.queued||t.fetchResources.issueRequest(a,o),a.queued&&(r=!1);else if(a.nodeId&&!a.resourceText){var i=document.getElementById(a.nodeId);a.resourceText=t.dom.getElementText(i),a.resourceKey=a.nodeId}}r&&e.callback&&!e.callbackCalled&&(e.callbackCalled=!0,setTimeout(function(){t.fetchResources.notifyResources(e,n,e.callback)},1))},t.fetchResources.primeCacheFromResources=function(e){var r=t.defaults(e).resources,n=(t.expandOptions?t.expandOptions:t.identity)(t.copy(r));t.fetchResources(n)},t.registerNamespace("fluid.expander"),t.expander.makeDefaultFetchOptions=function(r,n,o){return e.extend(!0,{dataType:"text"},o,{success:function(e,t){var n=JSON.parse(e);t(r(n))},error:function(e,r){t.log("Error fetching "+n+": "+r)}})},t.expander.makeFetchExpander=function(e){return{expander:{type:"fluid.expander.deferredFetcher",href:e.url,options:t.expander.makeDefaultFetchOptions(e.disposer,e.url,e.options),resourceSpecCollector:"{resourceSpecCollector}",fetchKey:e.fetchKey}}},t.expander.deferredFetcher=function(e,r,n){var o=r.expander,a=t.copy(o),i=t.expand(o.resourceSpecCollector,n);delete a.type,delete a.resourceSpecCollector,delete a.fetchKey;var s=function(t){e(t)};return a.options.success=function(e){o.options.success(e,s)},i[o.fetchKey||t.allocateGuid()]=a,t.NO_VALUE}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.messageResolver",{gradeNames:["fluid.component"],mergePolicy:{messageBase:"nomerge",parents:"nomerge"},resolveFunc:t.stringTemplate,parseFunc:t.identity,messageBase:{},members:{messageBase:"@expand:{that}.options.parseFunc({that}.options.messageBase)"},invokers:{lookup:"fluid.messageResolver.lookup({that}, {arguments}.0)",resolve:"fluid.messageResolver.resolve({that}, {arguments}.0, {arguments}.1)"},parents:[]}),t.messageResolver.lookup=function(e,r){var n=t.messageResolver.resolveOne(e.messageBase,r);return void 0===n?t.find(e.options.parents,function(e){return e?e.lookup(r):void 0}):{template:n,resolveFunc:e.options.resolveFunc}},t.messageResolver.resolve=function(e,r,n){if(!r)return"[No messagecodes provided]";r=t.makeArray(r);var o=e.lookup(r);return o?o.resolveFunc(o.template,n):"[Message string for key "+r[0]+" not found]"},t.messageResolver.resolveOne=function(e,t){for(var r=0;r<t.length;++r){var n=t[r],o=e[n];if(void 0!==o)return o}},t.messageLocator=function(e,r){var n=t.messageResolver({messageBase:e,resolveFunc:r});return function(e,t){return n.resolve(e,t)}},t.resolveMessageSource=function(e){if("data"===e.type){if(void 0===e.url)return t.messageLocator(e.messages,e.resolveFunc)}else if("resolver"===e.type)return e.resolver.resolve}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.resourceLoader",{gradeNames:["fluid.component"],listeners:{"onCreate.loadResources":{listener:"fluid.resourceLoader.loadResources",args:["{that}",{expander:{func:"{that}.resolveResources"}}]}},defaultLocale:null,locale:null,terms:{},resources:{},resourceOptions:{},invokers:{transformURL:{funcName:"fluid.stringTemplate",args:["{arguments}.0","{that}.options.terms"]},resolveResources:{funcName:"fluid.resourceLoader.resolveResources",args:"{that}"}},events:{onResourcesLoaded:null}}),t.resourceLoader.resolveResources=function(r){var n=t.transform(r.options.resources,r.transformURL);return t.transform(n,function(n){var o={url:n,forceCache:!0,options:r.options.resourceOptions};return e.extend(o,t.filterKeys(r.options,["defaultLocale","locale"]))})},t.resourceLoader.loadResources=function(e,r){t.fetchResources(r,function(){e.resources=r,e.events.onResourcesLoaded.fire(r)})}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.contextAware"),t.defaults("fluid.contextAware.marker",{gradeNames:["fluid.component"]}),t.contextAware.makeCheckMarkers=function(e,r,n){t.each(e,function(e,o){t.constructSingle(r,{type:o,gradeNames:"fluid.contextAware.marker",value:e},n)})},t.contextAware.performChecks=function(e){return t.transform(e,function(e){return"function"==typeof e?e={func:e}:"string"==typeof e&&(e={funcName:e}),t.isPrimitive(e)?e:"value"in e?e.value:"func"in e?e.func():"funcName"in e?t.invokeGlobalFunction(e.funcName):void t.fail("Error in contextAwareness check record ",e," - must contain an entry with name value, func, or funcName")})},t.contextAware.makeChecks=function(e,r,n){var o=t.contextAware.performChecks(e);t.contextAware.makeCheckMarkers(o,r,n)},t.contextAware.forgetChecks=function(e,r,n){n=n||t.globalInstantiator,r=r||[];var o=t.makeArray(e);t.each(o,function(e){var o=t.typeNameToMemberName(e),a=t.model.parseToSegments(r,n.parseEL,!0);a.push(o),t.destroy(a,n)})},t.defaults("fluid.contextAware",{gradeNames:["{that}.check"],mergePolicy:{contextAwareness:"noexpand"},contextAwareness:{},invokers:{check:{funcName:"fluid.contextAware.check",args:["{that}","{that}.options.contextAwareness"]}}}),t.contextAware.getCheckValue=function(e,r){var n=t.parseContextReference(r),o=t.resolveContext(n.context,e),a=n.path||["options","value"];return t.getForComponent(o,a)},t.contextAware.checkOne=function(e,r){r.checks&&r.checks.contextValue&&t.fail("Nesting error in contextAwareness record ",r,' - the "checks" entry must contain a hash and not a contextValue/gradeNames record at top level');var n=t.parsePriorityRecords(r.checks,"contextAwareness checkRecord");return t.find(n,function(r){r.contextValue||t.fail("Cannot perform check for contextAwareness record ",r,' without a valid field named "contextValue"');var n=t.contextAware.getCheckValue(e,r.contextValue);if(void 0===r.equals?n:n===r.equals)return r.gradeNames},r.defaultGradeNames)},t.contextAware.check=function(e,r){var n=[],o=t.parsePriorityRecords(r,"contextAwareness adaptationRecord");return t.each(o,function(r){var o=t.contextAware.checkOne(e,r);n=n.concat(t.makeArray(o))}),n},t.contextAware.makeAdaptation=function(e){t.expect("fluid.contextAware.makeAdaptation",e,["distributionName","targetName","adaptationName","checkName","record"]),t.defaults(e.distributionName,{gradeNames:["fluid.component"],distributeOptions:{target:"{/ "+e.targetName+"}.options.contextAwareness."+e.adaptationName+".checks."+e.checkName,record:e.record}}),t.constructSingle([],e.distributionName)},t.contextAware.isBrowser=function(){return"undefined"!=typeof window&&window.document},t.contextAware.makeChecks({"fluid.browser":{funcName:"fluid.contextAware.isBrowser"}}),t.registerNamespace("fluid.contextAware.browser"),t.contextAware.browser.getPlatformName=function(){return"undefined"!=typeof navigator&&navigator.platform?navigator.platform:void 0},t.contextAware.browser.getUserAgent=function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:void 0},t.contextAware.makeChecks({"fluid.browser.platformName":{funcName:"fluid.contextAware.browser.getPlatformName"},"fluid.browser.userAgent":{funcName:"fluid.contextAware.browser.getUserAgent"}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.enhance"),t.contextAware.isBrowser()&&e.fn&&e("head").append("<style type='text/css'>.fl-progEnhance-basic, .fl-ProgEnhance-basic { display: none; } .fl-progEnhance-enhanced, .fl-ProgEnhance-enhanced { display: block; }</style>")}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.XMLP=function(e){return t.XMLP.XMLPImpl(e)},t.XMLP.closedTags={abbr:!0,br:!0,col:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,hr:!0,area:!0,embed:!0},t.XMLP._NONE=0,t.XMLP._ELM_B=1,t.XMLP._ELM_E=2,t.XMLP._ELM_EMP=3,t.XMLP._ATT=4,t.XMLP._TEXT=5,t.XMLP._ENTITY=6,t.XMLP._PI=7,t.XMLP._CDATA=8,t.XMLP._COMMENT=9,t.XMLP._DTD=10,t.XMLP._ERROR=11,t.XMLP._CONT_XML=0,t.XMLP._CONT_ALT=1,t.XMLP._ATT_NAME=0,t.XMLP._ATT_VAL=1,t.XMLP._STATE_PROLOG=1,t.XMLP._STATE_DOCUMENT=2,t.XMLP._STATE_MISC=3,t.XMLP._errs=[],t.XMLP._errs[t.XMLP.ERR_CLOSE_PI=0]="PI: missing closing sequence",t.XMLP._errs[t.XMLP.ERR_CLOSE_DTD=1]="DTD: missing closing sequence",t.XMLP._errs[t.XMLP.ERR_CLOSE_COMMENT=2]="Comment: missing closing sequence",t.XMLP._errs[t.XMLP.ERR_CLOSE_CDATA=3]="CDATA: missing closing sequence",t.XMLP._errs[t.XMLP.ERR_CLOSE_ELM=4]="Element: missing closing sequence",t.XMLP._errs[t.XMLP.ERR_CLOSE_ENTITY=5]="Entity: missing closing sequence",t.XMLP._errs[t.XMLP.ERR_PI_TARGET=6]="PI: target is required",t.XMLP._errs[t.XMLP.ERR_ELM_EMPTY=7]="Element: cannot be both empty and closing",t.XMLP._errs[t.XMLP.ERR_ELM_NAME=8]='Element: name must immediately follow "<"',t.XMLP._errs[t.XMLP.ERR_ELM_LT_NAME=9]='Element: "<" not allowed in element names',t.XMLP._errs[t.XMLP.ERR_ATT_VALUES=10]="Attribute: values are required and must be in quotes",t.XMLP._errs[t.XMLP.ERR_ATT_LT_NAME=11]='Element: "<" not allowed in attribute names',t.XMLP._errs[t.XMLP.ERR_ATT_LT_VALUE=12]='Attribute: "<" not allowed in attribute values',t.XMLP._errs[t.XMLP.ERR_ATT_DUP=13]="Attribute: duplicate attributes not allowed",t.XMLP._errs[t.XMLP.ERR_ENTITY_UNKNOWN=14]="Entity: unknown entity",t.XMLP._errs[t.XMLP.ERR_INFINITELOOP=15]="Infinite loop",t.XMLP._errs[t.XMLP.ERR_DOC_STRUCTURE=16]="Document: only comments, processing instructions, or whitespace allowed outside of document element",t.XMLP._errs[t.XMLP.ERR_ELM_NESTING=17]="Element: must be nested correctly",t.XMLP._checkStructure=function(e,r){var n=e.m_stack;if(t.XMLP._STATE_PROLOG==e.m_iState&&(e.m_iState=t.XMLP._STATE_DOCUMENT),t.XMLP._STATE_DOCUMENT===e.m_iState&&(t.XMLP._ELM_B!=r&&t.XMLP._ELM_EMP!=r||(e.m_stack[n.length]=e.getName()),t.XMLP._ELM_E==r||t.XMLP._ELM_EMP==r)){if(0===n.length)return t.XMLP._NONE;var o=n[n.length-1];if(e.m_stack.length--,null===o||o!==e.getName())return t.XMLP._setErr(e,t.XMLP.ERR_ELM_NESTING)}return r},t.XMLP._parseCDATA=function(e,r){var n=e.m_xml.indexOf("]]>",r);return-1==n?t.XMLP._setErr(e,t.XMLP.ERR_CLOSE_CDATA):(t.XMLP._setContent(e,t.XMLP._CONT_XML,r,n),e.m_iP=n+3,t.XMLP._CDATA)},t.XMLP._parseComment=function(e,r){var n=e.m_xml.indexOf("--\x3e",r);return-1==n?t.XMLP._setErr(e,t.XMLP.ERR_CLOSE_COMMENT):(t.XMLP._setContent(e,t.XMLP._CONT_XML,r-4,n+3),e.m_iP=n+3,t.XMLP._COMMENT)},t.XMLP._parseDTD=function(e,r){var n,o,a,i;if(-1==(n=e.m_xml.indexOf(">",r)))return t.XMLP._setErr(e,t.XMLP.ERR_CLOSE_DTD);for(a=e.m_xml.indexOf("[",r),o=-1!=a&&a<n?"]>":">";;){if(n==i)return t.XMLP._setErr(e,t.XMLP.ERR_INFINITELOOP);if(i=n,-1==(n=e.m_xml.indexOf(o,r)))return t.XMLP._setErr(e,t.XMLP.ERR_CLOSE_DTD);if("]]>"!=e.m_xml.substring(n-1,n+2))break}return e.m_iP=n+o.length,t.XMLP._DTD},t.XMLP._parsePI=function(e,r){var n,o,a,i,s;return-1==(n=e.m_xml.indexOf("?>",r))?t.XMLP._setErr(e,t.XMLP.ERR_CLOSE_PI):-1==(o=t.SAXStrings.indexOfNonWhitespace(e.m_xml,r,n))?t.XMLP._setErr(e,t.XMLP.ERR_PI_TARGET):(a=t.SAXStrings.indexOfWhitespace(e.m_xml,o,n),-1==a&&(a=n),i=t.SAXStrings.indexOfNonWhitespace(e.m_xml,a,n),-1==i&&(i=n),s=t.SAXStrings.lastIndexOfNonWhitespace(e.m_xml,i,n),-1==s&&(s=n-1),e.m_name=e.m_xml.substring(o,a),t.XMLP._setContent(e,t.XMLP._CONT_XML,i,s+1),e.m_iP=n+2,t.XMLP._PI)},t.XMLP._parseText=function(e,r){var n=e.m_xml.indexOf("<",r);return-1==n&&(n=e.m_xml.length),t.XMLP._setContent(e,t.XMLP._CONT_XML,r,n),e.m_iP=n,t.XMLP._TEXT},t.XMLP._setContent=function(e,r){var n=arguments;t.XMLP._CONT_XML==r?(e.m_cAlt=null,e.m_cB=n[2],e.m_cE=n[3]):(e.m_cAlt=n[2],e.m_cB=0,e.m_cE=n[2].length),e.m_cSrc=r},t.XMLP._setErr=function(e,r){var n=t.XMLP._errs[r];return e.m_cAlt=n,e.m_cB=0,e.m_cE=n.length,e.m_cSrc=t.XMLP._CONT_ALT,t.XMLP._ERROR},t.XMLP._parseElement=function(e,r){var n,o,a,i;if(o=n=e.m_xml.indexOf(">",r),-1==n)return t.XMLP._setErr(e,t.XMLP.ERR_CLOSE_ELM);if("/"==e.m_xml.charAt(r)?(a=t.XMLP._ELM_E,r++):a=t.XMLP._ELM_B,"/"==e.m_xml.charAt(n-1)){if(a==t.XMLP._ELM_E)return t.XMLP._setErr(e,t.XMLP.ERR_ELM_EMPTY);a=t.XMLP._ELM_EMP,o--}e.nameRegex.lastIndex=r;var s=e.nameRegex.exec(e.m_xml);if(!s)return t.XMLP._setErr(e,t.XMLP.ERR_ELM_NAME);if("li"===(i=s[1].toLowerCase())&&a!==t.XMLP._ELM_E&&e.m_stack.length>0&&"li"===e.m_stack[e.m_stack.length-1]&&!e.m_emitSynthetic)return e.m_name="li",e.m_emitSynthetic=!0,t.XMLP._ELM_E;if(e.m_attributes={},e.m_cAlt="",e.nameRegex.lastIndex<o)for(e.m_iP=e.nameRegex.lastIndex;e.m_iP<o;){e.attrStartRegex.lastIndex=e.m_iP;var l=e.attrStartRegex.exec(e.m_xml);if(!l)return t.XMLP._setErr(e,t.XMLP.ERR_ATT_VALUES);var u,c=l[1].toLowerCase();if(61===e.m_xml.charCodeAt(e.attrStartRegex.lastIndex)){var d=34===e.m_xml.charCodeAt(e.attrStartRegex.lastIndex+1)?e.attrValRegex:e.attrValIERegex;if(d.lastIndex=e.attrStartRegex.lastIndex+1,!(l=d.exec(e.m_xml)))return t.XMLP._setErr(e,t.XMLP.ERR_ATT_VALUES);u=l[1]}else u=c,d=e.attrStartRegex;if(e.m_attributes[c]&&e.m_attributes[c]!==u)return t.XMLP._setErr(e,t.XMLP.ERR_ATT_DUP);e.m_attributes[c]=u,e.m_iP=d.lastIndex}if(-1!=i.indexOf("<"))return t.XMLP._setErr(e,t.XMLP.ERR_ELM_LT_NAME);if(e.m_name=i,e.m_iP=n+1,t.XMLP.closedTags[i]){e.closeRegex.lastIndex=n+1;var f=e.closeRegex.exec;if(f){return e.m_xml.indexOf(i,f.lastIndex)===f.lastIndex?a:t.XMLP._ELM_EMP}}return e.m_emitSynthetic=!1,a},t.XMLP._parse=function(e){var r=e.m_iP,n=e.m_xml;if(r===n.length)return t.XMLP._NONE;if("<"!==n.charAt(r))return t.XMLP._parseText(e,r);var o=n.charAt(r+1);return"?"===o?t.XMLP._parsePI(e,r+2):"!"!==o?t.XMLP._parseElement(e,r+1):r===n.indexOf("<!DOCTYPE",r)?t.XMLP._parseDTD(e,r+9):r===n.indexOf("\x3c!--",r)?t.XMLP._parseComment(e,r+4):r===n.indexOf("<![CDATA[",r)?t.XMLP._parseCDATA(e,r+9):void 0},t.XMLP.XMLPImpl=function(e){var r={};return r.m_xml=e,r.m_iP=0,r.m_iState=t.XMLP._STATE_PROLOG,r.m_stack=[],r.m_attributes={},r.m_emitSynthetic=!1,r.getColumnNumber=function(){return t.SAXStrings.getColumnNumber(r.m_xml,r.m_iP)},r.getContent=function(){return r.m_cSrc==t.XMLP._CONT_XML?r.m_xml:r.m_cAlt},r.getContentBegin=function(){return r.m_cB},r.getContentEnd=function(){return r.m_cE},r.getLineNumber=function(){return t.SAXStrings.getLineNumber(r.m_xml,r.m_iP)},r.getName=function(){return r.m_name},r.next=function(){return t.XMLP._checkStructure(r,t.XMLP._parse(r))},r.nameRegex=/([^\s\/>]+)/g,r.attrStartRegex=/\s*([\w:_][\w:_\-\.]*)/gm,r.attrValRegex=/\"([^\"]*)\"\s*/gm,r.attrValIERegex=/([^\>\s]+)\s*/gm,r.closeRegex=/\s*<\//g,r},t.SAXStrings={},t.SAXStrings.WHITESPACE=" \t\n\r",t.SAXStrings.QUOTES="\"'",t.SAXStrings.getColumnNumber=function(e,t){if(!e)return-1;t=t||e.length;var r=e.substring(0,t).split("\n");return r.length--,t-r.join("\n").length},t.SAXStrings.getLineNumber=function(e,t){return e?(t=t||e.length,e.substring(0,t).split("\n").length):-1},t.SAXStrings.indexOfNonWhitespace=function(e,t,r){if(!e)return-1;t=t||0,r=r||e.length;for(var n=t;n<r;++n){var o=e.charAt(n);if(" "!==o&&"\t"!==o&&"\n"!==o&&"\r"!==o)return n}return-1},t.SAXStrings.indexOfWhitespace=function(e,r,n){if(!e)return-1;r=r||0,n=n||e.length;for(var o=r;o<n;o++)if(-1!=t.SAXStrings.WHITESPACE.indexOf(e.charAt(o)))return o;return-1},t.SAXStrings.lastIndexOfNonWhitespace=function(e,r,n){if(!e)return-1;r=r||0,n=n||e.length;for(var o=n-1;o>=r;o--)if(-1==t.SAXStrings.WHITESPACE.indexOf(e.charAt(o)))return o;return-1},t.SAXStrings.replace=function(e,t,r,n,o){return e?(t=t||0,r=r||e.length,e.substring(t,r).split(n).join(o)):""}}(jQuery,fluid_3_0_0),fluid_3_0_0=fluid_3_0_0||{},function(e,t){"use strict";t.parseTemplate=function(r,n,o,a,i){function s(e){return 1===e.length&&1===e[0].predList.length&&e[0].predList[0].clazz}function l(){for(var e=C.length-1;e>=0;--e){var t=C[e];if(void 0!==t.rsfID)return t}return b.rootlump}function u(){var e=M(P,E);return R&&(e.line=S.getLineNumber(),e.column=S.getColumnNumber()),b.lumps[P]=e,++P,e}function c(e,t,r){var n=e[t];n||(n=[],e[t]=n),n[n.length]=r}function d(e,t){if(-1!==e.indexOf("scr=contribute-")){var r=e.substring("scr=contribute-".length);c(b.collectmap,r,t)}}function f(e){return"<"+e.tagname+">"}function p(e,t){return!!t&&-1!==(" "+t+" ").indexOf(" "+e+" ")}function m(e,t,r){if(e.predList){for(var n=0;n<e.predList.length;++n){var o=e.predList[n];if(o.id&&t.attributemap.id!==o.id)return!1;if(o.clazz&&!p(o.clazz,r))return!1;if(o.tag&&t.tagname!==o.tag)return!1}return!0}}function g(r){var n,o,a=r.attributemap.class;if(a){var i=a.split(" ");for(o=0;o<i.length;++o){var s=I[e.trim(i[o])];if(s)return s}}for(o=0;o<k.length;++o){var l=k[o],u=w[o],c=u.length;if(c<l.tree.length){var d=l.tree[c];if(c>0&&l.tree[c-1].child&&u[c-1]!==r.nestingdepth-1)continue;m(d,r,a)&&(u[u.length]=r.nestingdepth,u.length===l.tree.length&&(void 0!==n&&t.fail("Cutpoint specification error - node "+f(r)+" has already matched with rsf:id of "+n),void 0!==l.id&&null!==l.id||t.fail("Error in cutpoints list - entry at position "+o+" does not have an id set"),n=l.id))}}return n}function h(){if(k)for(var e=0;e<k.length;++e){var t=w[e];t.length>0&&t[t.length-1]===E&&t.length--}}function v(){h();var e=u();--E,e.text="</"+S.getName()+">",C[C.length-1].close_tag=b.lumps[P-1],C.length--,T=!0}function y(e){if(++E,T){T=!1;u().nestingdepth--}-1===b.firstdocumentindex&&(b.firstdocumentindex=P);var r=u(),n=C[C.length-1];r.uplump=n;var o=S.getName();r.tagname=o;var a=r.attributemap=S.m_attributes,i=a[t.ID_ATTRIBUTE];void 0===i&&(i=g(r));for(var s in a)void 0===i&&(/href|src|codebase|action/.test(s)?i="scr=rewrite-url":void 0===i&&/for|headers/.test(s)&&(i="scr=null"));if(i){126===i.charCodeAt(0)&&(i=i.substring(1),r.elide=!0),d(i,r),r.rsfID=i;var f=l();for(f.downmap||(f.downmap={});f;)f.downmap&&c(f.downmap,i,r),f=f.uplump;c(b.globalmap,i,r);var p=i.indexOf(":");if(-1!==p){var m=i.substring(0,p);n.finallump||(n.finallump={}),n.finallump[m]=r}}r.text="<"+o+t.dumpAttributes(a)+(e&&!i?"/>":">"),C[C.length]=r,e&&(i?v():(--E,C.length--))}function x(){if(-1!==L){-1===b.firstdocumentindex&&(b.firstdocumentindex=P);var e=S.getContent().substr(L,_-L);T=!1;u().text=e,L=-1}}i=i||{},r||t.fail("empty template supplied to fluid.parseTemplate");var b,S,C,P=0,E=0,T=!1,L=-1,_=-1,R=!1,k=[],I={},w=[],M=function(e,t){return{nestingdepth:t,lumpindex:e,parent:b}};b=t.XMLViewTemplate(),function(r,o,a){if(b.rootlump=M(0,-1),C=[b.rootlump],P=0,E=0,T=!1,L=-1,_=-1,n=r,R=o,a)for(var i=0;i<a.length;++i){var l=t.parseSelector(a[i].selector,t.simpleCSSMatcher),u=s(l);u?I[u]=a[i].id:(w.push([]),k.push(e.extend({},a[i],{tree:l})))}}(n,i.debugMode,a);var N=r.indexOf(t.ID_ATTRIBUTE);if(o){var O=r.indexOf(">",N);S=t.XMLP(r.substring(O+1))}else S=t.XMLP(r);e:for(;;){var A=S.next();switch(A){case t.XMLP._ELM_B:x(),y(!1);break;case t.XMLP._ELM_E:x(),v();break;case t.XMLP._ELM_EMP:x(),y(!0);break;case t.XMLP._PI:case t.XMLP._DTD:L=-1;continue;case t.XMLP._TEXT:case t.XMLP._ENTITY:case t.XMLP._CDATA:case t.XMLP._COMMENT:-1===L&&(L=S.m_cB),_=S.m_cE;break;case t.XMLP._ERROR:t.setLogging(!0);var D="Error parsing template: "+S.m_cAlt+" at line "+S.getLineNumber();t.log(D),t.log("Just read: "+S.m_xml.substring(S.m_iP-30,S.m_iP)),t.log("Still to read: "+S.m_xml.substring(S.m_iP,S.m_iP+30)),t.fail(D);break e;case t.XMLP._NONE:break e}}x();var F=C.length-1;return F&&t.fail("Error parsing template - unclosed tag(s) of depth "+F+": "+t.transform(C.splice(1,F),function(e){return f(e)}).join(", ")),b},t.debugLump=function(e){var t=e.text;return t+=" at ",t+="lump line "+e.line+" column "+e.column+" index "+e.lumpindex,t+=null===e.parent.href?"":" in file "+e.parent.href},t.ID_ATTRIBUTE="rsf:id",t.getPrefix=function(e){var t=e.indexOf(":");return-1===t?e:e.substring(0,t)},t.SplitID=function(e){var t={},r=e.indexOf(":");return-1===r?t.prefix=e:(t.prefix=e.substring(0,r),t.suffix=e.substring(r+1)),t},t.XMLViewTemplate=function(){return{globalmap:{},collectmap:{},lumps:[],firstdocumentindex:-1}},t.XMLEncode=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")},t.dumpAttributes=function(e){var t="";for(var r in e){var n=e[r];null!==n&&void 0!==n&&(t+=" "+r+'="'+n+'"')}return t},t.aggregateMMap=function(e,t){for(var r in t){e[r]||(e[r]=[]),e[r]=e[r].concat(t[r])}},t.parseTemplates=function(e,r,n){var o=[];n=n||{},o.globalmap={};for(var a=0;a<r.length;++a){var i=e[r[a]],s=i.href.lastIndexOf("/"),l=-1===s?"":i.href.substring(0,s+1),u=t.parseTemplate(i.resourceText,l,n.scanStart&&0===a,i.cutpoints,n);0===a&&t.aggregateMMap(o.globalmap,u.globalmap),u.href=i.href,u.baseURL=l,u.resourceKey=i.resourceKey,o[a]=u,t.aggregateMMap(o.globalmap,u.rootlump.downmap)}return o}}(jQuery,fluid_3_0_0),fluid_3_0_0=fluid_3_0_0||{},function(e,t){"use strict";function r(e){return"as child of "+(e.parent.fullID?"component with full ID "+e.parent.fullID:"root")}function n(e){var n="",o=e;for(void 0===e.children&&(n=e.ID+(void 0!==e.localID?e.localID:""),o=e.parent);o.parent;){var a=o.parent;if(void 0!==o.fullID)return n=o.fullID+n;if(void 0===o.noID){var i=o.ID;void 0===i&&t.fail("Error in component tree - component found with no ID "+r(a)+": please check structure");var s=i.indexOf(":");n=(-1===s?i:i.substring(0,s))+":"+(void 0===o.localID?"":o.localID)+":"+n}o=a}return n}function o(e,t){if(c.isBoundPrimitive(e))return{componentType:"UIBound",value:e,ID:t};var r=d(e);return r.ID?{ID:t,componentType:"UIContainer",children:[r]}:(r.ID=t,r)}function a(e){if(t.isArrayable(e))return e;var r=[];for(var n in e){var a=e[n];if(t.isArrayable(a))for(var i=0;i<a.length;++i){var s=o(a[i],n);r[r.length]=s}else r[r.length]=o(a,n)}return r}function i(e,r,n){void 0===e.value&&void 0!==e.valuebinding&&(e.value=t.get(r,e.valuebinding,n))}function s(e,t,r,n){void 0!==e[t]?c.isBoundPrimitive(e[t])?e[t]={value:e[t]}:e[t].messagekey&&(e[t].componentType="UIMessage"):e[t]={value:null},i(e[t],r,n)}function l(e,o,a){if(void 0===e.componentType&&(e=d(e,o,a)),"UIContainer"===e.componentType||e.parent||(e={children:[e]}),e.children){e.childmap={}
;for(var s=0;s<e.children.length;++s){var u=e.children[s];void 0===u.componentType&&(u=d(u,o,a),e.children[s]=u),u.parent=e,void 0===u.ID&&t.fail("Error in component tree: component found with no ID "+r(u)),e.childmap[u.ID]=u;var c=u.ID.indexOf(":");if(-1===c);else{var f=u.ID.substring(0,c),p=e.childmap[f];p||(p=[],e.childmap[f]=p),void 0===u.localID&&0!==p.length&&(u.localID=p.length),p[p.length]=u}u.fullID=n(u);var m=u.componentType;if("UISelect"===m)u.selection.fullID=u.fullID;else if("UIInitBlock"===m){for(var g=u.functionname+"(",h=u.arguments,v=0;v<h.length;++v)h[v]instanceof t.ComponentReference&&(h[v]=u.parent.fullID+h[v].reference),g+=JSON.stringify(h[v]),v<h.length-1&&(g+=", ");u.markup={value:g+")\n"},u.componentType="UIVerbatim"}else"UIBound"===m&&i(u,o,a);l(u,o,a)}}return e}function u(e){var r=t.dom.iterateDom(e,function(e){return 8===e.nodeType||4===e.nodeType?"stop":null},!0),n=r.nodeValue;return 0===n.indexOf("[CDATA[")?n.substring(6,n.length-2):n}var c={};c.isBoundPrimitive=function(e){return t.isPrimitive(e)||t.isArrayable(e)&&(0===e.length||"string"==typeof e[0])};var d;c.duckMap={children:"UIContainer",value:"UIBound",valuebinding:"UIBound",messagekey:"UIMessage",markup:"UIVerbatim",selection:"UISelect",target:"UILink",choiceindex:"UISelectChoice",functionname:"UIInitBlock"};var f={UISelect:["selection","optionlist","optionnames"],UILink:["target","linktext"],UIVerbatim:["markup"],UIMessage:["messagekey"]};c.boundMap=t.transform(f,t.arrayToHash),c.inferComponentType=function(e){for(var t in c.duckMap)if(void 0!==e[t])return c.duckMap[t]},c.applyComponentType=function(e){e.componentType=c.inferComponentType(e),void 0===e.componentType&&void 0!==e.ID&&(e.componentType="UIBound")},d=function(e,r,n){if(e&&c.applyComponentType(e),!e||void 0===e.componentType){var o=e.decorators;o&&delete e.decorators,e={componentType:"UIContainer",children:e},e.decorators=o}var i=e.componentType;if("UIContainer"===i)e.children=a(e.children);else{var l=c.boundMap[i];l&&t.each(l,function(t,o){s(e,o,r,n)})}return e},t.NULL_STRING="null";var p={a:"href",link:"href",img:"src",frame:"src",script:"src",style:"src",input:"src",embed:"src",form:"action",applet:"codebase",object:"codebase"};c.decoratorComponentPrefix="**-renderer-",c.IDtoComponentName=function(e,t){return c.decoratorComponentPrefix+e.replace(/\./g,"")+"-"+t},c.invokeFluidDecorator=function(e,r,n,o,a){var i;if(a.parentComponent){var s=a.parentComponent,l=c.IDtoComponentName(n,o);t.set(s,["options","components",l],{type:e,container:r[0],options:r[1]}),i=t.initDependent(a.parentComponent,l)}else i=t.invokeGlobalFunction(e,r);return i},t.renderer=function(r,n,o,a){function i(e,t,r){return e.resourceKey+t.fullID+r}function u(e,t,r){var n,o=r?r[e]:null;if(o)for(var a=0;a<o.length;++a){var i=o[a];if(n||i.rsfID!==t||(n=i),i.rsfID===e)return i}return n}function d(e,r){var n=r.jointID?r.jointID:r.ID,o=t.SplitID(n),a=o.prefix+":",i=u(n,a,e.downmap,r);return i||(r.children&&(i=u(n,a,ie,r))?i:null)}function f(e){ue[e.href]||(t.aggregateMMap(ce,e.collectmap),ue[e.href]=!0)}function m(e,t){var r,n,o;for(r=0;r<e.children.length;++r){var a=e.children[r];a.children&&(o=d(t,a))&&(se[a.fullID]=o,n=o.attributemap.id,void 0!==n&&(le[i(t.parent,e,n)]=a.fullID),f(o.parent),m(a,o))}if(t.downmap)for(n in t.downmap){var s=t.downmap[n];for(r=0;r<s.length;++r){var l=s[r],u=l.attributemap.id;if(void 0!==u&&void 0!==l.rsfID&&null!==(o=oe(e,l.rsfID))){var c=o.fullID;le[i(t.parent,e,u)]=c}}}}function g(e,t,r){se={},le={},ue={},ce={},ie=e,se[t.fullID]=r,m(t,r)}function h(e,t,r){for(;t<r;++t){e[t].text&&(de+=e[t].text)}}function v(e,r,n,o,a){for(var i=r;;){if(r===e.length)break;var s=e[r];if(s.nestingdepth<n)break;if(void 0!==s.rsfID){if(!a)break;if(!(a&&s.nestingdepth>n+(o?0:1)))break;t.log("Error in component tree - leaf component found to contain further components - at "+s.toString())}++r}return o||r!==e.length&&e[r].rsfID||--r,h(e,i,r),r}function y(){return!1}function x(e){return null!==e&&void 0!==e&&!y(e)}function b(){ve.iselide||(de+="<"+ve.uselump.tagname)}function S(){ve.iselide||(de+="</"+ve.uselump.tagname+">")}function C(){h(ve.uselump.parent.lumps,ve.uselump.lumpindex+1,ve.close.lumpindex+(ve.iselide?0:1))}function P(){return ve.endopen.lumpindex===ve.close.lumpindex&&t.XMLP.closedTags[ve.uselump.tagname]}function E(){P()?ve.iselide||(de+="/>"):(ve.iselide||(de+=">"),h(ve.uselump.parent.lumps,ve.endopen.lumpindex,ve.close.lumpindex+(ve.iselide?0:1)))}function T(){ve.iselide||(de+=t.dumpAttributes(ve.attrcopy)),E()}function L(){if(ve.iselide)T();else{de+=t.dumpAttributes(ve.attrcopy);var e=P();de+=e?"/>":">",ve.nextpos=e?ve.close.lumpindex+1:ve.endopen.lumpindex}}function _(e){de+=t.dumpAttributes(ve.attrcopy),ve.iselide||(de+=">"),de+=t.XMLEncode(e.toString()),S()}function R(e){x(e)?_(e):T()}function k(e){ve.iselide?R(ve.value):x(e)?_(e):L()}function I(e,t){if(fe.urlRewriter){var r=fe.urlRewriter(t);if(r)return r}if(!fe.rebaseURLs)return t;var n=t.indexOf(":/");return"/"===t.charAt(0)||-1!==n&&n<7?t:fe.baseURL+t}function w(e){de+='<input type="hidden" ';var r=e.virtual,n={};n[r?"id":"name"]=e.name,n.value=e.value,de+=t.dumpAttributes(n),de+=" />\n"}function M(r,n){function o(){t.applyBoundChange(t.byId(n,fe.document),void 0,i)}if(n){var a=ve.uselump.tagname,i=fe.applier;if(fe.autoBind&&/input|select|textarea/.test(a)&&!me[n]){var s=[{jQuery:["change",o]}];e.browser.msie&&"input"===a&&/radio|checkbox/.test(ve.attrcopy.type)&&s.push({jQuery:["click",o]}),e.browser.safari&&"input"===a&&"radio"===ve.attrcopy.type&&s.push({jQuery:["keyup",o]}),ae(r,s,ve.attrcopy,n)}}}function N(e,t){if(e){var r=t||e;if(fe.fossils&&void 0!==r.valuebinding){var n=r.submittingname||e.finalID;fe.fossils[n]={name:n,EL:r.valuebinding,oldvalue:r.value},M(e,e.finalID)}e.fossilizedbinding&&w(e.fossilizedbinding),e.fossilizedshaper&&w(e.fossilizedshaper)}}function O(e){me[e.selection.fullID]||(me[e.selection.fullID]=!0,N(e.selection),N(e.optionlist),N(e.optionnames))}function A(e,r){var n=e.selection;return t.isArrayable(n.value)?-1!==n.value.indexOf(r):n.value===r}function D(e,t){for(e=e.parent;0===t.indexOf("..::");)t=t.substring(4),e=e.parent;return e.childmap[t]}function F(e,r){t.each(le,function(t,n){t===e&&(le[n]=r)})}function j(e,t,r,n){r||delete e["rsf:id"],void 0!==t.finalID?e.id=t.finalID:void 0!==n?e.id=n:(e.id||r)&&(e.id=t.fullID);for(var o=1,a=e.id;fe.document.getElementById(e.id)||ge[e.id];)e.id=a+"-"+o++;return 1!==o&&F(a,e.id),t.finalID=e.id,e.id}function B(e,t,r){var n=r||t;return j(e,t,!0,t.fullID),void 0===n.submittingname&&!1!==n.willinput&&(n.submittingname=n.finalID||n.fullID),n.submittingname}function V(e){var t=[];if(e.type)t[0]=e;else for(var r in e){"$"===r&&(r="jQuery");var n=e[r],o={type:r};"jQuery"===r?(o.func=n[0],o.args=n.slice(1)):"addClass"===r||"removeClass"===r?o.classes=n:"attrs"===r?o.attributes=n:"identify"===r&&(o.key=n),t[t.length]=o}return t}function G(e,t){e.decorators&&(void 0===e.decorators.length&&(e.decorators=V(e.decorators)),ae(e,e.decorators,t))}function U(r,n){if(!n.elide){var o={};e.extend(!0,o,n.attributemap),j(o,r),G(r,o),de+="<"+n.tagname+" ",de+=t.dumpAttributes(o),de+=">"}}function X(e){return e?(e=t.copy(e),t.transform(e,function(t,r){return s(e,r,fe.model,fe.resolverGetConfig),e[r].value})):e}function q(e){if("UIMessage"===e.componentType)if(e.componentType="UIBound",fe.messageLocator){s(e,"messagekey",fe.model,fe.resolverGetConfig);var t=X(e.args);e.value=fe.messageLocator(e.messagekey.value,t)}else e.value="[No messageLocator is configured in options - please consult documentation on options.messageSource]"}function H(e){function r(e,r){t.fail("Error in component tree - UISelectChoice with id "+e.fullID+r)}var n,o=ve.attrcopy;q(e);var a=e.componentType,i=ve.uselump.tagname;if(G(e,o),"UIBound"===a||"UISelectChoice"===a){var s;void 0!==e.choiceindex&&(void 0!==e.parentRelativeID?(s=D(e,e.parentRelativeID))||r(e," has parentRelativeID of "+e.parentRelativeID+" which cannot be resolved"):r(e," does not have parentRelativeID set"),B(o,e,s.selection),O(s));var l=s?s.selection.submittingname:e.submittingname;if(!s&&e.valuebinding&&(l=B(o,e)),"input"!==i&&"textarea"!==i||void 0!==l&&(o.name=l),N(e,s?s.selection:null),"boolean"==typeof e.value||"radio"===o.type||"checkbox"===o.type){var u,c=e.value;void 0!==e.choiceindex&&(s.optionlist.value||t.fail("Error in component tree - selection control with full ID "+s.fullID+" has no values"),u=s.optionlist.value[e.choiceindex],c=A(s,u)),x(c)&&(c?o.checked="checked":delete o.checked),o.value=t.XMLEncode(u||"true"),R(null)}else t.isArrayable(e.value)?C():(n=s?s["textarea"===i||"input"===i?"optionlist":"optionnames"].value[e.choiceindex]:e.value,"textarea"===i?(y(n)&&e.willinput&&(n=""),R(n)):"input"===i?((e.willinput||x(n))&&(o.value=t.XMLEncode(String(n))),R(null)):(delete o.name,k(n)))}else if("UISelect"===a){var d="select"===i;if(t.isArrayable(e.selection.value)&&(!0,d&&(o.multiple="multiple")),B(o,e.selection),d&&(!1!==e.selection.willinput&&(o.name=e.selection.submittingname),M(e,o.id)),de+=t.dumpAttributes(o),d){de+=">";var f=e.optionlist.value,m=null!==e.optionnames&&void 0!==e.optionnames&&e.optionnames.value?e.optionnames.value:f;m&&m.length||t.fail("Error in component tree - UISelect component with fullID "+e.fullID+" does not have optionnames set");for(var g=0;g<m.length;++g)de+='<option value="',n=f[g],null===n&&(n=t.NULL_STRING),de+=t.XMLEncode(n),A(e,n)&&(de+='" selected="selected'),de+='">',de+=t.XMLEncode(m[g]),de+="</option>\n";S()}else E();O(e)}else if("UILink"===a){var h=p[i];if(h){q(e.target);var v=e.target.value;x(v)||(v=o[h]),v=I(ve.uselump.parent,v),o[h]=t.XMLEncode(v)}n=void 0,e.linktext&&(q(e.linktext),n=e.linktext.value),x(n)?R(n):L()}else if(void 0!==e.markup){q(e.markup);var b=e.markup.value;null===b?(de+=t.dumpAttributes(o),de+=">",C()):(ve.iselide||(de+=t.dumpAttributes(o),de+=">"),de+=b,S())}void 0!==o.id&&(ge[o.id]=!0)}function z(e){var t,r=ve.attrcopy.for;if(void 0!==r?t="for":void 0!==(r=ve.attrcopy.headers)&&(t="headers"),t){var n=ve.uselump.tagname;if(!("for"===t&&"label"!==n||"headers"===t&&"td"!==n&&"th"!==n)){var o=le[i(ve.uselump.parent,e,r)];void 0!==o&&(ve.attrcopy[t]=o)}}}function Q(e){de+="\x3c!-- "+t.XMLEncode(e)+"--\x3e"}function K(e){de+='<span style="background-color:#FF466B;color:white;padding:1px;">',de+=e,de+="</span><br/>"}function W(e){var t=e.fullID;return t?"full path "+t:"component tree root"}function $(t,r,n){var o=n.lumpindex,a=n.parent.lumps,i=-1,s=a[o+1],l=n.close_tag;i=l.lumpindex+1;var u=n.downmap?n.downmap["payload-component"]:null,c=u?u[0]:null,d=126===n.rsfID.charCodeAt(0),f=s,p=l,m=n,g={};if(e.extend(!0,g,(null===c?n:c).attributemap),ve.attrcopy=g,ve.uselump=m,ve.endopen=f,ve.close=p,ve.nextpos=i,ve.iselide=d,z(t),null===r&&n.rsfID.indexOf("scr=")===(d?1:0)){var v=n.rsfID.substring(4+(d?1:0));"ignore"===v?i=ve.close.lumpindex+1:"rewrite-url"===v?r={componentType:"UILink",target:{}}:(b(),L(),i=ve.endopen.lumpindex)}return null!==r&&(c&&(ve.endopen=a[c.lumpindex+1],ve.close=c.close_tag,ve.uselump=c,h(a,o,c.lumpindex),o=c.lumpindex),j(g,r),b(),H(r),null!==c&&ve.nextpos===i&&h(a,ve.close.lumpindex+1,l.lumpindex+1),i=ve.nextpos),i}function J(e,t){var r=t.parent,n=r.lumps[t.lumpindex+1];void 0!==e.children?U(e,t):$(e.parent,e,t),ye(e,t,n)}function Y(e,t){for(var r;e&&!(r=e.childmap[t]);)e=e.parent;return r}function Z(e,r){var n=t.SplitID(r.ID),o=e.downmap[r.ID];return o||(o=e.downmap[n.prefix+":"]),o?o[0]:null}function ee(e){h(e.parent.lumps,e.lumpindex,e.close_tag.lumpindex+1)}function te(){for(var e in ce)for(var t=ce[e],r=0;r<t.length;++r)ee(t[r])}function re(){for(var e=0;e<pe.length;++e)for(var r=pe[e],n=0;n<r.ids.length;++n){var a=r.ids[n],i=t.byId(a,fe.document);if(i||t.fail("Error during rendering - component with id "+a+" which has a queued decorator was not found in the output markup"),"jQuery"===r.type){var s=fe.jQuery(i);s[r.func].apply(s,t.makeArray(r.args))}else if("fluid"===r.type){var l=r.args;if(!l){var u=fe.jQuery(i);r.container?r.container.push(i):r.container=u,l=[u,r.options]}var d=c.invokeFluidDecorator(r.func,l,a,e,o);r.that=d}else"event"===r.type&&(i[r.event]=r.handler)}}o=o||{},n=n||{};var ne=o.debugMode;!o.messageLocator&&o.messageSource&&(o.messageLocator=t.resolveMessageSource(o.messageSource)),o.document=o.document||document,o.jQuery=o.jQuery||e,o.fossils=o.fossils||a||{};var oe,ae,ie={},se={},le={},ue={},ce={},de="",fe=o,pe=[],me={},ge={},he={options:o},ve={};ae=function(r,n,o,a){var i,s=function(e,r){null===e||void 0===e?delete o[r]:o[r]=t.XMLEncode(e)};fe.idMap=fe.idMap||{};for(var l=0;l<n.length;++l){var u=n[l],c=u.type;if(c)if("$"===c&&(c=u.type="jQuery"),"jQuery"===c||"event"===c||"fluid"===c)i=j(o,r,!0,a),void 0===u.ids&&(u.ids=[],pe[pe.length]=u),u.ids.push(i);else if("attrs"===c)t.each(u.attributes,s);else if("addClass"===c||"removeClass"===c){var d=e("<div>",{class:o.class})[0];fe.jQuery(d)[c](u.classes),o.class=d.className}else"identify"===c?(i=j(o,r,!0,a),fe.idMap[u.key]=i):"null"!==c&&t.log("Unrecognised decorator of type "+c+" found at component of ID "+a);else{var f=V(u);ae(r,f,o,a)}}};var ye;return oe=function(e,t){if(0===t.indexOf("msg=")){return{componentType:"UIMessage",messagekey:t.substring(4)}}for(;e;){var r=e.childmap[t];if(r)return r;e=e.parent}return null},ye=function(e,r,n){var o,a,i,s,l=n.lumpindex,u=r.nestingdepth,c=r.parent;for(ne&&(s={});;){if((l=v(c.lumps,l,u,!r.elide,!1))===c.lumps.length)break;var d=c.lumps[l],f=d.rsfID;if(d.nestingdepth<u||void 0===f)break;if(126===f.charCodeAt(0)&&(f=f.substring(1)),-1!==f.indexOf(":")){var p=t.getPrefix(f);o=Y(e,p);var m=d.uplump.finallump[p],g=m.close_tag;if(o)for(var h=0;h<o.length;++h)if(i=o[h],i.children)ne&&(s[i.fullID]=!0),a=se[i.fullID],a?(ne&&Q("Branching for "+i.fullID+" from "+t.debugLump(d)+" to "+t.debugLump(a)),J(i,a),ne&&Q("Branch returned for "+i.fullID+t.debugLump(d)+" to "+t.debugLump(a))):ne&&K("No matching template branch found for branch container with full ID "+i.fullID+" rendering from parent template branch "+t.debugLump(n));else{if(!(a=Z(r,i))){ne&&K("Repetitive leaf with full ID "+i.fullID+" could not be rendered from parent template branch "+t.debugLump(n));continue}var y=$(e,i,a),x=y<c.lumps.lengtn&&c.lumps[y].nestingdepth>=a.nestingdepth,b=i.children?i:e;x&&(ye(b,a,c.lumps[y]),y=a.close_tag.lumpindex+1),h!==o.length-1?y<g.lumpindex&&v(c.lumps,y,a.nestingdepth-1,!1,!1):v(c.lumps,y,a.nestingdepth,!0,!1)}else ne&&K("No branch container with prefix "+p+": found in container "+W(e)+" rendering at template position "+t.debugLump(n)+", skipping");l=g.lumpindex+1,ne&&Q("Stack returned from branch for ID "+f+" to "+t.debugLump(n)+": skipping from "+t.debugLump(d)+" to "+t.debugLump(g))}else{var S;f&&(S=oe(e,f,d),ne&&S&&(s[S.fullID]=!0)),S&&void 0!==S.children?(J(S),l=d.close_tag.lumpindex+1):l=$(e,S,d)}if(l===c.lumps.length)break}if(ne){o=e.children;for(var C=0;C<o.length;++C)i=o[C],s[i.fullID]||K("Component "+i.componentType+" with full ID "+i.fullID+" could not be found within template "+t.debugLump(n))}},he.renderTemplates=function(){n=l(n,o.model,o.resolverGetConfig);var e=r[0];return g(r.globalmap,n,e.rootlump),me={},te(),ye(n,e.rootlump,e.lumps[e.firstdocumentindex]),de},he.processDecoratorQueue=function(){re()},he},jQuery.extend(!0,t.renderer,c),t.ComponentReference=function(e){this.reference=e},t.explode=function(e,t){var r=[];for(var n in e){var o=void 0===t?n:t+"."+n;r[r.length]={ID:n,value:e[n],valuebinding:o}}return r},t.explodeSelectionToInputs=function(e,r){return t.transform(e,function(e,t){return{ID:r.rowID,children:[{ID:r.inputID,parentRelativeID:"..::"+r.selectID,choiceindex:t},{ID:r.labelID,parentRelativeID:"..::"+r.selectID,choiceindex:t}]}})},t.renderTemplates=function(e,r,n,o){return t.renderer(e,r,n,o).renderTemplates()},t.reRender=function(r,n,o,a){a=a||{};var i=t.renderer(r,o,a,a.fossils);a=i.options,n=t.unwrap(n);var s,l=t.getLastFocusedElement?t.getLastFocusedElement():null;l&&t.dom.isContainer(n,l)&&(s=l.id),e.browser.msie?a.jQuery(n).empty():n.innerHTML="";var u=i.renderTemplates();if(a.renderRaw&&(u=t.XMLEncode(u),u=u.replace(/\n/g,"<br/>")),a.model&&t.bindFossils(n,a.model,a.fossils),e.browser.msie?a.jQuery(n).html(u):n.innerHTML=u,i.processDecoratorQueue(),s){var c=t.byId(s,a.document);c&&a.jQuery(c).focus()}return r},t.extractTemplate=function(e,t){return t?u(e):e.innerHTML},t.render=function(e,r,n,o){o=o||{};var a=e;"object"==typeof e&&(a=t.extractTemplate(t.unwrap(e.node),e.armouring)),r=t.unwrap(r);var i={base:{resourceText:a,href:".",resourceKey:".",cutpoints:o.cutpoints}},s=t.parseTemplates(i,["base"],o);return t.reRender(s,r,n,o)},t.selfRender=function(e,r,n){return n=n||{},t.render({node:e,armouring:n.armouring},e,r,n)}}(jQuery,fluid_3_0_0),fluid_3_0_0=fluid_3_0_0||{},function(e,t){"use strict";t.renderer||t.fail("fluidRenderer.js is a necessary dependency of RendererUtilities"),t.renderer.visitDecorators=function(e,r){t.visitComponentChildren(e,function(e,n){0===n.indexOf(t.renderer.decoratorComponentPrefix)&&r(e,n)},{flat:!0},[])},t.renderer.clearDecorators=function(e){var r=t.getInstantiator(e);t.renderer.visitDecorators(e,function(t,n){r.clearComponent(e,n)})},t.renderer.getDecoratorComponents=function(e){var r={};return t.renderer.visitDecorators(e,function(e,t){r[t]=e}),r},t.renderer.modeliseOptions=function(r,n,o){return e.extend({},n,t.filterKeys(o,["model","applier"]),r)},t.renderer.reverseMerge=function(e,r,n){n=t.makeArray(n),t.each(n,function(t){void 0===e[t]&&void 0!==r[t]&&(e[t]=r[t])})},t.renderer.createRendererSubcomponent=function(r,n,o,a,i){o=o||{};var s=o.templateSource?o.templateSource:{node:e(r)},l=void 0===o.rendererOptions.model,u=t.renderer.modeliseOptions(o.rendererOptions,null,a);if(u.fossils=i||{},u.parentComponent=a,r.jquery){var c={document:r[0].ownerDocument,jQuery:r.constructor};t.renderer.reverseMerge(u,c,t.keys(c))}var d={},f=null;return d.render=function(i){var c=o.cutpointGenerator||"fluid.renderer.selectorsToCutpoints";u.cutpoints=u.cutpoints||t.invokeGlobalFunction(c,[n,o]),l&&(u.model=a.model);var d=e(o.renderTarget?o.renderTarget:r);f?(t.clear(u.fossils),t.reRender(f,d,i,u)):("function"==typeof s&&(s=s()),f=t.render(s,d,i,u))},d},t.defaults("fluid.rendererComponent",{gradeNames:["fluid.viewComponent"],initFunction:"fluid.initRendererComponent",mergePolicy:{"rendererOptions.idMap":"nomerge",protoTree:"noexpand, replace",parentBundle:"nomerge","changeApplierOptions.resolverSetConfig":"resolverSetConfig"},invokers:{refreshView:{funcName:"fluid.rendererComponent.refreshView",args:"{that}"},produceTree:{funcName:"fluid.rendererComponent.produceTree",args:"{that}"}},rendererOptions:{autoBind:!0},events:{onResourcesFetched:null,prepareModelForRender:null,onRenderTree:null,afterRender:null},listeners:{onCreate:{funcName:"fluid.rendererComponent.renderOnInit",args:["{that}.options.renderOnInit","{that}"],priority:"last"}}}),t.rendererComponent.renderOnInit=function(e,t){(e||t.renderOnInit)&&t.refreshView()},t.protoExpanderForComponent=function(e,r){var n=t.renderer.modeliseOptions(r.expanderOptions,{ELstyle:"${}"},e);return t.renderer.reverseMerge(n,r,["resolverGetConfig","resolverSetConfig"]),t.renderer.makeProtoExpander(n,e)},t.rendererComponent.refreshView=function(e){if(!e.renderer)return void(e.renderOnInit=!0);t.renderer.clearDecorators(e),e.events.prepareModelForRender.fire(e.model,e.applier,e);var r=e.produceTree(e),n=e.renderer.rendererFnOptions;if(!n.noexpand){r=t.protoExpanderForComponent(e,n)(r)}e.events.onRenderTree.fire(e,r),e.renderer.render(r),e.events.afterRender.fire(e)},t.rendererComponent.produceTree=function(e){var r=e.options.produceTree;return r?("string"==typeof r?t.getGlobalValue(r):r)(e):e.options.protoTree},t.initRendererComponent=function(r,n,o){var a=t.initView(r,n,o,{gradeNames:["fluid.rendererComponent"]});t.getForComponent(a,"model"),t.getForComponent(a,"applier"),t.diagnoseFailedView(r,a,t.defaults(r),arguments),t.fetchResources(a.options.resources,a.events.onResourcesFetched.fire);var i,s=t.renderer.modeliseOptions(a.options.rendererOptions,null,a);!s.messageSource&&a.options.strings&&(i=t.messageResolver({messageBase:a.options.strings,resolveFunc:a.options.messageResolverFunction,parents:t.makeArray(a.options.parentBundle)}),s.messageSource={type:"resolver",resolver:i}),t.renderer.reverseMerge(s,a.options,["resolverGetConfig","resolverSetConfig"]),a.rendererOptions=s;var l=e.extend({},a.options.rendererFnOptions,{rendererOptions:s,repeatingSelectors:a.options.repeatingSelectors,selectorsToIgnore:a.options.selectorsToIgnore,expanderOptions:{envAdd:{styles:a.options.styles}}});a.options.resources&&a.options.resources.template&&(l.templateSource=function(){return a.options.resources.template.resourceText}),t.renderer.reverseMerge(l,a.options,["resolverGetConfig","resolverSetConfig"]),l.rendererTargetSelector&&(n=function(){return a.dom.locate(l.rendererTargetSelector)});var u={fossils:{},rendererFnOptions:l,boundPathForNode:function(e){return t.boundPathForNode(e,u.fossils)}},c=t.renderer.createRendererSubcomponent(n,a.options.selectors,l,a,u.fossils);return a.renderer=e.extend(u,c),i&&(a.messageResolver=i),u.refreshView=t.getForComponent(a,"refreshView"),a};var r=function(e,r){return t.each(t.makeArray(r),function(t){delete e[t]}),e},n=function(e,r){return r&&t.each(r,function(t){e===t&&(e+=":")}),e};t.renderer.selectorsToCutpoints=function(e,o){var a=[];o=o||{},e=t.copy(e),o.selectorsToIgnore&&(e=r(e,o.selectorsToIgnore));for(var i in e)a.push({id:n(i,o.repeatingSelectors),selector:e[i]});return a},t.renderer.NO_COMPONENT={},t.renderer.mergeComponents=function(e,t){for(var r in t)e[r]=t[r];return e},t.registerNamespace("fluid.renderer.selection"),t.renderer.selection.inputs=function(e,r,n,o){t.expect("Selection to inputs expander",e,["selectID","inputID","labelID","rowID"]);var a=o.expander(e.tree),i=t.censorKeys(e,["tree"]),s=o.expandLight(i),l=t.transform(a.optionlist.value,function(e,r){var n={},o={parentRelativeID:"..::"+s.selectID,choiceindex:r};return n[s.inputID]=o,n[s.labelID]=t.copy(o),n}),u={};return u[s.selectID]=a,u[s.rowID]={children:l},u=o.expander(u)},t.renderer.repeat=function(e,r,n,o){t.expect("Repetition expander",e,["controlledBy","tree"]);var a=o.threadLocal(),i=t.extractContextualPath(e.controlledBy,{ELstyle:"ALL"},a),s=t.get(o.model,i,o.resolverGetConfig),l={};if(!s||0===s.length)return e.ifEmpty?o.expander(e.ifEmpty):l;var u=[];t.each(s,function(r,n){var s=t.model.composePath(i,n),l={};e.pathAs&&(l[e.pathAs]="${"+s+"}"),e.valueAs&&(l[e.valueAs]=t.get(o.model,s,o.resolverGetConfig));var c=t.withEnvironment(l,function(){return o.expander(e.tree)},a);t.isArrayable(c)?c.length>0&&u.push({children:c}):c!==t.renderer.NO_COMPONENT&&u.push(c)});var c=e.repeatID;return-1===c.indexOf(":")&&(c+=":"),t.each(u,function(e){e.ID=c}),u},t.renderer.condition=function(e,r,n,o){t.expect("Selection to condition expander",e,["condition"]);var a;if(e.condition.funcName){var i=o.expandLight(e.condition.args);a=t.invokeGlobalFunction(e.condition.funcName,i)}else a=e.condition.expander?o.expander(e.condition):o.expandLight(e.condition);var s=a?e.trueTree:e.falseTree;return s||(s=t.renderer.NO_COMPONENT),o.expander(s)},t.extractContextualPath=function(e,r,n,o){var a=t.extractELWithContext(e,r);if(a)return a.context?n[a.context]?t.transformContextPath(a,n).path:{value:o(a)}:a.path},t.transformContextPath=function(e,r){if(e.context){var n,o=r[e.context];if("string"==typeof o&&(n=t.extractEL(o,{ELstyle:"${}"})),n)return{noDereference:""===e.path,path:t.model.composePath(n,e.path)}}return e},t.renderer.makeExternalFetcher=function(e){return function(r){var n=t.resolveContext(r.context,e);return n?t.getForComponent(n,r.path):void 0}},t.renderer.makeProtoExpander=function(r,n){function o(e){var r=s();return t.extractContextualPath(e,i,r,i.externalFetcher)}function a(e){return!1!==t.find(e,function(e,t){return"decorators"===t})}var i=e.extend({ELstyle:"${}"},r);n&&(i.externalFetcher=t.renderer.makeExternalFetcher(n));var s,l=i.IDescape||"\\",u=function(e){return t.expand(e,i)},c=function(r,n){if(void 0!==r.messagekey)return{componentType:"UIMessage",messagekey:c(r.messagekey),args:u(r.args)};var a;t.isPrimitive(r)||t.isArrayable(r)?a={}:(a=e.extend({},r),a.decorators&&(a.decorators=u(a.decorators)),r=a.value,delete a.value);var s;if("string"==typeof r){var l=o(r);s="string"==typeof l?l:null,r=t.get(l,"value")||r}return s?a.valuebinding=s:void 0!==r&&(a.value=r),i.model&&a.valuebinding&&void 0===a.value&&(a.value=t.get(i.model,a.valuebinding,i.resolverGetConfig)),n&&(a.componentType="UIBound"),a};i.filter=t.expander.lightFilter;var d,f,p=function(e){var t=[];return d(e,t),{children:t}},m=function(e){if(e===t.renderer.NO_COMPONENT)return e;var r,n=[];return f(e,n,function(e){r=e}),r||n},g={model:i.model,resolverGetConfig:i.resolverGetConfig,resolverSetConfig:i.resolverSetConfig,expander:m,expandLight:u},h=function(e,r){var n={componentType:r},o=t.renderer.boundMap[r]||{};for(var a in e)/decorators|args/.test(a)?n[a]=u(e[a]):n[a]=o[a]?c(e[a]):e[a];return n},v=function(e,t){for(var r=e.children,n=0;n<r.length;++n){var o=[],a={children:o},i=r[n];f(i,o,function(e){o[o.length]=e}),1!==a.children.length||a.children[0].ID||(a=a.children[0]),t(a)}};return f=function(e,r,n){var o=t.renderer.inferComponentType(e);o||!t.isPrimitive(e)&&!a(e)||(o="UIBound"),o?n("UIBound"===o?c(e,!0):h(e,o)):(r||t.fail("Illegal cond->cond transition"),d(e,r))},d=function(e,r){var n,o=function(o){var a=t.invokeGlobalFunction(o.type,[o,e,n,g]);a!==t.renderer.NO_COMPONENT&&t.each(a,function(e){r[r.length]=e})},a=function(e){e.ID=n,r[r.length]=e};for(n in e){var i=e[n];if(n.charAt(0)===l&&(n=n.substring(1)),"expander"===n){var s=t.makeArray(i);t.each(s,o)}else i&&(i.children?(-1===n.indexOf(":")&&(n+=":"),v(i,a)):t.renderer.isBoundPrimitive(i)?a(c(i,!0)):f(i,null,a))}},function(r){return s=t.threadLocal(function(){return e.extend({},i.envAdd)}),i.fetcher=t.makeEnvironmentFetcher(i.model,t.transformContextPath,s,i.externalFetcher),g.threadLocal=s,p(r)}}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.slidingPanel",{gradeNames:["fluid.viewComponent"],selectors:{panel:".flc-slidingPanel-panel",toggleButton:".flc-slidingPanel-toggleButton",toggleButtonLabel:".flc-slidingPanel-toggleButton"},strings:{showText:"show",hideText:"hide",panelLabel:"panel"},events:{onPanelHide:null,onPanelShow:null,afterPanelHide:null,afterPanelShow:null},listeners:{"onCreate.bindClick":{this:"{that}.dom.toggleButton",method:"click",args:["{that}.togglePanel"]},"onCreate.bindModelChange":{listener:"{that}.applier.modelChanged.addListener",args:["isShowing","{that}.refreshView"]},"onCreate.setAriaProps":"{that}.setAriaProps","onCreate.setInitialState":{listener:"{that}.refreshView"},"onPanelHide.setText":{this:"{that}.dom.toggleButtonLabel",method:"text",args:["{that}.options.strings.showText"],priority:"first"},"onPanelHide.setAriaLabel":{this:"{that}.dom.toggleButtonLabel",method:"attr",args:["aria-label","{that}.options.strings.showTextAriaLabel"]},"onPanelShow.setText":{this:"{that}.dom.toggleButtonLabel",method:"text",args:["{that}.options.strings.hideText"],priority:"first"},"onPanelShow.setAriaLabel":{this:"{that}.dom.toggleButtonLabel",method:"attr",args:["aria-label","{that}.options.strings.hideTextAriaLabel"]},"onPanelHide.operate":{listener:"{that}.operateHide"},"onPanelShow.operate":{listener:"{that}.operateShow"},"onCreate.setAriaStates":"{that}.setAriaStates"},members:{panelId:{expander:{funcName:"fluid.allocateSimpleId",args:"{that}.dom.panel"}}},model:{isShowing:!1},modelListeners:{isShowing:{funcName:"{that}.setAriaStates",excludeSource:"init"}},invokers:{operateHide:{this:"{that}.dom.panel",method:"slideUp",args:["{that}.options.animationDurations.hide","{that}.events.afterPanelHide.fire"]},operateShow:{this:"{that}.dom.panel",method:"slideDown",args:["{that}.options.animationDurations.show","{that}.events.afterPanelShow.fire"]},hidePanel:{func:"{that}.applier.change",args:["isShowing",!1]},showPanel:{func:"{that}.applier.change",args:["isShowing",!0]},setAriaStates:{funcName:"fluid.slidingPanel.setAriaStates",args:["{that}","{that}.model.isShowing"]},setAriaProps:{funcName:"fluid.slidingPanel.setAriaProperties",args:["{that}","{that}.panelId"]},togglePanel:{funcName:"fluid.slidingPanel.togglePanel",args:["{that}"]},refreshView:{funcName:"fluid.slidingPanel.refreshView",args:["{that}"]}},animationDurations:{hide:400,show:400}}),t.slidingPanel.togglePanel=function(e){e.applier.change("isShowing",!e.model.isShowing)},t.slidingPanel.refreshView=function(e){e.events[e.model.isShowing?"onPanelShow":"onPanelHide"].fire()},t.slidingPanel.setAriaProperties=function(e,t){e.locate("toggleButton").attr({role:"button","aria-controls":t}),e.locate("panel").attr({"aria-label":e.options.strings.panelLabel,role:"group"})},t.slidingPanel.setAriaStates=function(e,t){e.locate("toggleButton").attr("aria-pressed",t),e.locate("panel").attr("aria-expanded",t)}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.textfield",{gradeNames:["fluid.viewComponent"],attrs:{},strings:{},modelListeners:{value:{this:"{that}.container",method:"val",args:["{change}.value"]}},listeners:{"onCreate.bindChangeEvt":{this:"{that}.container",method:"change",args:["{that}.setModel"]},"onCreate.initTextfieldAttributes":{this:"{that}.container",method:"attr",args:["{that}.options.attrs"]}},invokers:{setModel:{changePath:"value",value:"{arguments}.0.target.value"}}}),t.textfield.setModelRestrictToNumbers=function(e,t,r){!isNaN(Number(t))&&e.applier.change(r,t),e.container.val(e.model.value)},t.defaults("fluid.textfield.rangeController",{gradeNames:["fluid.textfield"],components:{controller:{type:"fluid.modelComponent",options:{model:{value:null},modelRelay:[{source:"value",target:"{fluid.textfield}.model.value",singleTransform:{type:"fluid.transforms.numberToString",scale:"{that}.options.scale"}},{target:"value",singleTransform:{type:"fluid.transforms.limitRange",input:"{that}.model.value",min:"{that}.model.range.min",max:"{that}.model.range.max"}}]}}},invokers:{setModel:{funcName:"fluid.textfield.setModelRestrictToNumbers",args:["{that}","{arguments}.0.target.value","value"]}}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.textfieldSlider",{gradeNames:["fluid.viewComponent"],components:{textfield:{type:"fluid.textfield.rangeController",container:"{that}.dom.textfield",options:{components:{controller:{options:{model:"{textfieldSlider}.model"}}},attrs:"{textfieldSlider}.options.attrs",strings:"{textfieldSlider}.options.strings"}},slider:{type:"fluid.slider",container:"{textfieldSlider}.dom.slider",options:{model:"{textfieldSlider}.model",attrs:"{textfieldSlider}.options.attrs",strings:"{textfieldSlider}.options.strings"}}},selectors:{textfield:".flc-textfieldSlider-field",slider:".flc-textfieldSlider-slider"},styles:{container:"fl-textfieldSlider fl-focus"},model:{value:null,step:1,range:{min:0,max:100}},modelRelay:{target:"value",singleTransform:{type:"fluid.transforms.limitRange",input:"{that}.model.value",min:"{that}.options.range.min",max:"{that}.options.range.max"}},attrs:{},strings:{},listeners:{"onCreate.addContainerStyle":{this:"{that}.container",method:"addClass",args:["{that}.options.styles.container"]}},distributeOptions:[{source:"{that}.options.scale",target:"{that > fluid.textfield > controller}.options.scale"}]}),t.defaults("fluid.slider",{gradeNames:["fluid.viewComponent"],modelRelay:{target:"value",singleTransform:{type:"fluid.transforms.stringToNumber",input:"{that}.model.stringValue"}},invokers:{setModel:{changePath:"stringValue",value:{expander:{this:"{that}.container",method:"val"}}},updateSliderAttributes:{this:"{that}.container",method:"attr",args:[{min:"{that}.model.range.min",max:"{that}.model.range.max",step:"{that}.model.step",
type:"range",value:"{that}.model.value","aria-labelledby":"{that}.options.attrs.aria-labelledby","aria-label":"{that}.options.attrs.aria-label"}]}},listeners:{"onCreate.initSliderAttributes":"{that}.updateSliderAttributes","onCreate.bindSlideEvt":{this:"{that}.container",method:"on",args:["input","{that}.setModel"]},"onCreate.bindRangeChangeEvt":{this:"{that}.container",method:"on",args:["change","{that}.setModel"]}},modelListeners:{value:[{this:"{that}.container",method:"val",args:["{change}.value"],excludeSource:"init"}],range:{listener:"{that}.updateSliderAttributes",excludeSource:"init"},step:{listener:"{that}.updateSliderAttributes",excludeSource:"init"}}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.textfieldStepper",{gradeNames:["fluid.viewComponent"],strings:{increaseLabel:"increment",decreaseLabel:"decrement"},selectors:{textfield:".flc-textfieldStepper-field",focusContainer:".flc-textfieldStepper-focusContainer",increaseButton:".flc-textfieldStepper-increase",decreaseButton:".flc-textfieldStepper-decrease"},styles:{container:"fl-textfieldStepper",focus:"fl-textfieldStepper-focus"},components:{textfield:{type:"fluid.textfield.rangeController",container:"{that}.dom.textfield",options:{components:{controller:{options:{model:"{textfieldStepper}.model",modelListeners:{"range.min":{this:"{textfield}.container",method:"attr",args:["aria-valuemin","{change}.value"]},"range.max":{this:"{textfield}.container",method:"attr",args:["aria-valuemax","{change}.value"]}}}}},attrs:"{textfieldStepper}.options.attrs",strings:"{textfieldStepper}.options.strings",listeners:{"onCreate.bindUpArrow":{listener:"fluid.textfieldStepper.bindKeyEvent",args:["{that}.container","keydown",38,"{textfieldStepper}.increase"]},"onCreate.bindDownArrow":{listener:"fluid.textfieldStepper.bindKeyEvent",args:["{that}.container","keydown",40,"{textfieldStepper}.decrease"]},"onCreate.addRole":{this:"{that}.container",method:"attr",args:["role","spinbutton"]}},modelListeners:{value:{this:"{that}.container",method:"attr",args:["aria-valuenow","{change}.value"]}}}},increaseButton:{type:"fluid.textfieldStepper.button",container:"{textfieldStepper}.dom.increaseButton",options:{strings:{label:"{textfieldStepper}.options.strings.increaseLabel"},listeners:{"onClick.increase":"{textfieldStepper}.increase"},modelRelay:{target:"disabled",singleTransform:{type:"fluid.transforms.binaryOp",left:"{textfieldStepper}.model.value",right:"{textfieldStepper}.model.range.max",operator:">="}}}},decreaseButton:{type:"fluid.textfieldStepper.button",container:"{textfieldStepper}.dom.decreaseButton",options:{strings:{label:"{textfieldStepper}.options.strings.decreaseLabel"},listeners:{"onClick.decrease":"{textfieldStepper}.decrease"},modelRelay:{target:"disabled",singleTransform:{type:"fluid.transforms.binaryOp",left:"{textfieldStepper}.model.value",right:"{textfieldStepper}.model.range.min",operator:"<="}}}}},invokers:{increase:{funcName:"fluid.textfieldStepper.step",args:["{that}"]},decrease:{funcName:"fluid.textfieldStepper.step",args:["{that}",-1]},addFocus:{this:"{that}.dom.focusContainer",method:"addClass",args:["{that}.options.styles.focus"]},removeFocus:{this:"{that}.dom.focusContainer",method:"removeClass",args:["{that}.options.styles.focus"]}},listeners:{"onCreate.addContainerStyle":{this:"{that}.container",method:"addClass",args:["{that}.options.styles.container"]},"onCreate.bindFocusin":{this:"{that}.container",method:"on",args:["focusin","{that}.addFocus"]},"onCreate.bindFocusout":{this:"{that}.container",method:"on",args:["focusout","{that}.removeFocus"]}},model:{value:null,step:1,range:{min:0,max:100}},attrs:{},distributeOptions:[{source:"{that}.options.scale",target:"{that > fluid.textfield > controller}.options.scale"}]}),t.textfieldStepper.step=function(e,t){t=t||1;var r=e.model.value+t*e.model.step;e.applier.change("value",r)},t.textfieldStepper.bindKeyEvent=function(t,r,n,o){e(t).on(r,function(e){e.which===n&&(o(),e.preventDefault())})},t.defaults("fluid.textfieldStepper.button",{gradeNames:["fluid.viewComponent"],strings:{},styles:{container:"fl-textfieldStepper-button"},model:{disabled:!1},events:{onClick:null},listeners:{"onCreate.bindClick":{this:"{that}.container",method:"click",args:"{that}.events.onClick.fire"},"onCreate.addLabel":{this:"{that}.container",method:"attr",args:["aria-label","{that}.options.strings.label"]},"onCreate.addContainerStyle":{this:"{that}.container",method:"addClass",args:["{that}.options.styles.container"]},"onCreate.removeFromTabOrder":{this:"{that}.container",method:"attr",args:["tabindex","-1"]}},modelListeners:{disabled:{this:"{that}.container",method:"prop",args:["disabled","{change}.value"]}}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.switchUI",{gradeNames:["fluid.viewComponent"],selectors:{on:".flc-switchUI-on",off:".flc-switchUI-off",control:".flc-switchUI-control"},strings:{label:"",on:"on",off:"off"},attrs:{role:"switch",tabindex:0},model:{enabled:!1},modelListeners:{enabled:{this:"{that}.dom.control",method:"attr",args:["aria-checked","{change}.value"]}},listeners:{"onCreate.addAttrs":{this:"{that}.dom.control",method:"attr",args:["{that}.options.attrs"]},"onCreate.addOnText":{this:"{that}.dom.on",method:"text",args:["{that}.options.strings.on"]},"onCreate.addOffText":{this:"{that}.dom.off",method:"text",args:["{that}.options.strings.off"]},"onCreate.activateable":{listener:"fluid.activatable",args:["{that}.dom.control","{that}.activateHandler"]},"onCreate.bindClick":{this:"{that}.dom.control",method:"on",args:["click","{that}.toggleModel"]}},invokers:{toggleModel:{funcName:"fluid.switchUI.toggleModel",args:["{that}"]},activateHandler:{funcName:"fluid.switchUI.activateHandler",args:["{arguments}.0","{that}.toggleModel"]}}}),t.switchUI.toggleModel=function(e){e.applier.change("enabled",!e.model.enabled)},t.switchUI.activateHandler=function(e,t){e.preventDefault(),t()}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.tableOfContents"),t.tableOfContents.headingTextToAnchorInfo=function(e){var r=t.allocateSimpleId(e);return{id:r,url:"#"+r}},t.tableOfContents.locateHeadings=function(e){var r=e.locate("headings");return t.each(e.options.ignoreForToC,function(e){r=r.not(e).not(e+" :header")}),r},t.tableOfContents.refreshView=function(e){var r=e.locateHeadings();e.anchorInfo=t.transform(r,function(t){return e.headingTextToAnchorInfo(t)});var n=e.modelBuilder.assembleModel(r,e.anchorInfo);e.applier.change("",n),e.events.onRefresh.fire()},t.defaults("fluid.tableOfContents",{gradeNames:["fluid.viewComponent"],components:{levels:{type:"fluid.tableOfContents.levels",createOnEvent:"onCreate",container:"{tableOfContents}.dom.tocContainer",options:{model:{headings:"{tableOfContents}.model"},events:{afterRender:"{tableOfContents}.events.afterRender"},listeners:{"{tableOfContents}.events.onRefresh":"{that}.refreshView"},strings:"{tableOfContents}.options.strings"}},modelBuilder:{type:"fluid.tableOfContents.modelBuilder"}},model:[],invokers:{headingTextToAnchorInfo:"fluid.tableOfContents.headingTextToAnchorInfo",locateHeadings:{funcName:"fluid.tableOfContents.locateHeadings",args:["{that}"]},refreshView:{funcName:"fluid.tableOfContents.refreshView",args:["{that}"]},hide:{this:"{that}.dom.tocContainer",method:"hide"},show:{this:"{that}.dom.tocContainer",method:"show"}},strings:{tocHeader:"Table of Contents"},selectors:{headings:":header:visible",tocContainer:".flc-toc-tocContainer"},ignoreForToC:{tocContainer:"{that}.options.selectors.tocContainer"},events:{onRefresh:null,afterRender:null,onReady:{events:{onCreate:"onCreate",afterRender:"afterRender"},args:["{that}"]}},listeners:{"onCreate.refreshView":"{that}.refreshView"}}),t.registerNamespace("fluid.tableOfContents.modelBuilder"),t.tableOfContents.modelBuilder.toModel=function(e,r){var n=t.copy(e),o=function(e,t){for(var n=[];e.length>0;){var a=e[0];if(a.level<t)break;if(a.level>t){var i=o(e,t+1);n.length>0?n[n.length-1].headings=i:n=r(n,i)}a.level===t&&(n.push(a),e.shift())}return n};return o(n,1)},t.tableOfContents.modelBuilder.gradualModelLevelFn=function(e,r){var n=t.copy(r);return n[0].level--,n},t.tableOfContents.modelBuilder.skippedModelLevelFn=function(e,t){return e.push({headings:t}),e},t.tableOfContents.modelBuilder.convertToHeadingObjects=function(r,n,o){return n=e(n),t.transform(n,function(t,n){return{level:r.headingCalculator.getHeadingLevel(t),text:e(t).text(),url:o[n].url}})},t.tableOfContents.modelBuilder.assembleModel=function(e,t,r){var n=e.convertToHeadingObjects(t,r);return e.toModel(n)},t.defaults("fluid.tableOfContents.modelBuilder",{gradeNames:["fluid.component"],components:{headingCalculator:{type:"fluid.tableOfContents.modelBuilder.headingCalculator"}},invokers:{toModel:{funcName:"fluid.tableOfContents.modelBuilder.toModel",args:["{arguments}.0","{modelBuilder}.modelLevelFn"]},modelLevelFn:"fluid.tableOfContents.modelBuilder.gradualModelLevelFn",convertToHeadingObjects:"fluid.tableOfContents.modelBuilder.convertToHeadingObjects({that}, {arguments}.0, {arguments}.1)",assembleModel:"fluid.tableOfContents.modelBuilder.assembleModel({that}, {arguments}.0, {arguments}.1)"}}),t.registerNamespace("fluid.tableOfContents.modelBuilder.headingCalculator"),t.tableOfContents.modelBuilder.headingCalculator.getHeadingLevel=function(e,t){return e.options.levels.indexOf(t.tagName)+1},t.defaults("fluid.tableOfContents.modelBuilder.headingCalculator",{gradeNames:["fluid.component"],invokers:{getHeadingLevel:"fluid.tableOfContents.modelBuilder.headingCalculator.getHeadingLevel({that}, {arguments}.0)"},levels:["H1","H2","H3","H4","H5","H6"]}),t.registerNamespace("fluid.tableOfContents.levels"),t.tableOfContents.levels.objModel=function(e,t){return{ID:e+t+":",children:[]}},t.tableOfContents.levels.handleEmptyItemObj=function(e){e.decorators=[{type:"addClass",classes:"fl-tableOfContents-hide-bullet"}]},t.tableOfContents.levels.generateTree=function(r,n){n=n||0;var o=t.tableOfContents.levels.objModel("level",n);if(0===r.headings.length)return n?[]:{children:[]};if(0===n){return{children:[t.tableOfContents.levels.generateTree(r,n+1)]}}return e.each(r.headings,function(e,r){var a=t.tableOfContents.levels.objModel("items",n),i={ID:"link"+n,target:r.url,linktext:r.text};r.level?a.children.push(i):t.tableOfContents.levels.handleEmptyItemObj(a),r.headings&&a.children.push(t.tableOfContents.levels.generateTree(r,n+1)),o.children.push(a)}),o},t.tableOfContents.levels.produceTree=function(e){var r=t.tableOfContents.levels.generateTree(e.model);return r.children.push({ID:"tocHeader",messagekey:"tocHeader"}),r},t.tableOfContents.levels.fetchResources=function(e){t.fetchResources(e.options.resources,function(){e.container.append(e.options.resources.template.resourceText),e.refreshView()})},t.defaults("fluid.tableOfContents.levels",{gradeNames:["fluid.rendererComponent"],produceTree:"fluid.tableOfContents.levels.produceTree",strings:{tocHeader:"Table of Contents"},selectors:{tocHeader:".flc-toc-header",level1:".flc-toc-levels-level1",level2:".flc-toc-levels-level2",level3:".flc-toc-levels-level3",level4:".flc-toc-levels-level4",level5:".flc-toc-levels-level5",level6:".flc-toc-levels-level6",items1:".flc-toc-levels-items1",items2:".flc-toc-levels-items2",items3:".flc-toc-levels-items3",items4:".flc-toc-levels-items4",items5:".flc-toc-levels-items5",items6:".flc-toc-levels-items6",link1:".flc-toc-levels-link1",link2:".flc-toc-levels-link2",link3:".flc-toc-levels-link3",link4:".flc-toc-levels-link4",link5:".flc-toc-levels-link5",link6:".flc-toc-levels-link6"},repeatingSelectors:["level1","level2","level3","level4","level5","level6","items1","items2","items3","items4","items5","items6"],model:{headings:[]},listeners:{"onCreate.fetchResources":"fluid.tableOfContents.levels.fetchResources"},resources:{template:{forceCache:!0,url:"../html/TableOfContents.html"}},rendererFnOptions:{noexpand:!0},rendererOptions:{debugMode:!1}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.textToSpeech"),t.textToSpeech.isSupported=function(){return!(!window||!window.speechSynthesis)},t.textToSpeech.checkTTSSupport=function(e){var r=t.promise();if(t.textToSpeech.isSupported()){var n=new SpeechSynthesisUtterance("short");n.volume=0;var o=setTimeout(function(){t.textToSpeech.deferredSpeechSynthesisControl("cancel"),r.reject()},e||5e3);n.onend=function(){clearTimeout(o),t.textToSpeech.deferredSpeechSynthesisControl("cancel"),r.resolve()},t.textToSpeech.deferredSpeechSynthesisControl("speak",n)}else setTimeout(r.reject,0);return r},t.defaults("fluid.textToSpeech",{gradeNames:["fluid.modelComponent"],events:{onStart:null,onStop:null,onError:null,onSpeechQueued:null},members:{queue:[]},model:{utteranceOpts:{}},modelListeners:{speaking:{listener:"fluid.textToSpeech.speak",args:["{that}","{change}.value"]},pauseRequested:{listener:"fluid.textToSpeech.requestControl",args:["{that}","pause","{change}"]},resumeRequested:{listener:"fluid.textToSpeech.requestControl",args:["{that}","resume","{change}"]}},invokers:{queueSpeech:{funcName:"fluid.textToSpeech.queueSpeech",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]},cancel:{funcName:"fluid.textToSpeech.cancel",args:["{that}"]},pause:{changePath:"pauseRequested",value:!0},resume:{changePath:"resumeRequested",value:!0},getVoices:{this:"speechSynthesis",method:"getVoices"},handleStart:{changePath:"speaking",value:!0},handleEnd:{funcName:"fluid.textToSpeech.handleEnd",args:["{that}"]},handleError:"{that}.events.onError.fire",handlePause:{changePath:"paused",value:!0},handleResume:{changePath:"paused",value:!1}}}),t.textToSpeech.deferredSpeechSynthesisControl=function(e,t){setTimeout(function(){speechSynthesis[e](t)},1)},t.textToSpeech.throttle=function(e,t,r){var n,o,a,i,s=0;r||(r={});var l=function(){s=!1===r.leading?0:(new Date).getTime(),n=null,i=e.apply(o,a),n||(o=a=null)},u=function(){var u=(new Date).getTime();s||!1!==r.leading||(s=u);var c=t-(u-s);return o=this,a=arguments,c<=0||c>t?(n&&(clearTimeout(n),n=null),s=u,i=e.apply(o,a),n||(o=a=null)):n||!1===r.trailing||(n=setTimeout(l,c)),i};return u.cancel=function(){clearTimeout(n),s=0,n=o=a=null},u},t.textToSpeech.throttleControl=t.textToSpeech.throttle(t.textToSpeech.deferredSpeechSynthesisControl,100,{leading:!1}),t.textToSpeech.speak=function(e,t){e.events[t?"onStart":"onStop"].fire()},t.textToSpeech.requestControl=function(e,r,n){n.value&&(e.applier.change(n.path,!1),t.textToSpeech.throttleControl(r))},t.textToSpeech.handleEnd=function(t){t.queue.shift();var r={speaking:!1,pending:!1,paused:!1};if(t.queue.length)t.applier.change("pending",!0);else if(!t.queue.length){var n=e.extend({},t.model,r);t.applier.change("",n)}},t.textToSpeech.queueSpeech=function(r,n,o,a){o&&r.cancel();var i=function(){r.handleError(n)},s=new SpeechSynthesisUtterance(n),l={onstart:r.handleStart,onend:r.handleEnd,onerror:i,onpause:r.handlePause,onresume:r.handleResume};e.extend(s,r.model.utteranceOpts,a,l),r.queue.push({text:n,utterance:s}),r.events.onSpeechQueued.fire(n),t.textToSpeech.deferredSpeechSynthesisControl("speak",s)},t.textToSpeech.cancel=function(e){e.queue=[],t.textToSpeech.deferredSpeechSynthesisControl("cancel")}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.url"),t.url.generateDepth=function(e){return t.generate(e,"../").join("")},t.url.parsePathInfo=function(e){var t={},r=e.split("/");if(r.length>0){var n=r.length-1,o=r[n].indexOf(".");-1!==o&&(t.extension=r[n].substring(o+1),r[n]=r[n].substring(0,o))}return t.pathInfo=r,t},t.url.parsePathInfoTrim=function(e){var r=t.url.parsePathInfo(e);return""===r.pathInfo[r.pathInfo.length-1]&&r.pathInfo.length--,r},t.url.collapseSegs=function(e,t,r){var n="";void 0===t&&(t=0),void 0===r&&(r=e.length);for(var o=t;o<r-1;++o)n+=e[o]+"/";return r>t&&(n+=e[r-1]),n},t.url.makeRelPath=function(e,r){var n=t.kettle.collapseSegs(e.pathInfo,r);return e.extension&&(n+="."+e.extension),n},t.url.cononocolosePath=function(e){for(var t=0,r=0;r<e.length;++r)".."===e[r]?++t:0!==t&&(e.splice(r-2*t,2*t),r-=2*t,t=0);return e},t.url.parseUri=function(e){for(var r=t.url.parseUri.options,n=r.parser[r.strictMode?"strict":"loose"].exec(e),o={},a=14;a--;)o[r.key[a]]=n[a]||"";return o[r.q.name]={},o[r.key[12]].replace(r.q.parser,function(e,t,n){t&&(o[r.q.name][t]=n)}),o},t.url.parseUri.options={strictMode:!0,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},t.url.parseSegs=function(e){var r=t.url.parseUri(e);return t.url.parsePathInfoTrim(r.directory).pathInfo},t.url.isAbsoluteUrl=function(e){var r=t.url.parseUri(e);return r.host||r.protocol||"/"===r.directory.charAt(0)},t.url.computeRelativePrefix=function(e,r,n){if(t.url.isAbsoluteUrl(n))return n;var o=t.url.parsePathInfo(n).pathInfo,a=t.url.parseSegs(e),i=a.concat(o);t.url.cononocolosePath(i);for(var s=t.url.parseSegs(r),l=0;l<i.length&&i[l]===s[l];++l);var u=s.length-l;return t.url.generateDepth(u)+t.url.collapseSegs(i,l)}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.store",{gradeNames:["fluid.dataSource","fluid.contextAware"],contextAwareness:{strategy:{defaultGradeNames:"fluid.prefs.cookieStore"}}}),t.prefs.store.decodeURIComponent=function(e){if("string"==typeof e)return decodeURIComponent(e)},t.prefs.store.encodeURIComponent=function(e){if("string"==typeof e)return encodeURIComponent(e)},t.defaults("fluid.prefs.cookieStore",{gradeNames:["fluid.dataSource"],cookie:{name:"fluid-ui-settings",path:"/",expires:""},listeners:{"onRead.impl":{listener:"fluid.prefs.cookieStore.getCookie",args:["{arguments}.1"]},"onRead.decodeURI":{listener:"fluid.prefs.store.decodeURIComponent",priority:"before:encoding"}},invokers:{get:{args:["{that}","{arguments}.0","{that}.options.cookie"]}}}),t.defaults("fluid.prefs.cookieStore.writable",{gradeNames:["fluid.dataSource.writable"],listeners:{"onWrite.encodeURI":{func:"fluid.prefs.store.encodeURIComponent",priority:"before:impl"},"onWrite.impl":{listener:"fluid.prefs.cookieStore.writeCookie"},"onWriteResponse.decodeURI":{listener:"fluid.prefs.store.decodeURIComponent",priority:"before:encoding"}},invokers:{set:{args:["{that}","{arguments}.0","{arguments}.1","{that}.options.cookie"]}}}),t.makeGradeLinkage("fluid.prefs.cookieStore.linkage",["fluid.dataSource.writable","fluid.prefs.cookieStore"],"fluid.prefs.cookieStore.writable"),t.prefs.cookieStore.getCookie=function(e){var r=t.get(e,["directModel","cookieName"])||e.name,n=document.cookie;if(!(n.length<=0)){var o=r+"=",a=n.indexOf(o);if(!(a<0)){a+=o.length;var i=n.indexOf(";",a);return i<a&&(i=n.length),n.substring(a,i)}}},t.prefs.cookieStore.assembleCookie=function(e,t,r){r=r||{};var n=e+"="+t;return r.expires&&(n+="; expires="+r.expires),r.path&&(n+="; path="+r.path),n},t.prefs.cookieStore.writeCookie=function(e,r){var n=t.get(r,["directModel","cookieName"])||r.name,o=t.prefs.cookieStore.assembleCookie(n,e,r);return document.cookie=o,e},t.defaults("fluid.dataSource.encoding.model",{gradeNames:"fluid.component",invokers:{parse:"fluid.identity",render:"fluid.identity"},contentType:"application/json"}),t.defaults("fluid.prefs.tempStore",{gradeNames:["fluid.dataSource","fluid.modelComponent"],components:{encoding:{type:"fluid.dataSource.encoding.model"}},listeners:{"onRead.impl":{listener:"fluid.identity",args:["{that}.model"]}}}),t.defaults("fluid.prefs.tempStore.writable",{gradeNames:["fluid.dataSource.writable","fluid.modelComponent"],components:{encoding:{type:"fluid.dataSource.encoding.model"}},listeners:{"onWrite.impl":{listener:"fluid.prefs.tempStore.write",args:["{that}","{arguments}.0","{arguments}.1"]}}}),t.prefs.tempStore.write=function(e,t){var r=e.applier.initiate();return r.fireChangeRequest({path:"",type:"DELETE"}),r.change("",t),r.commit(),e.model},t.makeGradeLinkage("fluid.prefs.tempStore.linkage",["fluid.dataSource.writable","fluid.prefs.tempStore"],"fluid.prefs.tempStore.writable"),t.defaults("fluid.prefs.globalSettingsStore",{gradeNames:["fluid.component"],components:{settingsStore:{type:"fluid.prefs.store",options:{gradeNames:["fluid.resolveRootSingle","fluid.dataSource.writable"],singleRootType:"fluid.prefs.store"}}}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.initialModel",{gradeNames:["fluid.component"],members:{initialModel:{preferences:{}}}}),t.defaults("fluid.uiEnhancer",{gradeNames:["fluid.viewComponent"],invokers:{updateModel:{func:"{that}.applier.change",args:["","{arguments}.0"]}},userGrades:"@expand:fluid.prefs.filterEnhancerGrades({that}.options.gradeNames)"}),t.defaults("fluid.uiEnhancer.root",{gradeNames:["fluid.uiEnhancer","fluid.resolveRootSingle"],singleRootType:"fluid.uiEnhancer"}),t.uiEnhancer.ignorableGrades=["fluid.uiEnhancer","fluid.uiEnhancer.root","fluid.resolveRoot","fluid.resolveRootSingle"],t.prefs.filterEnhancerGrades=function(e){return t.remove_if(t.makeArray(e),function(e){return-1!==t.frameworkGrades.indexOf(e)||-1!==t.uiEnhancer.ignorableGrades.indexOf(e)})},t.prefs.filterEnhancerOptions=function(e){return t.filterKeys(e,["classnameMap","fontSizeMap","tocTemplate","components"])},t.defaults("fluid.pageEnhancer",{gradeNames:["fluid.component","fluid.originalEnhancerOptions","fluid.prefs.initialModel","fluid.prefs.settingsGetter","fluid.resolveRootSingle"],distributeOptions:{"pageEnhancer.uiEnhancer":{source:"{that}.options.uiEnhancer",target:"{that > uiEnhancer}.options"}},singleRootType:"fluid.pageEnhancer",components:{uiEnhancer:{type:"fluid.uiEnhancer.root",container:"body"}},originalUserOptions:"@expand:fluid.prefs.filterEnhancerOptions({uiEnhancer}.options)",listeners:{"onCreate.initModel":"fluid.pageEnhancer.init"}}),t.pageEnhancer.init=function(e){e.getSettings().then(function(r){e.uiEnhancer.updateModel(t.get(r,"preferences"))})}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.prefsEditorLoader",{gradeNames:["fluid.prefs.settingsGetter","fluid.prefs.initialModel","fluid.viewComponent"],defaultLocale:"en",components:{prefsEditor:{priority:"last",type:"fluid.prefs.prefsEditor",createOnEvent:"onCreatePrefsEditorReady",options:{members:{initialModel:"{prefsEditorLoader}.initialModel"},invokers:{getSettings:"{prefsEditorLoader}.getSettings"},listeners:{"onReady.boil":{listener:"{prefsEditorLoader}.events.onReady",args:["{prefsEditorLoader}"]}}}},templateLoader:{type:"fluid.resourceLoader",options:{events:{onResourcesLoaded:"{prefsEditorLoader}.events.onPrefsEditorTemplatesLoaded"}}},messageLoader:{type:"fluid.resourceLoader",createOnEvent:"afterInitialSettingsFetched",options:{defaultLocale:"{prefsEditorLoader}.options.defaultLocale",locale:"{prefsEditorLoader}.settings.preferences.locale",resourceOptions:{dataType:"json"},events:{onResourcesLoaded:"{prefsEditorLoader}.events.onPrefsEditorMessagesLoaded"}}}},listeners:{"onCreate.getInitialSettings":{listener:"fluid.prefs.prefsEditorLoader.getInitialSettings",args:["{that}"]}},events:{afterInitialSettingsFetched:null,onPrefsEditorTemplatesLoaded:null,onPrefsEditorMessagesLoaded:null,onCreatePrefsEditorReady:{events:{templateLoaded:"onPrefsEditorTemplatesLoaded",prefsEditorMessagesLoaded:"onPrefsEditorMessagesLoaded"}},onReady:null},distributeOptions:{"prefsEditorLoader.templateLoader":{source:"{that}.options.templateLoader",removeSource:!0,target:"{that > templateLoader}.options"},"prefsEditorLoader.templateLoader.terms":{source:"{that}.options.terms",target:"{that > templateLoader}.options.terms"},"prefsEditorLoader.messageLoader":{source:"{that}.options.messageLoader",removeSource:!0,target:"{that > messageLoader}.options"},"prefsEditorLoader.messageLoader.terms":{source:"{that}.options.terms",target:"{that > messageLoader}.options.terms"},"prefsEditorLoader.prefsEditor":{source:"{that}.options.prefsEditor",removeSource:!0,target:"{that > prefsEditor}.options"}}}),t.prefs.prefsEditorLoader.getInitialSettings=function(r){var n=t.promise(),o=r.getSettings();return o.then(function(t){r.settings=e.extend(!0,{},r.initialModel,t),r.events.afterInitialSettingsFetched.fire(r.settings)},function(e){t.log(t.logLevel.WARN,e),r.settings=r.initialModel,r.events.afterInitialSettingsFetched.fire(r.settings)}),t.promise.follow(o,n),n},t.defaults("fluid.prefs.transformDefaultPanelsOptions",{gradeNames:["fluid.viewComponent"],distributeOptions:{"transformDefaultPanelsOptions.textSize":{source:"{that}.options.textSize",removeSource:!0,target:"{that textSize}.options"},"transformDefaultPanelsOptions.lineSpace":{source:"{that}.options.lineSpace",removeSource:!0,target:"{that lineSpace}.options"},"transformDefaultPanelsOptions.textFont":{source:"{that}.options.textFont",removeSource:!0,target:"{that textFont}.options"},"transformDefaultPanelsOptions.contrast":{source:"{that}.options.contrast",removeSource:!0,target:"{that contrast}.options"},"transformDefaultPanelsOptions.layoutControls":{source:"{that}.options.layoutControls",removeSource:!0,target:"{that layoutControls}.options"},"transformDefaultPanelsOptions.enhanceInputs":{source:"{that}.options.enhanceInputs",removeSource:!0,target:"{that enhanceInputs}.options"}}}),t.defaults("fluid.prefs.settingsGetter",{gradeNames:["fluid.component"],members:{getSettings:"{fluid.prefs.store}.get"}}),t.defaults("fluid.prefs.settingsSetter",{gradeNames:["fluid.component"],invokers:{setSettings:{funcName:"fluid.prefs.settingsSetter.setSettings",args:["{arguments}.0","{arguments}.1","{fluid.prefs.store}.set"]}}}),t.prefs.settingsSetter.setSettings=function(e,r,n){return n(r,t.copy(e))},t.defaults("fluid.prefs.uiEnhancerRelay",{gradeNames:["fluid.modelComponent"],listeners:{"onCreate.addListener":"{that}.addListener","onDestroy.removeListener":"{that}.removeListener"},events:{updateEnhancerModel:"{fluid.prefs.prefsEditor}.events.onUpdateEnhancerModel"},invokers:{addListener:{funcName:"fluid.prefs.uiEnhancerRelay.addListener",args:["{that}.events.updateEnhancerModel","{that}.updateEnhancerModel"]},removeListener:{funcName:"fluid.prefs.uiEnhancerRelay.removeListener",args:["{that}.events.updateEnhancerModel","{that}.updateEnhancerModel"]},updateEnhancerModel:{funcName:"fluid.prefs.uiEnhancerRelay.updateEnhancerModel",args:["{uiEnhancer}","{fluid.prefs.prefsEditor}.model.preferences"]}}}),t.prefs.uiEnhancerRelay.addListener=function(e,t){e.addListener(t)},t.prefs.uiEnhancerRelay.removeListener=function(e,t){e.removeListener(t)},t.prefs.uiEnhancerRelay.updateEnhancerModel=function(e,t){e.updateModel(t)},t.defaults("fluid.prefs.prefsEditor",{gradeNames:["fluid.prefs.settingsGetter","fluid.prefs.settingsSetter","fluid.prefs.initialModel","fluid.remoteModelComponent","fluid.viewComponent"],invokers:{fetchImpl:{funcName:"fluid.prefs.prefsEditor.fetchImpl",args:["{that}"]},writeImpl:{funcName:"fluid.prefs.prefsEditor.writeImpl",args:["{that}","{arguments}.0"]},applyChanges:{funcName:"fluid.prefs.prefsEditor.applyChanges",args:["{that}"]},save:{funcName:"fluid.prefs.prefsEditor.save",args:["{that}"]},saveAndApply:{funcName:"fluid.prefs.prefsEditor.saveAndApply",args:["{that}"]},reset:{funcName:"fluid.prefs.prefsEditor.reset",args:["{that}"]},cancel:{funcName:"fluid.prefs.prefsEditor.cancel",args:["{that}"]}},selectors:{panels:".flc-prefsEditor-panel",cancel:".flc-prefsEditor-cancel",reset:".flc-prefsEditor-reset",save:".flc-prefsEditor-save",previewFrame:".flc-prefsEditor-preview-frame"},events:{onSave:null,onCancel:null,beforeReset:null,afterReset:null,onAutoSave:null,modelChanged:null,onPrefsEditorRefresh:null,onUpdateEnhancerModel:null,onPrefsEditorMarkupReady:null,onReady:null},listeners:{"onCreate.init":"fluid.prefs.prefsEditor.init","onAutoSave.save":"{that}.save","afterWrite.postFetch":{func:"{that}.fetch",priority:"after:unblock"}},model:{local:{preferences:"{that}.model.preferences"}},modelListeners:{preferences:[{listener:"fluid.prefs.prefsEditor.handleAutoSave",args:["{that}"],namespace:"autoSave"},{listener:"{that}.events.modelChanged.fire",args:["{change}.value"],namespace:"modelChange"}]},resources:{template:"{templateLoader}.resources.prefsEditor"},autoSave:!1}),t.prefs.prefsEditor.applyChanges=function(e){e.events.onUpdateEnhancerModel.fire()},t.prefs.prefsEditor.fetchImpl=function(r){var n=t.promise();return r.getSettings().then(function(t){var o=e.extend(!0,{},r.initialModel,t);n.resolve(o)},n.reject),n},t.prefs.prefsEditor.writeImpl=function(e,r){var n=t.promise(),o={changes:0,unchanged:0,changeMap:{}},a={};r=t.copy(r),t.model.diff(r.preferences,t.get(e.initialModel,["preferences"]),o),0===o.changes?delete r.preferences:(t.each(o.changeMap,function(e,n){t.set(a,n,r.preferences[n])}),r.preferences=a),e.events.onSave.fire(r);var i=e.setSettings(r);return t.promise.follow(i,n),n},t.prefs.prefsEditor.save=function(r){var n=t.promise();if(!r.model||e.isEmptyObject(r.model))n.resolve({});else{var o=r.write();t.promise.follow(o,n)}return n},t.prefs.prefsEditor.saveAndApply=function(e){var r=t.promise(),n=e.getSettings(),o=e.save();return n.then(function(n){o.then(function(r){t.model.diff(t.get(r,"preferences"),t.get(n,"preferences"))||(e.events.onPrefsEditorRefresh.fire(),e.applyChanges())}),t.promise.follow(o,r)}),r},t.prefs.prefsEditor.reset=function(e){var r=e.applier.initiate();e.events.beforeReset.fire(e),r.fireChangeRequest({path:"preferences",type:"DELETE"}),r.change("",t.copy(e.initialModel)),r.commit(),e.events.onPrefsEditorRefresh.fire(),e.events.afterReset.fire(e)},t.prefs.prefsEditor.cancel=function(e){e.events.onCancel.fire(),e.fetch().then(function(){var t=e.applier.initiate();t.fireChangeRequest({path:"preferences",type:"DELETE"}),t.change("",e.model.remote),t.commit(),e.events.onPrefsEditorRefresh.fire()})},t.prefs.prefsEditor.finishInit=function(r){r.container.append(r.options.resources.template.resourceText),function(r){var n=r.locate("save");if(n.length>0){n.click(r.saveAndApply);var o=t.findForm(n);e(o).submit(function(){r.saveAndApply()})}r.locate("reset").click(r.reset),r.locate("cancel").click(r.cancel)}(r),r.fetch().then(function(){r.events.onPrefsEditorMarkupReady.fire(),r.events.onPrefsEditorRefresh.fire(),r.applyChanges(),r.events.onReady.fire(r)})},t.prefs.prefsEditor.handleAutoSave=function(e){e.options.autoSave&&e.events.onAutoSave.fire()},t.prefs.prefsEditor.init=function(e){setTimeout(function(){t.isDestroyed(e)||t.prefs.prefsEditor.finishInit(e)},1)},t.defaults("fluid.prefs.preview",{gradeNames:["fluid.viewComponent"],components:{enhancer:{type:"fluid.uiEnhancer",container:"{preview}.enhancerContainer",createOnEvent:"onReady"},templateLoader:"{templateLoader}"},invokers:{updateModel:{funcName:"fluid.prefs.preview.updateModel",args:["{preview}","{prefsEditor}.model.preferences"]}},events:{onReady:null},listeners:{"onCreate.startLoadingContainer":"fluid.prefs.preview.startLoadingContainer","{prefsEditor}.events.modelChanged":{listener:"{that}.updateModel",namespace:"updateModel"},"onReady.updateModel":"{that}.updateModel"},templateUrl:"%prefix/PrefsEditorPreview.html"}),t.prefs.preview.updateModel=function(e,t){setTimeout(function(){e.enhancer&&e.enhancer.updateModel(t)},0)},t.prefs.preview.startLoadingContainer=function(t){var r=t.templateLoader.transformURL(t.options.templateUrl);t.container.on("load",function(){t.enhancerContainer=e("body",t.container.contents()),t.events.onReady.fire()}),t.container.attr("src",r)}
}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.msgLookup",{gradeNames:["fluid.component"],members:{msgLookup:{expander:{funcName:"fluid.prefs.stringLookup",args:["{msgResolver}","{that}.options.stringArrayIndex"]}}},stringArrayIndex:{}}),t.prefs.stringLookup=function(e,r){var n={id:t.allocateGuid()};return n.singleLookup=function(r){var n=e.lookup([r]);return t.get(n,"template")},n.multiLookup=function(e){return t.transform(e,function(e){return n.singleLookup(e)})},n.lookup=function(e){var o=t.get(r,e)||e,a=t.isArrayable(o)?"multiLookup":"singleLookup";return n[a](o)},n.resolvePathSegment=n.lookup,n},t.defaults("fluid.prefs.panel",{gradeNames:["fluid.prefs.msgLookup","fluid.rendererComponent"],events:{onDomBind:null},listeners:{"onCreate.onDomBind":"{that}.events.onDomBind"},components:{msgResolver:{type:"fluid.messageResolver"}},rendererOptions:{messageLocator:"{msgResolver}.resolve"},distributeOptions:{"panel.msgResolver.messageBase":{source:"{that}.options.messageBase",target:"{that > msgResolver}.options.messageBase"}}}),t.defaults("fluid.prefs.subPanel",{gradeNames:["fluid.prefs.panel","{that}.getDomBindGrade"],listeners:{"{compositePanel}.events.afterRender":{listener:"{that}.events.afterRender",args:["{that}"],namespce:"boilAfterRender"},"onCreate.onDomBind":null,"afterRender.onDomBind":"{that}.resetDomBinder"},rules:{expander:{func:"fluid.prefs.subPanel.generateRules",args:["{that}.options.preferenceMap"]}},invokers:{refreshView:"{compositePanel}.refreshView",resetDomBinder:{funcName:"fluid.prefs.subPanel.resetDomBinder",args:["{that}"]},getDomBindGrade:{funcName:"fluid.prefs.subPanel.getDomBindGrade",args:["{prefsEditor}"]}},strings:{},parentBundle:"{compositePanel}.messageResolver",renderOnInit:!1}),t.defaults("fluid.prefs.subPanel.domBind",{gradeNames:["fluid.component"],listeners:{"onDomBind.domChange":{listener:"{prefsEditor}.events.onSignificantDOMChange"}}}),t.prefs.subPanel.getDomBindGrade=function(e){if(void 0!==t.get(e,"options.events.onSignificantDOMChange"))return"fluid.prefs.subPanel.domBind"},t.prefs.subPanel.resetDomBinder=function(e){var r=e.container.constructor,n=e.container[0].ownerDocument,o=e.container.selector;e.container=r(o,n),e.container.selector=o,e.container.context=n,0===e.container.length&&t.fail("resetDomBinder got no elements in DOM for container searching for selector "+e.container.selector),t.initDomBinder(e,e.options.selectors),e.events.onDomBind.fire(e)},t.prefs.subPanel.safePrefKey=function(e){return e.replace(/[.]/g,"_")},t.prefs.subPanel.generateRules=function(e){var r={};return t.each(e,function(e,n){t.each(e,function(e,o){0===o.indexOf("model.")&&(r[t.prefs.subPanel.safePrefKey(n)]=o.slice("model.".length))})}),r},t.registerNamespace("fluid.prefs.compositePanel"),t.prefs.compositePanel.arrayMergePolicy=function(e,r){return e=t.makeArray(e),r=t.makeArray(r),t.each(r,function(t){e.indexOf(t)<0&&e.push(t)}),e},t.defaults("fluid.prefs.compositePanel",{gradeNames:["fluid.prefs.panel","{that}.getDistributeOptionsGrade","{that}.getSubPanelLifecycleBindings"],mergePolicy:{subPanelOverrides:"noexpand",selectorsToIgnore:t.prefs.compositePanel.arrayMergePolicy},selectors:{},selectorsToIgnore:[],repeatingSelectors:[],events:{initSubPanels:null},listeners:{"onCreate.combineResources":"{that}.combineResources","onCreate.appendTemplate":{this:"{that}.container",method:"append",args:["{that}.options.resources.template.resourceText"]},"onCreate.initSubPanels":"{that}.events.initSubPanels","onCreate.hideInactive":"{that}.hideInactive","onCreate.surfaceSubpanelRendererSelectors":"{that}.surfaceSubpanelRendererSelectors","afterRender.hideInactive":"{that}.hideInactive"},invokers:{getDistributeOptionsGrade:{funcName:"fluid.prefs.compositePanel.assembleDistributeOptions",args:["{that}.options.components"]},getSubPanelLifecycleBindings:{funcName:"fluid.prefs.compositePanel.subPanelLifecycleBindings",args:["{that}.options.components"]},combineResources:{funcName:"fluid.prefs.compositePanel.combineTemplates",args:["{that}.options.resources","{that}.options.selectors"]},surfaceSubpanelRendererSelectors:{funcName:"fluid.prefs.compositePanel.surfaceSubpanelRendererSelectors",args:["{that}","{that}.options.components","{that}.options.selectors"]},produceSubPanelTrees:{funcName:"fluid.prefs.compositePanel.produceSubPanelTrees",args:["{that}"]},expandProtoTree:{funcName:"fluid.prefs.compositePanel.expandProtoTree",args:["{that}"]},produceTree:{funcName:"fluid.prefs.compositePanel.produceTree",args:["{that}"]},hideInactive:{funcName:"fluid.prefs.compositePanel.hideInactive",args:["{that}"]},handleRenderOnPreference:{funcName:"fluid.prefs.compositePanel.handleRenderOnPreference",args:["{that}","{that}.refreshView","{that}.conditionalCreateEvent","{arguments}.0","{arguments}.1","{arguments}.2"]},conditionalCreateEvent:{funcName:"fluid.prefs.compositePanel.conditionalCreateEvent"}},subPanelOverrides:{gradeNames:["fluid.prefs.subPanel"]},rendererFnOptions:{noexpand:!0,cutpointGenerator:"fluid.prefs.compositePanel.cutpointGenerator",subPanelRepeatingSelectors:{expander:{funcName:"fluid.prefs.compositePanel.surfaceRepeatingSelectors",args:["{that}.options.components"]}}},components:{},resources:{}}),t.prefs.compositePanel.prefetchComponentOptions=function(e,r){var n=t.getMergedDefaults(e,t.get(r,"gradeNames"));return t.merge(n.mergePolicy,t.copy(n),r)},t.prefs.compositePanel.isPanel=function(e,r){var n=t.prefs.compositePanel.prefetchComponentOptions(e,r);return t.hasGrade(n,"fluid.prefs.panel")},t.prefs.compositePanel.isActivePanel=function(e){return e&&t.hasGrade(e.options,"fluid.prefs.panel")},t.prefs.compositePanel.assembleDistributeOptions=function(e){var r="fluid.prefs.compositePanel.distributeOptions_"+t.allocateGuid(),n={},o={};return t.each(e,function(e,r){t.prefs.compositePanel.isPanel(e.type,e.options)&&(n[r+".subPanelOverrides"]={source:"{that}.options.subPanelOverrides",target:"{that > "+r+"}.options"});var a={},i=t.prefs.compositePanel.prefetchComponentOptions(e.type,e.options),s=t.get(i,["preferenceMap"]);t.each(s,function(e,r){t.each(e,function(e,n){0===n.indexOf("model.")&&t.set(a,n.slice("model.".length),"{compositePanel}.model."+t.prefs.subPanel.safePrefKey(r))})}),o[r]=a,n[r+".modelRelay"]={source:"{that}.options.relayOption."+r,target:"{that > "+r+"}.options.model"}}),t.defaults(r,{gradeNames:["fluid.component"],relayOption:o,distributeOptions:n}),r},t.prefs.compositePanel.conditionalCreateEvent=function(e,t){e&&t()},t.prefs.compositePanel.handleRenderOnPreference=function(e,r,n,o,a,i){i=t.makeArray(i),n(o,a),t.each(i,function(t){var r=e[t];!o&&r&&r.destroy()}),r()},t.prefs.compositePanel.creationEventName=function(e){return"initOn_"+e},t.prefs.compositePanel.generateModelListeners=function(e){return t.transform(e,function(e,r){return{func:"{that}.handleRenderOnPreference",args:["{change}.value","{that}.events."+t.prefs.compositePanel.creationEventName(r)+".fire",e],namespace:"handleRenderOnPreference_"+r}})},t.prefs.compositePanel.subPanelLifecycleBindings=function(e){var r="fluid.prefs.compositePanel.subPanelCreationTimingDistibution_"+t.allocateGuid(),n={},o={default:"initSubPanels"},a={},i={},s={};return t.each(e,function(e,r){if(t.prefs.compositePanel.isPanel(e.type,e.options)){var l="default",u=t.get(e,"options.renderOnPreference");if(u){var c=t.prefs.subPanel.safePrefKey(u),d="onCreate."+c;l=t.prefs.compositePanel.creationEventName(c),o[l]=l,s[l]=null,a[c]=a[c]||[],a[c].push(r),i[d]={listener:"{that}.conditionalCreateEvent",args:["{that}.model."+c,"{that}.events."+l+".fire"]}}n[r+".subPanelCreationOpts"]={source:"{that}.options.subPanelCreationOpts."+l,target:"{that}.options.components."+r+".createOnEvent"}}}),t.defaults(r,{gradeNames:["fluid.component"],events:s,listeners:i,modelListeners:t.prefs.compositePanel.generateModelListeners(a),subPanelCreationOpts:o,distributeOptions:n}),r},t.prefs.compositePanel.hideInactive=function(e){t.each(e.options.components,function(r,n){t.prefs.compositePanel.isPanel(r.type,r.options)&&!t.prefs.compositePanel.isActivePanel(e[n])&&e.locate(n).hide()})},t.prefs.compositePanel.combineTemplates=function(e,r){var n=[],o={children:[]};t.each(e,function(e,t){"template"!==t&&(o.children.push({ID:t,markup:e.resourceText}),n.push({id:t,selector:r[t]}))});var a={base:{resourceText:e.template.resourceText,href:".",resourceKey:".",cutpoints:n}},i=t.parseTemplates(a,["base"]),s=t.renderer(i,o,{cutpoints:n,debugMode:!0});e.template.resourceText=s.renderTemplates()},t.prefs.compositePanel.rebaseSelectorName=function(e,t){return e+"_"+t},t.prefs.compositePanel.surfaceSubpanelRendererSelectors=function(e,r,n){t.each(r,function(e,r){if(t.prefs.compositePanel.isPanel(e.type,e.options)){var o=t.prefs.compositePanel.prefetchComponentOptions(e.type,e.options);t.each(o.selectors,function(e,a){(!o.selectorsToIgnore||o.selectorsToIgnore.indexOf(a)<0)&&t.set(n,t.prefs.compositePanel.rebaseSelectorName(r,a),n[r]+" "+e)})}})},t.prefs.compositePanel.surfaceRepeatingSelectors=function(e){var r=[];return t.each(e,function(e,n){if(t.prefs.compositePanel.isPanel(e.type,e.options)){var o=t.prefs.compositePanel.prefetchComponentOptions(e.type,e.options),a=t.transform(o.repeatingSelectors,function(e){return t.prefs.compositePanel.rebaseSelectorName(n,e)});r=r.concat(a)}}),r},t.prefs.compositePanel.cutpointGenerator=function(e,r){var n={selectorsToIgnore:r.selectorsToIgnore,repeatingSelectors:r.repeatingSelectors.concat(r.subPanelRepeatingSelectors)};return t.renderer.selectorsToCutpoints(e,n)},t.prefs.compositePanel.rebaseID=function(e,t){return t+"_"+e},t.prefs.compositePanel.rebaseParentRelativeID=function(e,r){var n="..::".length;return e.slice(0,n)+t.prefs.compositePanel.rebaseID(e.slice(n),r)},t.prefs.compositePanel.rebaseValueBinding=function(e,r){return t.find(r,function(t,r){return e===t?r:0===e.indexOf(t)?e.replace(t,r):void 0})||e},t.prefs.compositePanel.rebaseTreeComp=function(e,r,n,o,a){var i=t.copy(n);if(i.ID&&(i.ID=t.prefs.compositePanel.rebaseID(i.ID,o)),i.children)i.children=t.prefs.compositePanel.rebaseTree(e,r,i.children,o,a);else if(i.selection)i.selection=t.prefs.compositePanel.rebaseTreeComp(e,r,i.selection,o,a);else if(i.messagekey)i.componentType="UIBound",i.value=e.resolve(i.messagekey.value,i.messagekey.args),delete i.messagekey;else if(i.parentRelativeID)i.parentRelativeID=t.prefs.compositePanel.rebaseParentRelativeID(i.parentRelativeID,o);else if(i.valuebinding&&(i.valuebinding=t.prefs.compositePanel.rebaseValueBinding(i.valuebinding,a),i.value)){var s=t.get(r,i.valuebinding);i.value=void 0!==s?s:i.value}return i},t.prefs.compositePanel.rebaseTree=function(e,r,n,o,a){return t.isArrayable(n)?t.transform(n,function(n){return t.prefs.compositePanel.rebaseTreeComp(e,r,n,o,a)}):t.prefs.compositePanel.rebaseTreeComp(e,r,n,o,a)},t.prefs.compositePanel.produceTree=function(e){var r=e.options.produceTree,n=r?("string"==typeof r?t.getGlobalValue(r):r)(e):e.expandProtoTree(),o=e.produceSubPanelTrees();return{children:n.children.concat(o.children)}},t.prefs.compositePanel.expandProtoTree=function(e){var r=t.renderer.modeliseOptions(e.options.expanderOptions,{ELstyle:"${}"},e);return t.renderer.makeProtoExpander(r,e)(e.options.protoTree||{})},t.prefs.compositePanel.produceSubPanelTrees=function(e){var r={children:[]};return t.each(e.options.components,function(n,o){var a=e[o];if(t.prefs.compositePanel.isActivePanel(a)){var i=t.renderer.modeliseOptions(a.options.expanderOptions,{ELstyle:"${}"},a),s=t.renderer.makeProtoExpander(i,a),l=a.produceTree();l=t.get(a.options,"rendererFnOptions.noexpand")?l:s(l);var u=t.prefs.compositePanel.rebaseTree(a.msgResolver,e.model,l,o,a.options.rules);r.children=r.children.concat(u.children)}}),r},t.defaults("fluid.prefs.prefsEditorConnections",{gradeNames:["fluid.component"],listeners:{"{fluid.prefs.prefsEditor}.events.onPrefsEditorRefresh":"{fluid.prefs.panel}.refreshView"},strings:{},parentBundle:"{fluid.prefs.prefsEditorLoader}.msgResolver"}),t.defaults("fluid.prefs.panel.switchAdjuster",{gradeNames:["fluid.prefs.panel"],selectors:{header:".flc-prefsEditor-header",switchContainer:".flc-prefsEditor-switch",label:".flc-prefsEditor-label",description:".flc-prefsEditor-description"},selectorsToIgnore:["header","switchContainer"],components:{switchUI:{type:"fluid.switchUI",container:"{that}.dom.switchContainer",createOnEvent:"afterRender",options:{strings:{on:"{fluid.prefs.panel.switchAdjuster}.msgLookup.switchOn",off:"{fluid.prefs.panel.switchAdjuster}.msgLookup.switchOff"},model:{enabled:"{fluid.prefs.panel.switchAdjuster}.model.value"},attrs:{"aria-labelledby":{expander:{funcName:"fluid.allocateSimpleId",args:["{fluid.prefs.panel.switchAdjuster}.dom.description"]}}}}}},protoTree:{label:{messagekey:"label"},description:{messagekey:"description"}}}),t.defaults("fluid.prefs.panel.themePicker",{gradeNames:["fluid.prefs.panel"],mergePolicy:{"controlValues.theme":"replace","stringArrayIndex.theme":"replace"},controlValues:{theme:[]},stringArrayIndex:{theme:[]},selectID:"{that}.id",listeners:{"afterRender.style":"{that}.style"},selectors:{themeRow:".flc-prefsEditor-themeRow",themeLabel:".flc-prefsEditor-theme-label",themeInput:".flc-prefsEditor-themeInput",label:".flc-prefsEditor-themePicker-label",description:".flc-prefsEditor-themePicker-descr"},styles:{defaultThemeLabel:"fl-prefsEditor-themePicker-defaultThemeLabel"},repeatingSelectors:["themeRow"],protoTree:{label:{messagekey:"label"},description:{messagekey:"description"},expander:{type:"fluid.renderer.selection.inputs",rowID:"themeRow",labelID:"themeLabel",inputID:"themeInput",selectID:"{that}.options.selectID",tree:{optionnames:"${{that}.msgLookup.theme}",optionlist:"${{that}.options.controlValues.theme}",selection:"${value}"}}},markup:{label:'<span class="fl-preview-A" aria-hidden="true"></span><span class="fl-hidden-accessible">%theme</span><div class="fl-crossout" aria-hidden="true"></div>'},invokers:{style:{funcName:"fluid.prefs.panel.themePicker.style",args:["{that}.dom.themeLabel","{that}.msgLookup.theme","{that}.options.markup.label","{that}.options.controlValues.theme","default","{that}.options.classnameMap.theme","{that}.options.styles.defaultThemeLabel"]}}}),t.prefs.panel.themePicker.style=function(r,n,o,a,i,s,l){t.each(r,function(r,u){r=e(r);var c=n[u];r.html(t.stringTemplate(o,{theme:c})),r.attr("aria-label",c);var d=a[u];d===i&&r.addClass(l),r.addClass(s[d])})},t.defaults("fluid.prefs.panel.stepperAjuster",{gradeNames:["fluid.prefs.panel"],selectors:{header:".flc-prefsEditor-header",textfieldStepperContainer:".flc-prefsEditor-textfieldStepper",label:".flc-prefsEditor-label",descr:".flc-prefsEditor-descr"},selectorsToIgnore:["header","textfieldStepperContainer"],components:{textfieldStepper:{type:"fluid.textfieldStepper",container:"{that}.dom.textfieldStepperContainer",createOnEvent:"afterRender",options:{model:{value:"{fluid.prefs.panel.stepperAjuster}.model.value",range:{min:"{fluid.prefs.panel.stepperAjuster}.options.range.min",max:"{fluid.prefs.panel.stepperAjuster}.options.range.max"},step:"{fluid.prefs.panel.stepperAjuster}.options.step"},scale:1,strings:{increaseLabel:"{fluid.prefs.panel.stepperAjuster}.msgLookup.increaseLabel",decreaseLabel:"{fluid.prefs.panel.stepperAjuster}.msgLookup.decreaseLabel"},attrs:{"aria-labelledby":"{fluid.prefs.panel.stepperAjuster}.options.panelOptions.labelId"}}}},protoTree:{label:{messagekey:"label",decorators:{attrs:{id:"{that}.options.panelOptions.labelId"}}},descr:{messagekey:"description"}},panelOptions:{labelIdTemplate:"%guid",labelId:{expander:{funcName:"fluid.prefs.panel.stepperAjuster.setLabelID",args:["{that}.options.panelOptions.labelIdTemplate"]}}}}),t.prefs.panel.stepperAjuster.setLabelID=function(e){return t.stringTemplate(e,{guid:t.allocateGuid()})},t.defaults("fluid.prefs.panel.textSize",{gradeNames:["fluid.prefs.panel.stepperAjuster"],preferenceMap:{"fluid.prefs.textSize":{"model.value":"default","range.min":"minimum","range.max":"maximum",step:"divisibleBy"}},panelOptions:{labelIdTemplate:"textSize-label-%guid"}}),t.defaults("fluid.prefs.panel.textFont",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.textFont":{"model.value":"default","controlValues.textFont":"enum"}},mergePolicy:{"controlValues.textFont":"replace","stringArrayIndex.textFont":"replace"},selectors:{header:".flc-prefsEditor-text-font-header",textFont:".flc-prefsEditor-text-font",label:".flc-prefsEditor-text-font-label",textFontDescr:".flc-prefsEditor-text-font-descr"},selectorsToIgnore:["header"],stringArrayIndex:{textFont:["textFont-default","textFont-times","textFont-comic","textFont-arial","textFont-verdana"]},protoTree:{label:{messagekey:"textFontLabel"},textFontDescr:{messagekey:"textFontDescr"},textFont:{optionnames:"${{that}.msgLookup.textFont}",optionlist:"${{that}.options.controlValues.textFont}",selection:"${value}",decorators:{type:"fluid",func:"fluid.prefs.selectDecorator",options:{styles:"{that}.options.classnameMap.textFont"}}}},classnameMap:null,controlValues:{textFont:["default","times","comic","arial","verdana"]}}),t.defaults("fluid.prefs.panel.lineSpace",{gradeNames:["fluid.prefs.panel.stepperAjuster"],preferenceMap:{"fluid.prefs.lineSpace":{"model.value":"default","range.min":"minimum","range.max":"maximum",step:"divisibleBy"}},panelOptions:{labelIdTemplate:"lineSpace-label-%guid"}}),t.defaults("fluid.prefs.panel.contrast",{gradeNames:["fluid.prefs.panel.themePicker"],preferenceMap:{"fluid.prefs.contrast":{"model.value":"default","controlValues.theme":"enum"}},listeners:{"afterRender.style":"{that}.style"},selectors:{header:".flc-prefsEditor-contrast-header",themeRow:".flc-prefsEditor-themeRow",themeLabel:".flc-prefsEditor-theme-label",themeInput:".flc-prefsEditor-themeInput",label:".flc-prefsEditor-themePicker-label",contrastDescr:".flc-prefsEditor-themePicker-descr"},selectorsToIgnore:["header"],styles:{defaultThemeLabel:"fl-prefsEditor-themePicker-defaultThemeLabel"},stringArrayIndex:{theme:["contrast-default","contrast-bw","contrast-wb","contrast-by","contrast-yb","contrast-lgdg"]},controlValues:{theme:["default","bw","wb","by","yb","lgdg"]}}),t.defaults("fluid.prefs.panel.layoutControls",{gradeNames:["fluid.prefs.panel.switchAdjuster"],preferenceMap:{"fluid.prefs.tableOfContents":{"model.value":"default"}}}),t.defaults("fluid.prefs.panel.enhanceInputs",{gradeNames:["fluid.prefs.panel.switchAdjuster"],preferenceMap:{"fluid.prefs.enhanceInputs":{"model.value":"default"}}}),t.defaults("fluid.prefs.selectDecorator",{gradeNames:["fluid.viewComponent"],listeners:{"onCreate.decorateOptions":"fluid.prefs.selectDecorator.decorateOptions"},styles:{preview:"fl-preview-theme"}}),t.prefs.selectDecorator.decorateOptions=function(r){t.each(e("option",r.container),function(n){var o=r.options.styles;e(n).addClass(o.preview+" "+o[t.value(n)])})}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.panel.speak",{gradeNames:["fluid.prefs.panel.switchAdjuster"],preferenceMap:{"fluid.prefs.speak":{"model.value":"default"}}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.panel.letterSpace",{gradeNames:["fluid.prefs.panel.stepperAjuster"],preferenceMap:{"fluid.prefs.letterSpace":{"model.value":"default","range.min":"minimum","range.max":"maximum",step:"divisibleBy"}},panelOptions:{labelIdTemplate:"letterSpace-label-%guid"}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.enactor",{gradeNames:["fluid.modelComponent"]}),t.defaults("fluid.prefs.enactor.styleElements",{gradeNames:["fluid.prefs.enactor"],cssClass:null,elementsToStyle:null,invokers:{applyStyle:{funcName:"fluid.prefs.enactor.styleElements.applyStyle",args:["{arguments}.0","{arguments}.1"]},resetStyle:{funcName:"fluid.prefs.enactor.styleElements.resetStyle",args:["{arguments}.0","{arguments}.1"]},handleStyle:{funcName:"fluid.prefs.enactor.styleElements.handleStyle",args:["{arguments}.0","{that}.options.elementsToStyle","{that}.options.cssClass","{that}.applyStyle","{that}.resetStyle"]}},modelListeners:{value:{listener:"{that}.handleStyle",args:["{change}.value"],namespace:"handleStyle"}}}),t.prefs.enactor.styleElements.applyStyle=function(e,t){e.addClass(t)},t.prefs.enactor.styleElements.resetStyle=function(t,r){e(t,"."+r).addBack().removeClass(r)},t.prefs.enactor.styleElements.handleStyle=function(e,t,r,n,o){(e?n:o)(t,r)},t.defaults("fluid.prefs.enactor.classSwapper",{gradeNames:["fluid.prefs.enactor","fluid.viewComponent"],classes:{},invokers:{clearClasses:{funcName:"fluid.prefs.enactor.classSwapper.clearClasses",args:["{that}.container","{that}.classStr"]},swap:{funcName:"fluid.prefs.enactor.classSwapper.swap",args:["{arguments}.0","{that}","{that}.clearClasses"]}},modelListeners:{value:{listener:"{that}.swap",args:["{change}.value"],namespace:"swapClass"}},members:{classStr:{expander:{func:"fluid.prefs.enactor.classSwapper.joinClassStr",args:"{that}.options.classes"}}}}),t.prefs.enactor.classSwapper.clearClasses=function(e,t){e.removeClass(t)},t.prefs.enactor.classSwapper.swap=function(e,t,r){r(),t.container.addClass(t.options.classes[e])},t.prefs.enactor.classSwapper.joinClassStr=function(e){var r="";return t.each(e,function(e){e&&(r+=r?" "+e:e)}),r},t.defaults("fluid.prefs.enactor.enhanceInputs",{gradeNames:["fluid.prefs.enactor.styleElements","fluid.viewComponent"],preferenceMap:{"fluid.prefs.enhanceInputs":{"model.value":"default"}},cssClass:null,elementsToStyle:"{that}.container"}),t.defaults("fluid.prefs.enactor.textFont",{gradeNames:["fluid.prefs.enactor.classSwapper"],preferenceMap:{"fluid.prefs.textFont":{"model.value":"default"}}}),t.defaults("fluid.prefs.enactor.contrast",{gradeNames:["fluid.prefs.enactor.classSwapper"],preferenceMap:{"fluid.prefs.contrast":{"model.value":"default"}}}),t.prefs.enactor.getTextSizeInPx=function(e,t){var r=e.css("font-size");return t[r]&&(r=t[r]),parseFloat(r)},t.defaults("fluid.prefs.enactor.textRelatedSizer",{gradeNames:["fluid.prefs.enactor","fluid.viewComponent"],fontSizeMap:{},invokers:{set:"fluid.notImplemented",getTextSizeInPx:{funcName:"fluid.prefs.enactor.getTextSizeInPx",args:["{that}.container","{that}.options.fontSizeMap"]}},modelListeners:{value:{listener:"{that}.set",args:["{change}.value"],namespace:"setAdaptation"}}}),t.defaults("fluid.prefs.enactor.textSize",{gradeNames:["fluid.prefs.enactor.textRelatedSizer"],preferenceMap:{"fluid.prefs.textSize":{"model.value":"default"}},members:{root:{expander:{this:"{that}.container",method:"closest",args:["html"]}}},invokers:{set:{funcName:"fluid.prefs.enactor.textSize.set",args:["{arguments}.0","{that}","{that}.getTextSizeInPx"]},getTextSizeInPx:{args:["{that}.root","{that}.options.fontSizeMap"]}}}),t.prefs.enactor.textSize.set=function(e,t,r){if(e=e||1,t.initialSize||(t.initialSize=r()),t.initialSize){var n=e*t.initialSize;t.root.css("font-size",n+"px")}},t.defaults("fluid.prefs.enactor.lineSpace",{gradeNames:["fluid.prefs.enactor.textRelatedSizer"],preferenceMap:{"fluid.prefs.lineSpace":{"model.value":"default"}},invokers:{set:{funcName:"fluid.prefs.enactor.lineSpace.set",args:["{arguments}.0","{that}","{that}.getLineHeightMultiplier"]},getLineHeight:{funcName:"fluid.prefs.enactor.lineSpace.getLineHeight",args:"{that}.container"},getLineHeightMultiplier:{funcName:"fluid.prefs.enactor.lineSpace.getLineHeightMultiplier",args:[{expander:{func:"{that}.getLineHeight"}},{expander:{func:"{that}.getTextSizeInPx"}}]}}}),t.prefs.enactor.lineSpace.getLineHeight=function(e){return e.css("line-height")},t.prefs.enactor.lineSpace.getLineHeightMultiplier=function(e,t){return e?"normal"===e?1.2:e.match(/[0-9]$/)?Number(e):Math.round(parseFloat(e)/t*100)/100:0},t.prefs.enactor.lineSpace.set=function(e,t,r){if(t.initialSize||(t.initialSize=r()),t.initialSize){var n=e*t.initialSize;t.container.css("line-height",n)}},t.defaults("fluid.prefs.enactor.tableOfContents",{gradeNames:["fluid.prefs.enactor","fluid.viewComponent"],preferenceMap:{"fluid.prefs.tableOfContents":{"model.toc":"default"}},tocTemplate:null,components:{tableOfContents:{type:"fluid.tableOfContents",container:"{fluid.prefs.enactor.tableOfContents}.container",createOnEvent:"onCreateTOCReady",options:{components:{levels:{type:"fluid.tableOfContents.levels",options:{resources:{template:{forceCache:!0,url:"{fluid.prefs.enactor.tableOfContents}.options.tocTemplate"}}}}},listeners:{"afterRender.boilAfterTocRender":"{fluid.prefs.enactor.tableOfContents}.events.afterTocRender"}}}},invokers:{applyToc:{funcName:"fluid.prefs.enactor.tableOfContents.applyToc",args:["{arguments}.0","{that}"]}},events:{onCreateTOCReady:null,afterTocRender:null,onLateRefreshRelay:null},modelListeners:{toc:{listener:"{that}.applyToc",args:["{change}.value"],namespace:"toggleToc"}},distributeOptions:{"tocEnactor.tableOfContents.ignoreForToC":{source:"{that}.options.ignoreForToC",target:"{that tableOfContents}.options.ignoreForToC"}}}),t.prefs.enactor.tableOfContents.applyToc=function(e,t){e?t.tableOfContents?t.tableOfContents.show():t.events.onCreateTOCReady.fire():t.tableOfContents&&t.tableOfContents.hide()}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.enactor.speak",{gradeNames:"fluid.prefs.enactor",preferenceMap:{"fluid.prefs.speak":{"model.enabled":"default"}},components:{tts:{type:"fluid.textToSpeech",options:{model:"{speak}.model",invokers:{queueSpeech:{funcName:"fluid.prefs.enactor.speak.queueSpeech",args:["{that}","fluid.textToSpeech.queueSpeech","{arguments}.0","{arguments}.1","{arguments}.2"]}}}}}}),t.prefs.enactor.speak.queueSpeech=function(e,r,n,o,a){var i=n.toString();i=i.trim(),i.replace(/\s{2,}/gi," "),e.model.enabled&&i&&("string"==typeof r?t.invokeGlobalFunction(r,[e,i,o,a]):r(e,i,o,a))},t.defaults("fluid.prefs.enactor.selfVoicing",{gradeNames:["fluid.prefs.enactor.speak","fluid.viewComponent"],modelListeners:{enabled:{listener:"{that}.handleSelfVoicing",args:["{change}.value"],namespace:"handleSelfVoicing"}},invokers:{handleSelfVoicing:{funcName:"fluid.prefs.enactor.selfVoicing.handleSelfVoicing",args:["{that}.options.strings.welcomeMsg","{tts}.queueSpeech","{that}.readFromDOM","{tts}.cancel","{arguments}.0"]},readFromDOM:{funcName:"fluid.prefs.enactor.selfVoicing.readFromDOM",args:["{that}","{that}.container"]}},strings:{welcomeMsg:"text to speech enabled"}}),t.prefs.enactor.selfVoicing.handleSelfVoicing=function(e,t,r,n,o){o?(t(e,!0),r()):n()},t.prefs.enactor.selfVoicing.nodeType={ELEMENT_NODE:1,TEXT_NODE:3},t.prefs.enactor.selfVoicing.readFromDOM=function(r,n){n=e(n);var o=n.contents();t.each(o,function(e){if(e.nodeType===t.prefs.enactor.selfVoicing.nodeType.TEXT_NODE&&e.nodeValue&&r.tts.queueSpeech(e.nodeValue),e.nodeType===t.prefs.enactor.selfVoicing.nodeType.ELEMENT_NODE&&"none"!==window.getComputedStyle(e).display)if("IMG"===e.nodeName){var n=e.getAttribute("alt");n&&r.tts.queueSpeech(n)}else t.prefs.enactor.selfVoicing.readFromDOM(r,e)})}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.enactor.letterSpace",{gradeNames:["fluid.prefs.enactor.textRelatedSizer"],preferenceMap:{"fluid.prefs.letterSpace":{"model.value":"default"}},members:{originalLetterSpace:{expander:{func:"{that}.getLetterSpace"}}},invokers:{set:{funcName:"fluid.prefs.enactor.letterSpace.set",args:["{that}","{arguments}.0"]},getLetterSpace:{funcName:"fluid.prefs.enactor.letterSpace.getLetterSpace",args:["{that}","{that}.getTextSizeInPx"]}},modelListeners:{unit:{listener:"{that}.set",args:["{change}.value"],namespace:"setAdaptation"},value:{listener:"fluid.identity",namespace:"setAdaptation"}},modelRelay:{target:"unit",namespace:"toUnit",singleTransform:{type:"fluid.transforms.round",scale:1,input:{transform:{type:"fluid.transforms.linearScale",offset:-1,input:"{that}.model.value"}}}}}),t.prefs.enactor.letterSpace.getLetterSpace=function(e,r){var n=parseFloat(e.container.css("letter-spacing")),o=r();return t.roundToDecimal(n/o,2)},t.prefs.enactor.letterSpace.set=function(e,r){var n=e.originalLetterSpace;r&&(n+=r);var o=n?t.roundToDecimal(n,2)+"em":"";e.container.css("letter-spacing",o)}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.initialModel.starter",{gradeNames:["fluid.prefs.initialModel"],members:{initialModel:{preferences:{textFont:"default",theme:"default",textSize:1,lineSpace:1,toc:!1,inputs:!1}}}}),t.defaults("fluid.uiEnhancer.cssClassEnhancerBase",{gradeNames:["fluid.component"],classnameMap:{textFont:{default:"",times:"fl-font-times",comic:"fl-font-comic-sans",arial:"fl-font-arial",verdana:"fl-font-verdana"},theme:{default:"fl-theme-prefsEditor-default",bw:"fl-theme-bw",wb:"fl-theme-wb",by:"fl-theme-by",yb:"fl-theme-yb",lgdg:"fl-theme-lgdg"},inputs:"fl-input-enhanced"}}),t.defaults("fluid.uiEnhancer.browserTextEnhancerBase",{gradeNames:["fluid.component"],fontSizeMap:{"xx-small":"9px","x-small":"11px",small:"13px",medium:"15px",large:"18px","x-large":"23px","xx-large":"30px"}}),t.defaults("fluid.uiEnhancer.starterEnactors",{gradeNames:["fluid.uiEnhancer","fluid.uiEnhancer.cssClassEnhancerBase","fluid.uiEnhancer.browserTextEnhancerBase"],model:"{fluid.prefs.initialModel}.initialModel.preferences",components:{textSize:{type:"fluid.prefs.enactor.textSize",container:"{uiEnhancer}.container",options:{fontSizeMap:"{uiEnhancer}.options.fontSizeMap",model:{value:"{uiEnhancer}.model.textSize"}}},textFont:{type:"fluid.prefs.enactor.textFont",container:"{uiEnhancer}.container",options:{classes:"{uiEnhancer}.options.classnameMap.textFont",model:{value:"{uiEnhancer}.model.textFont"}}},lineSpace:{type:"fluid.prefs.enactor.lineSpace",container:"{uiEnhancer}.container",options:{fontSizeMap:"{uiEnhancer}.options.fontSizeMap",model:{value:"{uiEnhancer}.model.lineSpace"}}},contrast:{type:"fluid.prefs.enactor.contrast",container:"{uiEnhancer}.container",options:{classes:"{uiEnhancer}.options.classnameMap.theme",model:{value:"{uiEnhancer}.model.theme"}}},enhanceInputs:{type:"fluid.prefs.enactor.enhanceInputs",container:"{uiEnhancer}.container",options:{cssClass:"{uiEnhancer}.options.classnameMap.inputs",model:{value:"{uiEnhancer}.model.inputs"}}},tableOfContents:{type:"fluid.prefs.enactor.tableOfContents",container:"{uiEnhancer}.container",options:{tocTemplate:"{uiEnhancer}.options.tocTemplate",model:{toc:"{uiEnhancer}.model.toc"}}}}}),t.defaults("fluid.prefs.starterPanels",{gradeNames:["fluid.prefs.prefsEditor"],selectors:{textSize:".flc-prefsEditor-text-size",textFont:".flc-prefsEditor-text-font",lineSpace:".flc-prefsEditor-line-space",contrast:".flc-prefsEditor-contrast",layoutControls:".flc-prefsEditor-layout-controls",enhanceInputs:".flc-prefsEditor-enhanceInputs"},components:{textSize:{type:"fluid.prefs.panel.textSize",container:"{prefsEditor}.dom.textSize",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",model:{value:"{prefsEditor}.model.preferences.textSize"},messageBase:"{messageLoader}.resources.textSize.resourceText",resources:{template:"{templateLoader}.resources.textSize"},step:.1,range:{min:1,max:2}}},lineSpace:{type:"fluid.prefs.panel.lineSpace",container:"{prefsEditor}.dom.lineSpace",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",model:{value:"{prefsEditor}.model.preferences.lineSpace"},messageBase:"{messageLoader}.resources.lineSpace.resourceText",resources:{template:"{templateLoader}.resources.lineSpace"},step:.1,range:{min:1,max:2}}},textFont:{type:"fluid.prefs.panel.textFont",container:"{prefsEditor}.dom.textFont",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",classnameMap:"{uiEnhancer}.options.classnameMap",model:{value:"{prefsEditor}.model.preferences.textFont"},messageBase:"{messageLoader}.resources.textFont.resourceText",resources:{
template:"{templateLoader}.resources.textFont"}}},contrast:{type:"fluid.prefs.panel.contrast",container:"{prefsEditor}.dom.contrast",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",classnameMap:"{uiEnhancer}.options.classnameMap",model:{value:"{prefsEditor}.model.preferences.theme"},messageBase:"{messageLoader}.resources.contrast.resourceText",resources:{template:"{templateLoader}.resources.contrast"}}},layoutControls:{type:"fluid.prefs.panel.layoutControls",container:"{prefsEditor}.dom.layoutControls",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",model:{value:"{prefsEditor}.model.preferences.toc"},messageBase:"{messageLoader}.resources.layoutControls.resourceText",resources:{template:"{templateLoader}.resources.layoutControls"}}},enhanceInputs:{type:"fluid.prefs.panel.enhanceInputs",container:"{prefsEditor}.dom.enhanceInputs",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",model:{value:"{prefsEditor}.model.preferences.inputs"},messageBase:"{messageLoader}.resources.enhanceInputs.resourceText",resources:{template:"{templateLoader}.resources.enhanceInputs"}}}}}),t.defaults("fluid.prefs.starterTemplateLoader",{gradeNames:["fluid.resourceLoader"],resources:{textSize:"%templatePrefix/PrefsEditorTemplate-textSize.html",lineSpace:"%templatePrefix/PrefsEditorTemplate-lineSpace.html",textFont:"%templatePrefix/PrefsEditorTemplate-textFont.html",contrast:"%templatePrefix/PrefsEditorTemplate-contrast.html",layoutControls:"%templatePrefix/PrefsEditorTemplate-layout.html",enhanceInputs:"%templatePrefix/PrefsEditorTemplate-enhanceInputs.html"}}),t.defaults("fluid.prefs.starterSeparatedPanelTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader"],resources:{prefsEditor:"%templatePrefix/SeparatedPanelPrefsEditor.html"}}),t.defaults("fluid.prefs.starterFullPreviewTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader"],resources:{prefsEditor:"%templatePrefix/FullPreviewPrefsEditor.html"}}),t.defaults("fluid.prefs.starterFullNoPreviewTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader"],resources:{prefsEditor:"%templatePrefix/FullNoPreviewPrefsEditor.html"}}),t.defaults("fluid.prefs.starterMessageLoader",{gradeNames:["fluid.resourceLoader"],resources:{prefsEditor:"%messagePrefix/prefsEditor.json",textSize:"%messagePrefix/textSize.json",textFont:"%messagePrefix/textFont.json",lineSpace:"%messagePrefix/lineSpace.json",contrast:"%messagePrefix/contrast.json",layoutControls:"%messagePrefix/tableOfContents.json",enhanceInputs:"%messagePrefix/enhanceInputs.json"}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.arrowScrolling",{gradeNames:["fluid.modelComponent"],selectors:{scrollContainer:".flc-prefsEditor-scrollContainer"},onScrollDelay:100,model:{},events:{beforeReset:null,onScroll:null},modelRelay:{target:"panelIndex",forward:{excludeSource:"init"},namespace:"limitPanelIndex",singleTransform:{type:"fluid.transforms.limitRange",input:"{that}.model.panelIndex",min:0,max:"{that}.model.panelMaxIndex"}},modelListeners:{panelIndex:{listener:"fluid.prefs.arrowScrolling.scrollToPanel",args:["{that}","{change}.value"],excludeSource:["scrollEvent"],namespace:"scrollToPanel"}},listeners:{"onReady.scrollEvent":{this:"{that}.dom.scrollContainer",method:"scroll",args:[{expander:{func:"fluid.debounce",args:["{that}.events.onScroll.fire","{that}.options.onScrollDelay"]}}]},"onReady.windowResize":{this:window,method:"addEventListener",args:["resize","{that}.events.onSignificantDOMChange.fire"]},"onDestroy.removeWindowResize":{this:window,method:"removeEventListener",args:["resize","{that}.events.onSignificantDOMChange.fire"]},"onPrefsEditorMarkupReady.setPanelMaxIndex":{changePath:"panelMaxIndex",value:{expander:{funcName:"fluid.prefs.arrowScrolling.calculatePanelMaxIndex",args:["{that}.dom.panels"]}}},"beforeReset.resetPanelIndex":{listener:"{that}.applier.fireChangeRequest",args:{path:"panelIndex",value:0,type:"ADD",source:"reset"}},"onScroll.setPanelIndex":{changePath:"panelIndex",value:{expander:{funcName:"fluid.prefs.arrowScrolling.getClosestPanelIndex",args:"{that}.dom.panels"}},source:"scrollEvent"}},invokers:{eventToScrollIndex:{funcName:"fluid.prefs.arrowScrolling.eventToScrollIndex",args:["{that}","{arguments}.0"]}},distributeOptions:{"arrowScrolling.panel.listeners.bindScrollArrows":{record:{"afterRender.bindScrollArrows":{this:"{that}.dom.header",method:"click",args:["{prefsEditor}.eventToScrollIndex"]}},target:"{that > fluid.prefs.panel}.options.listeners"}}}),t.prefs.arrowScrolling.calculatePanelMaxIndex=function(e){return Math.max(0,e.length-1)},t.prefs.arrowScrolling.eventToScrollIndex=function(t,r){r.preventDefault();var n=e(r.target),o=n.width()/2,a=t.model.panelIndex||0,i=a+(r.offsetX<o?-1:1);t.applier.change("panelIndex",i,"ADD","eventToScrollIndex")},t.prefs.arrowScrolling.scrollToPanel=function(e,t){t=t||0;var r=e.locate("panels"),n=e.locate("scrollContainer");r.eq(t).width()&&n.scrollLeft(n.scrollLeft()+r.eq(t).offset().left)},t.prefs.arrowScrolling.getClosestPanelIndex=function(r){var n=t.transform(r,function(t,r){return{index:r,offset:Math.abs(e(t).offset().left)}});return n.sort(function(e,t){return e.offset-t.offset}),t.get(n,["0","index"])||0}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.dom"),t.dom.getDocumentHeight=function(t){return e("body",t)[0].offsetHeight},t.defaults("fluid.prefs.separatedPanel",{gradeNames:["fluid.prefs.prefsEditorLoader","fluid.contextAware"],events:{afterRender:null,onReady:null,onCreateSlidingPanelReady:{events:{iframeRendered:"afterRender",onPrefsEditorMessagesLoaded:"onPrefsEditorMessagesLoaded"}},templatesAndIframeReady:{events:{iframeReady:"afterRender",templatesLoaded:"onPrefsEditorTemplatesLoaded",messagesLoaded:"onPrefsEditorMessagesLoaded"}}},lazyLoad:!1,contextAwareness:{lazyLoad:{checks:{lazyLoad:{contextValue:"{fluid.prefs.separatedPanel}.options.lazyLoad",gradeNames:"fluid.prefs.separatedPanel.lazyLoad"}}}},selectors:{reset:".flc-prefsEditor-reset",iframe:".flc-prefsEditor-iframe"},listeners:{"onReady.bindEvents":{listener:"fluid.prefs.separatedPanel.bindEvents",args:["{separatedPanel}.prefsEditor","{iframeRenderer}.iframeEnhancer","{separatedPanel}"]},"onCreate.hideReset":{listener:"fluid.prefs.separatedPanel.hideReset",args:["{separatedPanel}"]}},invokers:{bindReset:{funcName:"fluid.bind",args:["{separatedPanel}.dom.reset","click","{arguments}.0"]}},components:{slidingPanel:{type:"fluid.slidingPanel",container:"{separatedPanel}.container",createOnEvent:"onCreateSlidingPanelReady",options:{gradeNames:["fluid.prefs.msgLookup"],strings:{showText:"{that}.msgLookup.slidingPanelShowText",hideText:"{that}.msgLookup.slidingPanelHideText",showTextAriaLabel:"{that}.msgLookup.showTextAriaLabel",hideTextAriaLabel:"{that}.msgLookup.hideTextAriaLabel",panelLabel:"{that}.msgLookup.slidingPanelPanelLabel"},invokers:{operateShow:{funcName:"fluid.prefs.separatedPanel.showPanel",args:["{that}.dom.panel","{that}.events.afterPanelShow.fire"],this:null,method:null},operateHide:{funcName:"fluid.prefs.separatedPanel.hidePanel",args:["{that}.dom.panel","{iframeRenderer}.iframe","{that}.events.afterPanelHide.fire"],this:null,method:null}},components:{msgResolver:{type:"fluid.messageResolver",options:{messageBase:"{messageLoader}.resources.prefsEditor.resourceText"}}}}},iframeRenderer:{type:"fluid.prefs.separatedPanel.renderIframe",container:"{separatedPanel}.dom.iframe",options:{events:{afterRender:"{separatedPanel}.events.afterRender"},components:{iframeEnhancer:{type:"fluid.uiEnhancer",container:"{iframeRenderer}.renderPrefsEditorContainer",createOnEvent:"afterRender",options:{gradeNames:["{pageEnhancer}.uiEnhancer.options.userGrades"],jQuery:"{iframeRenderer}.jQuery",tocTemplate:"{pageEnhancer}.uiEnhancer.options.tocTemplate"}}}}},prefsEditor:{createOnEvent:"templatesAndIframeReady",container:"{iframeRenderer}.renderPrefsEditorContainer",options:{gradeNames:["fluid.prefs.uiEnhancerRelay","fluid.prefs.arrowScrolling"],model:{preferences:"{separatedPanel}.model.preferences",panelIndex:"{separatedPanel}.model.panelIndex",panelMaxIndex:"{separatedPanel}.model.panelMaxIndex",local:{panelIndex:"{that}.model.panelIndex"}},autoSave:!0,events:{onSignificantDOMChange:null,updateEnhancerModel:"{that}.events.modelChanged"},modelListeners:{panelIndex:[{listener:"fluid.prefs.prefsEditor.handleAutoSave",args:["{that}"],namespace:"autoSavePanelIndex"}]},listeners:{"onCreate.bindReset":{listener:"{separatedPanel}.bindReset",args:["{that}.reset"]},"afterReset.applyChanges":"{that}.applyChanges","{separatedPanel}.slidingPanel.events.afterPanelShow":{listener:"fluid.prefs.arrowScrolling.scrollToPanel",args:["{that}","{that}.model.panelIndex"],priority:"after:updateView",namespace:"scrollToPanel"}}}}},outerEnhancerOptions:"{originalEnhancerOptions}.options.originalUserOptions",distributeOptions:{"separatedPanel.slidingPanel":{source:"{that}.options.slidingPanel",removeSource:!0,target:"{that > slidingPanel}.options"},"separatedPanel.iframeRenderer":{source:"{that}.options.iframeRenderer",removeSource:!0,target:"{that > iframeRenderer}.options"},"separatedPanel.iframeRendered.terms":{source:"{that}.options.terms",target:"{that > iframeRenderer}.options.terms"},"separatedPanel.selectors.iframe":{source:"{that}.options.iframe",removeSource:!0,target:"{that}.options.selectors.iframe"},"separatedPanel.iframeEnhancer.outerEnhancerOptions":{source:"{that}.options.outerEnhancerOptions",removeSource:!0,target:"{that iframeEnhancer}.options"}}}),t.prefs.separatedPanel.hideReset=function(e){e.locate("reset").hide()},t.defaults("fluid.prefs.separatedPanel.renderIframe",{gradeNames:["fluid.viewComponent"],events:{afterRender:null},styles:{container:"fl-prefsEditor-separatedPanel-iframe"},terms:{templatePrefix:"."},markupProps:{class:"flc-iframe",src:"%templatePrefix/SeparatedPanelPrefsEditorFrame.html"},listeners:{"onCreate.startLoadingIframe":"fluid.prefs.separatedPanel.renderIframe.startLoadingIframe"}}),t.prefs.separatedPanel.renderIframe.startLoadingIframe=function(r){var n=r.options.styles;r.options.markupProps.src=t.stringTemplate(r.options.markupProps.src,r.options.terms),r.iframeSrc=r.options.markupProps.src,r.iframe=e("<iframe/>"),r.iframe.on("load",function(){var t=r.iframe[0].contentWindow;r.iframeDocument=t.document,r.jQuery=t.jQuery||e,r.renderPrefsEditorContainer=r.jQuery("body",r.iframeDocument),r.jQuery(r.iframeDocument).ready(r.events.afterRender.fire)}),r.iframe.attr(r.options.markupProps),r.iframe.addClass(n.container),r.iframe.hide(),r.iframe.appendTo(r.container)},t.prefs.separatedPanel.updateView=function(e){e.events.onPrefsEditorRefresh.fire(),e.events.onSignificantDOMChange.fire()},t.prefs.separatedPanel.bindEvents=function(e,r,n){var o=n.slidingPanel.panelId;n.locate("reset").attr({"aria-controls":o,role:"button"}),n.slidingPanel.events.afterPanelShow.addListener(function(){t.prefs.separatedPanel.updateView(e)},"updateView","after:openPanel"),e.events.onPrefsEditorRefresh.addListener(function(){r.updateModel(e.model.preferences)},"updateModel"),e.events.afterReset.addListener(function(e){t.prefs.separatedPanel.updateView(e)},"updateView"),e.events.onSignificantDOMChange.addListener(function(){if(t.get(n,"slidingPanel.model.isShowing")){var r=e.container[0].ownerDocument,o=t.dom.getDocumentHeight(r),a=n.iframeRenderer.iframe,i={height:o};n.slidingPanel.locate("panel").css({height:""}),a.clearQueue(),a.animate(i,400)}},"adjustHeight"),n.slidingPanel.events.afterPanelHide.addListener(function(){n.iframeRenderer.iframe.height(0),n.iframeRenderer.iframe.hide()},"collapseFrame"),n.slidingPanel.events.afterPanelShow.addListener(function(){n.iframeRenderer.iframe.show(),n.iframeRenderer.iframe.height(),n.locate("reset").show()},"openPanel"),n.slidingPanel.events.onPanelHide.addListener(function(){n.locate("reset").hide()},"hideReset")},t.prefs.separatedPanel.hidePanel=function(t,r,n){r.clearQueue(),e(t).animate({height:0},{duration:400,complete:n})},t.prefs.separatedPanel.showPanel=function(e,r){t.invokeLater(r)},t.defaults("fluid.prefs.separatedPanel.lazyLoad",{events:{onLazyLoad:null,onPrefsEditorMessagesPreloaded:null,onCreateSlidingPanelReady:{events:{onPrefsEditorMessagesLoaded:"onPrefsEditorMessagesPreloaded"}},templatesAndIframeReady:{events:{onLazyLoad:"onLazyLoad"}}},components:{templateLoader:{createOnEvent:"onLazyLoad"},messageLoader:{options:{events:{onResourcesPreloaded:"{separatedPanel}.events.onPrefsEditorMessagesPreloaded"},preloadResources:"prefsEditor",listeners:{"onCreate.loadResources":{listener:"fluid.prefs.separatedPanel.lazyLoad.preloadResources",args:["{that}",{expander:{func:"{that}.resolveResources"}},"{that}.options.preloadResources"]},"{separatedPanel}.events.onLazyLoad":{listener:"fluid.resourceLoader.loadResources",args:["{messageLoader}",{expander:{func:"{messageLoader}.resolveResources"}}],namespace:"loadResources"}}}},slidingPanel:{options:{invokers:{operateShow:{funcName:"fluid.prefs.separatedPanel.lazyLoad.showPanel",args:["{separatedPanel}","{that}.events.afterPanelShow.fire"]}}}}}}),t.prefs.separatedPanel.lazyLoad.showPanel=function(e,r){e.prefsEditor?t.invokeLater(r):(e.events.onReady.addListener(function(e){e.events.onReady.removeListener("showPanelCallBack"),t.invokeLater(r)},"showPanelCallBack"),e.events.onLazyLoad.fire())},t.prefs.separatedPanel.lazyLoad.preloadResources=function(e,r,n){n=t.makeArray(n);var o={};t.each(n,function(e){o[e]=r[e]}),t.fetchResources(o,function(){e.resources=o,e.events.onResourcesPreloaded.fire(o)})}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.fullNoPreview",{gradeNames:["fluid.prefs.prefsEditorLoader"],components:{prefsEditor:{container:"{that}.container",options:{listeners:{"afterReset.applyChanges":{listener:"{that}.applyChanges"},"afterReset.save":{listener:"{that}.save",priority:"after:applyChanges"}}}}},events:{onReady:null}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.defaults("fluid.prefs.fullPreview",{gradeNames:["fluid.prefs.prefsEditorLoader"],outerUiEnhancerOptions:"{originalEnhancerOptions}.options.originalUserOptions",outerUiEnhancerGrades:"{originalEnhancerOptions}.uiEnhancer.options.userGrades",components:{prefsEditor:{container:"{that}.container",options:{components:{preview:{type:"fluid.prefs.preview",createOnEvent:"onReady",container:"{prefsEditor}.dom.previewFrame",options:{listeners:{"onReady.boilOnPreviewReady":"{fullPreview}.events.onPreviewReady"}}}},listeners:{"onReady.boil":{listener:"{prefsEditorLoader}.events.onPrefsEditorReady"}},distributeOptions:{"fullPreview.prefsEditor.preview":{source:"{that}.options.preview",removeSource:!0,target:"{that > preview}.options"}}}}},events:{onPrefsEditorReady:null,onPreviewReady:null,onReady:{events:{onPrefsEditorReady:"onPrefsEditorReady",onPreviewReady:"onPreviewReady"},args:"{that}"}},distributeOptions:{"fullPreview.enhancer.outerUiEnhancerOptions":{source:"{that}.options.outerUiEnhancerOptions",target:"{that enhancer}.options"},"fullPreview.enhancer.previewEnhancer":{source:"{that}.options.previewEnhancer",target:"{that enhancer}.options"},"fullPreviw.preview":{source:"{that}.options.preview",target:"{that preview}.options"},"fullPreview.enhancer.outerUiEnhancerGrades":{source:"{that}.options.outerUiEnhancerGrades",target:"{that enhancer}.options.gradeNames"}}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.prefs.schemas"),t.prefs.schemas.merge=function(t,r){return t||(t={type:"object",properties:{}}),r=r.properties||r,e.extend(!0,t.properties,r),t},t.defaults("fluid.prefs.primaryBuilder",{gradeNames:["fluid.component","{that}.buildPrimary"],schemaIndex:{expander:{func:"fluid.indexDefaults",args:["schemaIndex",{gradeNames:"fluid.prefs.schemas",indexFunc:"fluid.prefs.primaryBuilder.defaultSchemaIndexer"}]}},primarySchema:{},typeFilter:[],invokers:{buildPrimary:{funcName:"fluid.prefs.primaryBuilder.buildPrimary",args:["{that}.options.schemaIndex","{that}.options.typeFilter","{that}.options.primarySchema"]}}}),t.prefs.primaryBuilder.buildPrimary=function(e,r,n){var o="fluid.prefs.schemas.suppliedPrimary"+t.allocateGuid();t.defaults(o,{gradeNames:["fluid.prefs.schemas"],schema:t.filterKeys(n.properties||n,r,!1)});var a=[];return t.each(r,function(t){var r=e[t];r&&a.push.apply(a,r)}),a.push(o),a},t.prefs.primaryBuilder.defaultSchemaIndexer=function(e){if(e.schema)return t.keys(e.schema.properties)},t.defaults("fluid.prefs.schemas",{gradeNames:["fluid.component"],mergePolicy:{schema:t.prefs.schemas.merge}})}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.prefs"),t.defaults("fluid.prefs.auxSchema",{gradeNames:["fluid.component"],auxiliarySchema:{loaderGrades:["fluid.prefs.separatedPanel"]}}),t.prefs.expandSchemaValue=function(e,r){return"@"!==r.charAt(0)?r:t.get(e,r.substring(1))},t.prefs.addAtPath=function(r,n,o){var a=t.get(r,n);return t.set(r,n,e.extend(!0,{},a,o)),r},t.prefs.removeKey=function(e,t){var r=e[t];return delete e[t],r},t.prefs.rearrangeDirect=function(e,r,n){var o={},a=t.prefs.removeKey(e,n);return a&&t.set(o,r,a),o},t.prefs.addCommonOptions=function(e,r,n,o){o=o||{};var a=t.get(e,r);if(!a)return e;var i={},s={};return t.each(n,function(n,a){if("container"===a){var l=t.get(e,[r,"type"]),u=t.defaults(l);if(void 0===t.get(u,["argumentMap","container"]))return!1}-1!==a.indexOf("gradeNames")&&(s[a]=t.arrayConcatPolicy),a=t.stringTemplate(a,o),n="string"==typeof n?t.stringTemplate(n,o):n,t.set(i,a,n)}),t.set(e,r,t.merge(s,a,i)),e},t.prefs.containerNeeded=function(e,r){var n=t.get(e,[r,"type"]),o=t.defaults(n);return t.hasGrade(o,"fluid.viewComponent")||t.hasGrade(o,"fluid.rendererComponent")},t.prefs.checkPrimarySchema=function(e,r){return e||t.fail("The primary schema for "+r+" is not defined."),!!e},t.prefs.expandSchemaComponents=function(r,n,o,a,i,s,l,u){var c=t.copy(a)||{},d={},f={},p=t.prefs.removeKey(c,"type"),m=new RegExp("\\.","g"),g=p.replace(m,"_"),h=o.replace(m,"_");if(p){d[g]={type:p,options:c};var v=t.prefs.rearrangeDirect(c,g,"container"),y=t.prefs.rearrangeDirect(c,g,"template"),x=t.prefs.rearrangeDirect(c,g,"message"),b=t.defaults(p).preferenceMap,S=b[o],C=u[o];t.each(S,function(r,n){if(t.prefs.checkPrimarySchema(C,o)){var a={};if(0===n.indexOf("model.")){var i=n.slice(6);t.set(a,"model",t.get(a,"model")||{}),t.prefs.addCommonOptions(a,"model",l,{internalModelName:i,externalModelName:h}),t.set(f,["members","initialModel","preferences",h],C[r])}else t.set(a,n,C[r]);e.extend(!0,c,a)}}),t.prefs.addCommonOptions(d,g,s,{prefKey:g}),t.prefs.addAtPath(r,[n,"components"],d),t.prefs.addAtPath(r,[n,"selectors"],v),t.prefs.addAtPath(r,["templateLoader","resources"],y),t.prefs.addAtPath(r,["messageLoader","resources"],x),t.prefs.addAtPath(r,"initialModel",f)}return r},t.prefs.expandSchemaImpl=function(e,r){var n=t.copy(e);return r=r||n,t.each(n,function(e,o){if("object"==typeof e)n[o]=t.prefs.expandSchemaImpl(e,r);else if("string"==typeof e){var a=t.prefs.expandSchemaValue(r,e);void 0!==a?n[o]=a:delete n[o]}}),n},t.prefs.expandCompositePanels=function(r,n,o,a,i,s,l,u){var c=[];return t.each(n,function(n,o){var d={},f={},p={},m={},g={},h={},v=[],y=t.copy(n);t.set(d,"type",y.type),delete y.type,m=t.prefs.rearrangeDirect(y,o,"container"),g=t.prefs.rearrangeDirect(y,o,"template"),h=t.prefs.rearrangeDirect(y,o,"message");var x=[],b={},S={};t.isPlainObject(y.panels)&&!t.isArrayable(y.panels)?t.each(y.panels,function(e,r){x=x.concat(e),"always"!==r&&t.each(e,function(e){t.set(S,e,r)})}):x=y.panels,t.each(x,function(n){c.push(n);var a=t.get(r,[n,"type"]),f=t.prefs.subPanel.safePrefKey(a);v.push(f);var m=t.copy(t.get(r,[n,"panel"])),y=t.get(m,"type");t.set(b,[f,"type"],y);var x=t.get(S,n);x&&t.set(b,[f,"options","renderOnPreference"],x);var C=t.defaults(y).preferenceMap[a],P=u[a];t.each(C,function(r,n){if(t.prefs.checkPrimarySchema(P,a)){var o;0===n.indexOf("model.")?(t.set(d,["options","model"],t.get(d,["options","model"])||{}),t.prefs.addCommonOptions(d,["options","model"],l,{internalModelName:f,externalModelName:f}),t.set(p,["members","initialModel","preferences",f],P[r])):(o=o||{options:{}},t.set(o,"options."+n,P[r])),e.extend(!0,b[f],o)}}),t.set(g,f,t.get(m,"template")),t.set(h,f,t.get(m,"message")),t.set(d,["options","selectors",f],t.get(m,"container")),t.set(d,["options","resources"],t.get(d,["options","resources"])||{}),t.prefs.addCommonOptions(d.options,"resources",s,{subPrefKey:f}),delete m.type,delete m.template,delete m.message,delete m.container,t.set(b,[f,"options"],e.extend(!0,{},t.get(b,[f,"options"]),m)),t.prefs.addCommonOptions(b,f,i,{compositePanel:o,prefKey:f})}),delete y.panels,t.set(d,["options"],e.extend(!0,{},d.options,y)),t.set(d,["options","selectorsToIgnore"],v),t.set(d,["options","components"],b),f[o]=d,t.prefs.addCommonOptions(f,o,a,{prefKey:o}),t.prefs.addAtPath(r,["panels","components"],f),t.prefs.addAtPath(r,["panels","selectors"],m),t.prefs.addAtPath(r,["templateLoader","resources"],g),t.prefs.addAtPath(r,["messageLoader","resources"],h),t.prefs.addAtPath(r,"initialModel",p),e.extend(!0,r,{panelsToIgnore:c})}),r},t.prefs.expandSchema=function(e,r,n,o,a){var i=t.prefs.expandSchemaImpl(e);i.namespace=i.namespace||"fluid.prefs.created_"+t.allocateGuid();var s=t.get(i,"terms");s&&(delete i.terms,t.set(i,["terms","terms"],s));var l=t.get(i,"groups");return l&&t.prefs.expandCompositePanels(i,l,t.get(r,"panel"),t.get(o,"panel"),t.get(o,"subPanel"),t.get(o,"compositePanelBasedOnSub"),t.get(o,"panelModel"),a),t.each(i,function(e,n){var s="panel";e[s]&&!t.contains(i.panelsToIgnore,n)&&t.prefs.expandSchemaComponents(i,"panels",e.type,e[s],t.get(r,s),t.get(o,s),t.get(o,s+"Model"),a),s="enactor",e[s]&&t.prefs.expandSchemaComponents(i,"enactors",e.type,e[s],t.get(r,s),t.get(o,s),t.get(o,s+"Model"),a),t.each(["template","message"],function(e){n===e&&(t.set(i,[e+"Loader","resources","prefsEditor"],i[e]),delete i[e])})}),i.panelsToIgnore&&delete i.panelsToIgnore,t.each(n,function(e,r){t.prefs.addCommonOptions(i,r,e)}),i},t.defaults("fluid.prefs.auxBuilder",{gradeNames:["fluid.prefs.auxSchema"],mergePolicy:{elementCommonOptions:"noexpand"},topCommonOptions:{panels:{gradeNames:["fluid.prefs.prefsEditor"]},enactors:{gradeNames:["fluid.uiEnhancer"]},templateLoader:{gradeNames:["fluid.resourceLoader"]},messageLoader:{gradeNames:["fluid.resourceLoader"]},initialModel:{gradeNames:["fluid.prefs.initialModel"]},terms:{gradeNames:["fluid.component"]}},elementCommonOptions:{panel:{createOnEvent:"onPrefsEditorMarkupReady",container:"{prefsEditor}.dom.%prefKey","options.gradeNames":"fluid.prefs.prefsEditorConnections","options.resources.template":"{templateLoader}.resources.%prefKey","options.messageBase":"{messageLoader}.resources.%prefKey.resourceText"},panelModel:{"%internalModelName":"{prefsEditor}.model.preferences.%externalModelName"},compositePanelBasedOnSub:{"%subPrefKey":"{templateLoader}.resources.%subPrefKey"},subPanel:{container:"{%compositePanel}.dom.%prefKey","options.messageBase":"{messageLoader}.resources.%prefKey.resourceText"},enactor:{container:"{uiEnhancer}.container"},enactorModel:{"%internalModelName":"{uiEnhancer}.model.%externalModelName"}},indexes:{panel:{expander:{func:"fluid.indexDefaults",args:["panelsIndex",{gradeNames:"fluid.prefs.panel",indexFunc:"fluid.prefs.auxBuilder.prefMapIndexer"}]}},enactor:{expander:{func:"fluid.indexDefaults",args:["enactorsIndex",{gradeNames:"fluid.prefs.enactor",indexFunc:"fluid.prefs.auxBuilder.prefMapIndexer"}]}}},mappedDefaults:{},expandedAuxSchema:{expander:{func:"fluid.prefs.expandSchema",args:["{that}.options.auxiliarySchema","{that}.options.indexes","{that}.options.topCommonOptions","{that}.options.elementCommonOptions","{that}.options.mappedDefaults"]}}}),t.prefs.auxBuilder.prefMapIndexer=function(e){return t.keys(e.preferenceMap)}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e){"use strict";e.defaults("fluid.prefs.auxSchema.starter",{gradeNames:["fluid.prefs.auxSchema"],auxiliarySchema:{loaderGrades:["fluid.prefs.separatedPanel"],namespace:"fluid.prefs.constructed",terms:{templatePrefix:"../../framework/preferences/html",messagePrefix:"../../framework/preferences/messages"},template:"%templatePrefix/SeparatedPanelPrefsEditor.html",message:"%messagePrefix/prefsEditor.json",textSize:{type:"fluid.prefs.textSize",enactor:{type:"fluid.prefs.enactor.textSize"},panel:{type:"fluid.prefs.panel.textSize",container:".flc-prefsEditor-text-size",message:"%messagePrefix/textSize.json",template:"%templatePrefix/PrefsEditorTemplate-textSize.html"}},textFont:{type:"fluid.prefs.textFont",classes:{default:"",times:"fl-font-times",comic:"fl-font-comic-sans",arial:"fl-font-arial",verdana:"fl-font-verdana"},enactor:{type:"fluid.prefs.enactor.textFont",classes:"@textFont.classes"},panel:{type:"fluid.prefs.panel.textFont",container:".flc-prefsEditor-text-font",classnameMap:{textFont:"@textFont.classes"},template:"%templatePrefix/PrefsEditorTemplate-textFont.html",message:"%messagePrefix/textFont.json"}},lineSpace:{type:"fluid.prefs.lineSpace",enactor:{type:"fluid.prefs.enactor.lineSpace",fontSizeMap:{"xx-small":"9px","x-small":"11px",small:"13px",medium:"15px",large:"18px","x-large":"23px","xx-large":"30px"}},panel:{type:"fluid.prefs.panel.lineSpace",container:".flc-prefsEditor-line-space",message:"%messagePrefix/lineSpace.json",template:"%templatePrefix/PrefsEditorTemplate-lineSpace.html"}},contrast:{type:"fluid.prefs.contrast",classes:{default:"fl-theme-prefsEditor-default",bw:"fl-theme-bw",wb:"fl-theme-wb",by:"fl-theme-by",yb:"fl-theme-yb",lgdg:"fl-theme-lgdg"},enactor:{type:"fluid.prefs.enactor.contrast",classes:"@contrast.classes"},panel:{type:"fluid.prefs.panel.contrast",container:".flc-prefsEditor-contrast",classnameMap:{theme:"@contrast.classes"},template:"%templatePrefix/PrefsEditorTemplate-contrast.html",message:"%messagePrefix/contrast.json"}},tableOfContents:{type:"fluid.prefs.tableOfContents",enactor:{type:"fluid.prefs.enactor.tableOfContents",tocTemplate:"../../components/tableOfContents/html/TableOfContents.html"},panel:{type:"fluid.prefs.panel.layoutControls",container:".flc-prefsEditor-layout-controls",template:"%templatePrefix/PrefsEditorTemplate-layout.html",message:"%messagePrefix/tableOfContents.json"}},enhanceInputs:{type:"fluid.prefs.enhanceInputs",enactor:{type:"fluid.prefs.enactor.enhanceInputs",cssClass:"fl-input-enhanced"},panel:{type:"fluid.prefs.panel.enhanceInputs",container:".flc-prefsEditor-enhanceInputs",template:"%templatePrefix/PrefsEditorTemplate-enhanceInputs.html",message:"%messagePrefix/enhanceInputs.json"}}}}),e.defaults("fluid.prefs.schemas.textSize",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.textSize":{type:"number",default:1,minimum:1,maximum:2,divisibleBy:.1}}}),e.defaults("fluid.prefs.schemas.lineSpace",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.lineSpace":{type:"number",default:1,minimum:1,maximum:2,divisibleBy:.1}}}),e.defaults("fluid.prefs.schemas.textFont",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.textFont":{type:"string",default:"default",enum:["default","times","comic","arial","verdana"]}}}),e.defaults("fluid.prefs.schemas.contrast",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.contrast":{type:"string",default:"default",enum:["default","bw","wb","by","yb","lgdg"]}}}),e.defaults("fluid.prefs.schemas.tableOfContents",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.tableOfContents":{type:"boolean",default:!1}}}),e.defaults("fluid.prefs.schemas.enhanceInputs",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.enhanceInputs":{type:"boolean",default:!1}}})}(fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e){"use strict";e.defaults("fluid.prefs.auxSchema.speak",{gradeNames:["fluid.prefs.auxSchema"],auxiliarySchema:{namespace:"fluid.prefs.constructed",terms:{templatePrefix:"../../framework/preferences/html/",messagePrefix:"../../framework/preferences/messages/"},template:"%templatePrefix/SeparatedPanelPrefsEditor.html",message:"%messagePrefix/prefsEditor.json",speak:{type:"fluid.prefs.speak",enactor:{type:"fluid.prefs.enactor.selfVoicing",container:"body"},panel:{type:"fluid.prefs.panel.speak",container:".flc-prefsEditor-speak",template:"%templatePrefix/PrefsEditorTemplate-speak.html",message:"%messagePrefix/speak.json"}}}}),e.defaults("fluid.prefs.schemas.speak",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.speak":{type:"boolean",default:!1}}})}(fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e){"use strict";e.defaults("fluid.prefs.auxSchema.letterSpace",{gradeNames:["fluid.prefs.auxSchema"],auxiliarySchema:{namespace:"fluid.prefs.constructed",terms:{templatePrefix:"../../framework/preferences/html/",messagePrefix:"../../framework/preferences/messages/"},template:"%templatePrefix/SeparatedPanelPrefsEditor.html",message:"%messagePrefix/prefsEditor.json",letterSpace:{type:"fluid.prefs.letterSpace",enactor:{type:"fluid.prefs.enactor.letterSpace",fontSizeMap:{"xx-small":"9px","x-small":"11px",small:"13px",medium:"15px",large:"18px","x-large":"23px","xx-large":"30px"}},panel:{type:"fluid.prefs.panel.letterSpace",container:".flc-prefsEditor-letter-space",template:"%templatePrefix/PrefsEditorTemplate-letterSpace.html",message:"%messagePrefix/letterSpace.json"}}}}),e.defaults("fluid.prefs.schemas.letterSpace",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.letterSpace":{type:"number",default:1,minimum:1,maximum:2,divisibleBy:.1}}})}(fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.registerNamespace("fluid.prefs"),t.defaults("fluid.prefs.builder",{gradeNames:["fluid.component","fluid.prefs.auxBuilder"],mergePolicy:{auxSchema:"expandedAuxSchema"},assembledPrefsEditorGrade:{expander:{func:"fluid.prefs.builder.generateGrade",args:["prefsEditor","{that}.options.auxSchema.namespace",{gradeNames:["fluid.prefs.assembler.prefsEd","fluid.viewComponent"],componentGrades:"{that}.options.constructedGrades",loaderGrades:"{that}.options.auxSchema.loaderGrades"}]}},assembledUIEGrade:{expander:{func:"fluid.prefs.builder.generateGrade",args:["uie","{that}.options.auxSchema.namespace",{gradeNames:["fluid.viewComponent","fluid.prefs.assembler.uie"],componentGrades:"{that}.options.constructedGrades"}]}},constructedGrades:{expander:{func:"fluid.prefs.builder.constructGrades",args:["{that}.options.auxSchema",["enactors","messages","panels","initialModel","templateLoader","messageLoader","terms"]]}},mappedDefaults:"{primaryBuilder}.options.schema.properties",components:{primaryBuilder:{type:"fluid.prefs.primaryBuilder",options:{typeFilter:{expander:{func:"fluid.prefs.builder.parseAuxSchema",args:"{builder}.options.auxiliarySchema"}}}}},distributeOptions:{"builder.primaryBuilder.primarySchema":{source:"{that}.options.primarySchema",removeSource:!0,target:"{that > primaryBuilder}.options.primarySchema"}}}),t.defaults("fluid.prefs.assembler.uie",{gradeNames:["fluid.viewComponent"],components:{store:{type:"fluid.prefs.globalSettingsStore",options:{distributeOptions:{"uie.store.context.checkUser":{target:"{that fluid.prefs.store}.options.contextAwareness.strategy.checks.user",record:{contextValue:"{fluid.prefs.assembler.uie}.options.storeType",gradeNames:"{fluid.prefs.assembler.uie}.options.storeType"}}}}},enhancer:{type:"fluid.component",options:{gradeNames:"{that}.options.enhancerType",enhancerType:"fluid.pageEnhancer",components:{uiEnhancer:{options:{gradeNames:["{fluid.prefs.assembler.uie}.options.componentGrades.enactors"]}}}}}},distributeOptions:{"uie.enhancer":{source:"{that}.options.enhancer",target:"{that uiEnhancer}.options",removeSource:!0},"uie.enhancer.enhancerType":{source:"{that}.options.enhancerType",
target:"{that > enhancer}.options.enhancerType"},"uie.store":{source:"{that}.options.store",target:"{that fluid.prefs.store}.options"}}}),t.defaults("fluid.prefs.assembler.prefsEd",{gradeNames:["fluid.viewComponent","fluid.prefs.assembler.uie"],components:{prefsEditorLoader:{type:"fluid.viewComponent",container:"{fluid.prefs.assembler.prefsEd}.container",priority:"last",options:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.terms","{fluid.prefs.assembler.prefsEd}.options.componentGrades.messages","{fluid.prefs.assembler.prefsEd}.options.componentGrades.initialModel","{that}.options.loaderGrades"],templateLoader:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.templateLoader"]},messageLoader:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.messageLoader"]},prefsEditor:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.panels","fluid.prefs.uiEnhancerRelay"]},events:{onReady:"{fluid.prefs.assembler.prefsEd}.events.onPrefsEditorReady"}}}},events:{onPrefsEditorReady:null,onReady:{events:{onPrefsEditorReady:"onPrefsEditorReady",onCreate:"onCreate"},args:["{that}"]}},distributeOptions:{"prefsEdAssembler.prefsEditorLoader.loaderGrades":{source:"{that}.options.loaderGrades",removeSource:!0,target:"{that > prefsEditorLoader}.options.loaderGrades"},"prefsEdAssembler.prefsEditorLoader.terms":{source:"{that}.options.terms",removeSource:!0,target:"{that prefsEditorLoader}.options.terms"},"prefsEdAssembler.prefsEditor":{source:"{that}.options.prefsEditor",removeSource:!0,target:"{that prefsEditor}.options"}}}),t.prefs.builder.generateGrade=function(e,r,n){var o=t.stringTemplate("%namespace.%name",{name:e,namespace:r});return t.defaults(o,n),o},t.prefs.builder.constructGrades=function(e,r){var n={};return t.each(r,function(r){var o=e[r];t.get(o,"gradeNames")&&(n[r]=t.prefs.builder.generateGrade(r,e.namespace,o))}),n},t.prefs.builder.parseAuxSchema=function(e){var r=[];return t.each(e,function(e){var t=e.type;t&&r.push(t)}),r},t.prefs.create=function(e,r){r=r||{};var n=t.prefs.builder(r.build);return t.invokeGlobalFunction(n.options.assembledPrefsEditorGrade,[e,r.prefsEditor])}}(jQuery,fluid_3_0_0);var fluid_3_0_0=fluid_3_0_0||{};!function(e,t){"use strict";t.prefs.builder({gradeNames:["fluid.prefs.auxSchema.starter"]}),t.defaults("fluid.uiOptions.prefsEditor",{gradeNames:["fluid.prefs.constructed.prefsEditor"],lazyLoad:!1,distributeOptions:{"uio.separatedPanel.lazyLoad":{record:"{that}.options.lazyLoad",target:"{that separatedPanel}.options.lazyLoad"},"uio.uiEnhancer.tocTemplate":{source:"{that}.options.tocTemplate",target:"{that uiEnhancer}.options.tocTemplate"},"uio.uiEnhancer.ignoreForToC":{source:"{that}.options.ignoreForToC",target:"{that uiEnhancer}.options.ignoreForToC"}},enhancer:{distributeOptions:{"uio.enhancer.tableOfContents.tocTemplate":{source:"{that}.options.tocTemplate",target:"{that > fluid.prefs.enactor.tableOfContents}.options.tocTemplate"},"uio.enhancer.tableOfContents.ignoreForToC":{source:"{that}.options.ignoreForToC",target:"{that > fluid.prefs.enactor.tableOfContents}.options.ignoreForToC"}}}})}(jQuery,fluid_3_0_0);